{"version":"NotebookV1","origId":1575837098435978,"name":"02 Setup Data Sets to perform joins","language":"python","commands":[{"version":"CommandV1","origId":1575837098435979,"guid":"9ce28ed1-f899-4c9a-aacd-04db7a05aa07","subtype":"command","commandType":"auto","position":0.5,"command":"from pyspark.sql import Row","commandVersion":2,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641726177766,"submitTime":1641726175483,"finishTime":1641726177803,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":true,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"df318a68-188c-46f5-82d9-4e4fea16a620"},{"version":"CommandV1","origId":1575837098435980,"guid":"7c242469-da7d-46bb-88f6-283c69af606b","subtype":"command","commandType":"auto","position":1.0,"command":"import datetime\ncourses = [\n    {\n        'course_id': 1,\n        'course_title': 'Mastering Python',\n        'course_published_dt': datetime.date(2021, 1, 14),\n        'is_active': True,\n        'last_updated_ts': datetime.datetime(2021, 2, 18, 16, 57, 25)\n    },\n    {\n        'course_id': 2,\n        'course_title': 'Data Engineering Essentials',\n        'course_published_dt': datetime.date(2021, 2, 10),\n        'is_active': True,\n        'last_updated_ts': datetime.datetime(2021, 3, 5, 12, 7, 33)\n    },\n    {\n        'course_id': 3,\n        'course_title': 'Mastering Pyspark',\n        'course_published_dt': datetime.date(2021, 1, 7),\n        'is_active': True,\n        'last_updated_ts': datetime.datetime(2021, 4, 6, 10, 5, 42)\n    },\n    {\n        'course_id': 4,\n        'course_title': 'AWS Essentials',\n        'course_published_dt': datetime.date(2021, 3, 19),\n        'is_active': False,\n        'last_updated_ts': datetime.datetime(2021, 4, 10, 2, 25, 36)\n    },\n    {\n        'course_id': 5,\n        'course_title': 'Docker 101',\n        'course_published_dt': datetime.date(2021, 2, 28),\n        'is_active': True,\n        'last_updated_ts': datetime.datetime(2021, 3, 21, 7, 18, 52)\n    }\n]\n\ncourses_df = spark.createDataFrame([Row(**course) for course in courses])","commandVersion":167,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"courses_df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"course_id","nullable":true,"type":"long"},{"metadata":{},"name":"course_title","nullable":true,"type":"string"},{"metadata":{},"name":"course_published_dt","nullable":true,"type":"date"},{"metadata":{},"name":"is_active","nullable":true,"type":"boolean"},{"metadata":{},"name":"last_updated_ts","nullable":true,"type":"timestamp"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641726177810,"submitTime":1641726175547,"finishTime":1641726178137,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"5838f058-24cd-49f4-b849-de3f130dee8b"},{"version":"CommandV1","origId":1575837098435981,"guid":"0869fe9b-9da7-4cd1-a0d1-38f0cce9b2f2","subtype":"command","commandType":"auto","position":2.0,"command":"users = [{\n  \"user_id\": 1,\n  \"user_first_name\": \"Sandra\",\n  \"user_last_name\": \"Karpov\",\n  \"user_email\": \"skarpov0@ovh.net\"\n}, {\n  \"user_id\": 2,\n  \"user_first_name\": \"Kari\",\n  \"user_last_name\": \"Dearth\",\n  \"user_email\": \"kdearth1@so-net.ne.jp\"\n}, {\n  \"user_id\": 3,\n  \"user_first_name\": \"Joanna\",\n  \"user_last_name\": \"Spennock\",\n  \"user_email\": \"jspennock2@redcross.org\"\n}, {\n  \"user_id\": 4,\n  \"user_first_name\": \"Hirsch\",\n  \"user_last_name\": \"Conaboy\",\n  \"user_email\": \"hconaboy3@barnesandnoble.com\"\n}, {\n  \"user_id\": 5,\n  \"user_first_name\": \"Loreen\",\n  \"user_last_name\": \"Malin\",\n  \"user_email\": \"lmalin4@independent.co.uk\"\n}, {\n  \"user_id\": 6,\n  \"user_first_name\": \"Augy\",\n  \"user_last_name\": \"Christon\",\n  \"user_email\": \"achriston5@mlb.com\"\n}, {\n  \"user_id\": 7,\n  \"user_first_name\": \"Trudey\",\n  \"user_last_name\": \"Choupin\",\n  \"user_email\": \"tchoupin6@de.vu\"\n}, {\n  \"user_id\": 8,\n  \"user_first_name\": \"Nadine\",\n  \"user_last_name\": \"Grimsdell\",\n  \"user_email\": \"ngrimsdell7@sohu.com\"\n}, {\n  \"user_id\": 9,\n  \"user_first_name\": \"Vassily\",\n  \"user_last_name\": \"Tamas\",\n  \"user_email\": \"vtamas8@businessweek.com\"\n}, {\n  \"user_id\": 10,\n  \"user_first_name\": \"Wells\",\n  \"user_last_name\": \"Simpkins\",\n  \"user_email\": \"wsimpkins9@amazon.co.uk\"\n}]\n\nusers_df = spark.createDataFrame([Row(**user) for user in users])","commandVersion":14,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"users_df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"user_id","nullable":true,"type":"long"},{"metadata":{},"name":"user_first_name","nullable":true,"type":"string"},{"metadata":{},"name":"user_last_name","nullable":true,"type":"string"},{"metadata":{},"name":"user_email","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641726178144,"submitTime":1641726175591,"finishTime":1641726178227,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"a03a3b12-1e57-467e-9ec3-5e70e7316c1e"},{"version":"CommandV1","origId":1575837098435982,"guid":"effcc9c2-94c4-4b95-a804-5008ee60854b","subtype":"command","commandType":"auto","position":3.0,"command":"course_enrolments = [{\n  \"course_enrolment_id\": 1,\n  \"user_id\": 10,\n  \"course_id\": 2,\n  \"price_paid\": 9.99\n}, {\n  \"course_enrolment_id\": 2,\n  \"user_id\": 5,\n  \"course_id\": 2,\n  \"price_paid\": 9.99\n}, {\n  \"course_enrolment_id\": 3,\n  \"user_id\": 7,\n  \"course_id\": 5,\n  \"price_paid\": 10.99\n}, {\n  \"course_enrolment_id\": 4,\n  \"user_id\": 9,\n  \"course_id\": 2,\n  \"price_paid\": 9.99\n}, {\n  \"course_enrolment_id\": 5,\n  \"user_id\": 8,\n  \"course_id\": 2,\n  \"price_paid\": 9.99\n}, {\n  \"course_enrolment_id\": 6,\n  \"user_id\": 5,\n  \"course_id\": 5,\n  \"price_paid\": 10.99\n}, {\n  \"course_enrolment_id\": 7,\n  \"user_id\": 4,\n  \"course_id\": 5,\n  \"price_paid\": 10.99\n}, {\n  \"course_enrolment_id\": 8,\n  \"user_id\": 7,\n  \"course_id\": 3,\n  \"price_paid\": 10.99\n}, {\n  \"course_enrolment_id\": 9,\n  \"user_id\": 8,\n  \"course_id\": 5,\n  \"price_paid\": 10.99\n}, {\n  \"course_enrolment_id\": 10,\n  \"user_id\": 3,\n  \"course_id\": 3,\n  \"price_paid\": 10.99\n}, {\n  \"course_enrolment_id\": 11,\n  \"user_id\": 7,\n  \"course_id\": 5,\n  \"price_paid\": 10.99\n}, {\n  \"course_enrolment_id\": 12,\n  \"user_id\": 3,\n  \"course_id\": 2,\n  \"price_paid\": 9.99\n}, {\n  \"course_enrolment_id\": 13,\n  \"user_id\": 5,\n  \"course_id\": 2,\n  \"price_paid\": 9.99\n}, {\n  \"course_enrolment_id\": 14,\n  \"user_id\": 4,\n  \"course_id\": 3,\n  \"price_paid\": 10.99\n}, {\n  \"course_enrolment_id\": 15,\n  \"user_id\": 8,\n  \"course_id\": 2,\n  \"price_paid\": 9.99\n}]\n\ncourse_enrolments_df = spark.createDataFrame([Row(**ce) for ce in course_enrolments])","commandVersion":81,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"course_enrolments_df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"course_enrolment_id","nullable":true,"type":"long"},{"metadata":{},"name":"user_id","nullable":true,"type":"long"},{"metadata":{},"name":"course_id","nullable":true,"type":"long"},{"metadata":{},"name":"price_paid","nullable":true,"type":"double"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641726178234,"submitTime":1641726175630,"finishTime":1641726178302,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"e442d912-c35c-473c-ac6b-d655a7b3bc49"},{"version":"CommandV1","origId":1575837098435983,"guid":"93d69686-86b5-4291-a096-800d620303fe","subtype":"command","commandType":"auto","position":4.0,"command":"courses_df.show()","commandVersion":6,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+---------+--------------------+-------------------+---------+-------------------+\n|course_id|        course_title|course_published_dt|is_active|    last_updated_ts|\n+---------+--------------------+-------------------+---------+-------------------+\n|        1|    Mastering Python|         2021-01-14|     true|2021-02-18 16:57:25|\n|        2|Data Engineering ...|         2021-02-10|     true|2021-03-05 12:07:33|\n|        3|   Mastering Pyspark|         2021-01-07|     true|2021-04-06 10:05:42|\n|        4|      AWS Essentials|         2021-03-19|    false|2021-04-10 02:25:36|\n|        5|          Docker 101|         2021-02-28|     true|2021-03-21 07:18:52|\n+---------+--------------------+-------------------+---------+-------------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641726178308,"submitTime":1641726175673,"finishTime":1641726178968,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"60130f0e-6b80-40fb-bb54-5975cf7238b1"},{"version":"CommandV1","origId":1575837098435984,"guid":"6a76aebb-100d-49a6-8418-98003bade269","subtype":"command","commandType":"auto","position":5.0,"command":"users_df.show()","commandVersion":5,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+-------+---------------+--------------+--------------------+\n|user_id|user_first_name|user_last_name|          user_email|\n+-------+---------------+--------------+--------------------+\n|      1|         Sandra|        Karpov|    skarpov0@ovh.net|\n|      2|           Kari|        Dearth|kdearth1@so-net.n...|\n|      3|         Joanna|      Spennock|jspennock2@redcro...|\n|      4|         Hirsch|       Conaboy|hconaboy3@barnesa...|\n|      5|         Loreen|         Malin|lmalin4@independe...|\n|      6|           Augy|      Christon|  achriston5@mlb.com|\n|      7|         Trudey|       Choupin|     tchoupin6@de.vu|\n|      8|         Nadine|     Grimsdell|ngrimsdell7@sohu.com|\n|      9|        Vassily|         Tamas|vtamas8@businessw...|\n|     10|          Wells|      Simpkins|wsimpkins9@amazon...|\n+-------+---------------+--------------+--------------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641726178977,"submitTime":1641726175724,"finishTime":1641726179261,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"84564a9c-56ba-4596-9ab9-3ac5acb45d7e"},{"version":"CommandV1","origId":1575837098435985,"guid":"06db47a8-b4f8-4ba8-bc1e-2fe068774366","subtype":"command","commandType":"auto","position":6.0,"command":"course_enrolments_df.show()","commandVersion":6,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+-------------------+-------+---------+----------+\n|course_enrolment_id|user_id|course_id|price_paid|\n+-------------------+-------+---------+----------+\n|                  1|     10|        2|      9.99|\n|                  2|      5|        2|      9.99|\n|                  3|      7|        5|     10.99|\n|                  4|      9|        2|      9.99|\n|                  5|      8|        2|      9.99|\n|                  6|      5|        5|     10.99|\n|                  7|      4|        5|     10.99|\n|                  8|      7|        3|     10.99|\n|                  9|      8|        5|     10.99|\n|                 10|      3|        3|     10.99|\n|                 11|      7|        5|     10.99|\n|                 12|      3|        2|      9.99|\n|                 13|      5|        2|      9.99|\n|                 14|      4|        3|     10.99|\n|                 15|      8|        2|      9.99|\n+-------------------+-------+---------+----------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641726179267,"submitTime":1641726175785,"finishTime":1641726179624,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"2759a6ae-787f-4a4d-9406-73c249ca986f"},{"version":"CommandV1","origId":1575837098435986,"guid":"6d84483a-dd7c-4d0f-93b1-2e8f7449ad43","subtype":"command","commandType":"auto","position":7.0,"command":"","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"1baaed33-65f7-4711-a509-32381f28fa91"}],"dashboards":[],"guid":"b73dcc84-ec90-4411-a980-fd545e393a7e","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{"pythonIndentUnit":4}}