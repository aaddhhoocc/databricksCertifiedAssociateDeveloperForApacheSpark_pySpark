{"version":"NotebookV1","origId":1575837098435954,"name":"07 Performing Outer Join using right between Spark Data Frames","language":"python","commands":[{"version":"CommandV1","origId":1575837098435955,"guid":"cfcf1499-7c92-45bd-ac9f-760412b97759","subtype":"command","commandType":"auto","position":1.0,"command":"%run \"./02 Setup Data Sets to perform joins\"","commandVersion":1,"state":"finished","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641736251775,"submitTime":1641736251775,"finishTime":1641736252898,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"1bbb8fa7-31f4-4b5f-84a1-bce5322a589f"},{"version":"CommandV1","origId":1575837098435956,"guid":"2111a18f-c7e4-4af4-a04d-454346f35cb1","subtype":"script","commandType":"auto","position":1.125,"command":"","commandVersion":2,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641736252036,"submitTime":0,"finishTime":1641736252055,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["cfcf1499-7c92-45bd-ac9f-760412b97759"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":true,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"df318a68-188c-46f5-82d9-4e4fea16a620"},{"version":"CommandV1","origId":1575837098435957,"guid":"dd7f93bd-ae81-4560-aa9d-29efce956701","subtype":"script","commandType":"auto","position":1.25,"command":"","commandVersion":167,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"courses_df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"course_id","nullable":true,"type":"long"},{"metadata":{},"name":"course_title","nullable":true,"type":"string"},{"metadata":{},"name":"course_published_dt","nullable":true,"type":"date"},{"metadata":{},"name":"is_active","nullable":true,"type":"boolean"},{"metadata":{},"name":"last_updated_ts","nullable":true,"type":"timestamp"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641736252068,"submitTime":0,"finishTime":1641736252145,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["cfcf1499-7c92-45bd-ac9f-760412b97759"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"5838f058-24cd-49f4-b849-de3f130dee8b"},{"version":"CommandV1","origId":1575837098435958,"guid":"b0404b75-8a3b-4736-a2b7-503b69cf0536","subtype":"script","commandType":"auto","position":1.375,"command":"","commandVersion":14,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"users_df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"user_id","nullable":true,"type":"long"},{"metadata":{},"name":"user_first_name","nullable":true,"type":"string"},{"metadata":{},"name":"user_last_name","nullable":true,"type":"string"},{"metadata":{},"name":"user_email","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641736252151,"submitTime":0,"finishTime":1641736252204,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["cfcf1499-7c92-45bd-ac9f-760412b97759"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"a03a3b12-1e57-467e-9ec3-5e70e7316c1e"},{"version":"CommandV1","origId":1575837098435959,"guid":"762395cc-dc36-4e3e-9832-702f0801ef78","subtype":"script","commandType":"auto","position":1.5,"command":"","commandVersion":81,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"course_enrolments_df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"course_enrolment_id","nullable":true,"type":"long"},{"metadata":{},"name":"user_id","nullable":true,"type":"long"},{"metadata":{},"name":"course_id","nullable":true,"type":"long"},{"metadata":{},"name":"price_paid","nullable":true,"type":"double"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641736252209,"submitTime":0,"finishTime":1641736252268,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["cfcf1499-7c92-45bd-ac9f-760412b97759"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"e442d912-c35c-473c-ac6b-d655a7b3bc49"},{"version":"CommandV1","origId":1575837098435960,"guid":"4d83e472-3ec2-45a9-998e-0c3529cb7b01","subtype":"script","commandType":"auto","position":1.625,"command":"","commandVersion":6,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+---------+--------------------+-------------------+---------+-------------------+\n|course_id|        course_title|course_published_dt|is_active|    last_updated_ts|\n+---------+--------------------+-------------------+---------+-------------------+\n|        1|    Mastering Python|         2021-01-14|     true|2021-02-18 16:57:25|\n|        2|Data Engineering ...|         2021-02-10|     true|2021-03-05 12:07:33|\n|        3|   Mastering Pyspark|         2021-01-07|     true|2021-04-06 10:05:42|\n|        4|      AWS Essentials|         2021-03-19|    false|2021-04-10 02:25:36|\n|        5|          Docker 101|         2021-02-28|     true|2021-03-21 07:18:52|\n+---------+--------------------+-------------------+---------+-------------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641736252272,"submitTime":0,"finishTime":1641736252396,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["cfcf1499-7c92-45bd-ac9f-760412b97759"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"60130f0e-6b80-40fb-bb54-5975cf7238b1"},{"version":"CommandV1","origId":1575837098435961,"guid":"3664aa61-125e-4764-a619-15d0d7ebf744","subtype":"script","commandType":"auto","position":1.75,"command":"","commandVersion":5,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+-------+---------------+--------------+--------------------+\n|user_id|user_first_name|user_last_name|          user_email|\n+-------+---------------+--------------+--------------------+\n|      1|         Sandra|        Karpov|    skarpov0@ovh.net|\n|      2|           Kari|        Dearth|kdearth1@so-net.n...|\n|      3|         Joanna|      Spennock|jspennock2@redcro...|\n|      4|         Hirsch|       Conaboy|hconaboy3@barnesa...|\n|      5|         Loreen|         Malin|lmalin4@independe...|\n|      6|           Augy|      Christon|  achriston5@mlb.com|\n|      7|         Trudey|       Choupin|     tchoupin6@de.vu|\n|      8|         Nadine|     Grimsdell|ngrimsdell7@sohu.com|\n|      9|        Vassily|         Tamas|vtamas8@businessw...|\n|     10|          Wells|      Simpkins|wsimpkins9@amazon...|\n+-------+---------------+--------------+--------------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641736252400,"submitTime":0,"finishTime":1641736252558,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["cfcf1499-7c92-45bd-ac9f-760412b97759"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"84564a9c-56ba-4596-9ab9-3ac5acb45d7e"},{"version":"CommandV1","origId":1575837098435962,"guid":"a8d831c2-b3c5-4e1b-8ee2-4f4ff69db426","subtype":"script","commandType":"auto","position":1.875,"command":"","commandVersion":6,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+-------------------+-------+---------+----------+\n|course_enrolment_id|user_id|course_id|price_paid|\n+-------------------+-------+---------+----------+\n|                  1|     10|        2|      9.99|\n|                  2|      5|        2|      9.99|\n|                  3|      7|        5|     10.99|\n|                  4|      9|        2|      9.99|\n|                  5|      8|        2|      9.99|\n|                  6|      5|        5|     10.99|\n|                  7|      4|        5|     10.99|\n|                  8|      7|        3|     10.99|\n|                  9|      8|        5|     10.99|\n|                 10|      3|        3|     10.99|\n|                 11|      7|        5|     10.99|\n|                 12|      3|        2|      9.99|\n|                 13|      5|        2|      9.99|\n|                 14|      4|        3|     10.99|\n|                 15|      8|        2|      9.99|\n+-------------------+-------+---------+----------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641736252562,"submitTime":0,"finishTime":1641736252717,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["cfcf1499-7c92-45bd-ac9f-760412b97759"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"2759a6ae-787f-4a4d-9406-73c249ca986f"},{"version":"CommandV1","origId":1575837098435963,"guid":"7e4d7ac2-a30f-4104-b906-f88bc4628dff","subtype":"command","commandType":"auto","position":2.0,"command":"help(courses_df.join)","commandVersion":6,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Help on method join in module pyspark.sql.dataframe:\n\njoin(other, on=None, how=None) method of pyspark.sql.dataframe.DataFrame instance\n    Joins with another :class:`DataFrame`, using the given join expression.\n    \n    .. versionadded:: 1.3.0\n    \n    Parameters\n    ----------\n    other : :class:`DataFrame`\n        Right side of the join\n    on : str, list or :class:`Column`, optional\n        a string for the join column name, a list of column names,\n        a join expression (Column), or a list of Columns.\n        If `on` is a string or a list of strings indicating the name of the join column(s),\n        the column(s) must exist on both sides, and this performs an equi-join.\n    how : str, optional\n        default ``inner``. Must be one of: ``inner``, ``cross``, ``outer``,\n        ``full``, ``fullouter``, ``full_outer``, ``left``, ``leftouter``, ``left_outer``,\n        ``right``, ``rightouter``, ``right_outer``, ``semi``, ``leftsemi``, ``left_semi``,\n        ``anti``, ``leftanti`` and ``left_anti``.\n    \n    Examples\n    --------\n    The following performs a full outer join between ``df1`` and ``df2``.\n    \n    &gt;&gt;&gt; from pyspark.sql.functions import desc\n    &gt;&gt;&gt; df.join(df2, df.name == df2.name, &#39;outer&#39;).select(df.name, df2.height)                 .sort(desc(&#34;name&#34;)).collect()\n    [Row(name=&#39;Bob&#39;, height=85), Row(name=&#39;Alice&#39;, height=None), Row(name=None, height=80)]\n    \n    &gt;&gt;&gt; df.join(df2, &#39;name&#39;, &#39;outer&#39;).select(&#39;name&#39;, &#39;height&#39;).sort(desc(&#34;name&#34;)).collect()\n    [Row(name=&#39;Tom&#39;, height=80), Row(name=&#39;Bob&#39;, height=85), Row(name=&#39;Alice&#39;, height=None)]\n    \n    &gt;&gt;&gt; cond = [df.name == df3.name, df.age == df3.age]\n    &gt;&gt;&gt; df.join(df3, cond, &#39;outer&#39;).select(df.name, df3.age).collect()\n    [Row(name=&#39;Alice&#39;, age=2), Row(name=&#39;Bob&#39;, age=5)]\n    \n    &gt;&gt;&gt; df.join(df2, &#39;name&#39;).select(df.name, df2.height).collect()\n    [Row(name=&#39;Bob&#39;, height=85)]\n    \n    &gt;&gt;&gt; df.join(df4, [&#39;name&#39;, &#39;age&#39;]).select(df.name, df.age).collect()\n    [Row(name=&#39;Bob&#39;, age=5)]\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641736252721,"submitTime":1641736251819,"finishTime":1641736252744,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"18efa1da-2805-45bb-bb59-c10c28f21255"},{"version":"CommandV1","origId":1575837098435964,"guid":"33d287aa-c592-481b-98d8-196fad2a0bca","subtype":"command","commandType":"auto","position":3.0,"command":"%md\n\n* Get all the user details along with course enrolment details (if the user have any course enrolments).\n* If the users does not have any course enrolments, we need to get all user details. Course details will be substituted with null values.\n  * Need to perform left or right outer join between **users_df** and **course_enrolments_df**.\n  * We will use right for this lecture. As `users_df` is from parent table and as we are going to use **right outer join**, we need to invoke `join` on top of `users_df`.\n  * Here are the fields that needs to be displayed.\n    * All fields from `users_df`\n    * `course_id` and `course_enrolment_id` from `course_enrolments_df`\n* For this example using these data frames, using just `outer` also give same results. But it is not correct to use `outer`.\n* `how='outer'` means **full outer join**.","commandVersion":216,"state":"finished","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"b3a34dea-33a3-4a5d-81d9-40cd722c5819"},{"version":"CommandV1","origId":1575837098435965,"guid":"75ec83ba-bcfc-49a1-9830-02785feb03b3","subtype":"command","commandType":"auto","position":4.0,"command":"course_enrolments_df. \\\n    join(users_df, users_df.user_id == course_enrolments_df.user_id, 'right'). \\\n    show()","commandVersion":27,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+-------------------+-------+---------+----------+-------+---------------+--------------+--------------------+\n|course_enrolment_id|user_id|course_id|price_paid|user_id|user_first_name|user_last_name|          user_email|\n+-------------------+-------+---------+----------+-------+---------------+--------------+--------------------+\n|               null|   null|     null|      null|      1|         Sandra|        Karpov|    skarpov0@ovh.net|\n|               null|   null|     null|      null|      2|           Kari|        Dearth|kdearth1@so-net.n...|\n|                 10|      3|        3|     10.99|      3|         Joanna|      Spennock|jspennock2@redcro...|\n|                 12|      3|        2|      9.99|      3|         Joanna|      Spennock|jspennock2@redcro...|\n|                  7|      4|        5|     10.99|      4|         Hirsch|       Conaboy|hconaboy3@barnesa...|\n|                 14|      4|        3|     10.99|      4|         Hirsch|       Conaboy|hconaboy3@barnesa...|\n|                  2|      5|        2|      9.99|      5|         Loreen|         Malin|lmalin4@independe...|\n|                  6|      5|        5|     10.99|      5|         Loreen|         Malin|lmalin4@independe...|\n|                 13|      5|        2|      9.99|      5|         Loreen|         Malin|lmalin4@independe...|\n|               null|   null|     null|      null|      6|           Augy|      Christon|  achriston5@mlb.com|\n|                  3|      7|        5|     10.99|      7|         Trudey|       Choupin|     tchoupin6@de.vu|\n|                  8|      7|        3|     10.99|      7|         Trudey|       Choupin|     tchoupin6@de.vu|\n|                 11|      7|        5|     10.99|      7|         Trudey|       Choupin|     tchoupin6@de.vu|\n|                  5|      8|        2|      9.99|      8|         Nadine|     Grimsdell|ngrimsdell7@sohu.com|\n|                  9|      8|        5|     10.99|      8|         Nadine|     Grimsdell|ngrimsdell7@sohu.com|\n|                 15|      8|        2|      9.99|      8|         Nadine|     Grimsdell|ngrimsdell7@sohu.com|\n|                  4|      9|        2|      9.99|      9|        Vassily|         Tamas|vtamas8@businessw...|\n|                  1|     10|        2|      9.99|     10|          Wells|      Simpkins|wsimpkins9@amazon...|\n+-------------------+-------+---------+----------+-------+---------------+--------------+--------------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641736252752,"submitTime":1641736251846,"finishTime":1641736253256,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"3bf4c6f9-f309-4516-88c0-cbbe76e5142c"},{"version":"CommandV1","origId":1575837098435966,"guid":"2c4be356-97de-43ef-9a1d-c16f80ad0391","subtype":"command","commandType":"auto","position":4.5,"command":"# right or right_outer or rightouter are same.\n\ncourse_enrolments_df. \\\n    join(users_df, users_df.user_id == course_enrolments_df.user_id, 'right_outer'). \\\n    show()","commandVersion":34,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+-------------------+-------+---------+----------+-------+---------------+--------------+--------------------+\n|course_enrolment_id|user_id|course_id|price_paid|user_id|user_first_name|user_last_name|          user_email|\n+-------------------+-------+---------+----------+-------+---------------+--------------+--------------------+\n|               null|   null|     null|      null|      1|         Sandra|        Karpov|    skarpov0@ovh.net|\n|               null|   null|     null|      null|      2|           Kari|        Dearth|kdearth1@so-net.n...|\n|                 10|      3|        3|     10.99|      3|         Joanna|      Spennock|jspennock2@redcro...|\n|                 12|      3|        2|      9.99|      3|         Joanna|      Spennock|jspennock2@redcro...|\n|                  7|      4|        5|     10.99|      4|         Hirsch|       Conaboy|hconaboy3@barnesa...|\n|                 14|      4|        3|     10.99|      4|         Hirsch|       Conaboy|hconaboy3@barnesa...|\n|                  2|      5|        2|      9.99|      5|         Loreen|         Malin|lmalin4@independe...|\n|                  6|      5|        5|     10.99|      5|         Loreen|         Malin|lmalin4@independe...|\n|                 13|      5|        2|      9.99|      5|         Loreen|         Malin|lmalin4@independe...|\n|               null|   null|     null|      null|      6|           Augy|      Christon|  achriston5@mlb.com|\n|                  3|      7|        5|     10.99|      7|         Trudey|       Choupin|     tchoupin6@de.vu|\n|                  8|      7|        3|     10.99|      7|         Trudey|       Choupin|     tchoupin6@de.vu|\n|                 11|      7|        5|     10.99|      7|         Trudey|       Choupin|     tchoupin6@de.vu|\n|                  5|      8|        2|      9.99|      8|         Nadine|     Grimsdell|ngrimsdell7@sohu.com|\n|                  9|      8|        5|     10.99|      8|         Nadine|     Grimsdell|ngrimsdell7@sohu.com|\n|                 15|      8|        2|      9.99|      8|         Nadine|     Grimsdell|ngrimsdell7@sohu.com|\n|                  4|      9|        2|      9.99|      9|        Vassily|         Tamas|vtamas8@businessw...|\n|                  1|     10|        2|      9.99|     10|          Wells|      Simpkins|wsimpkins9@amazon...|\n+-------------------+-------+---------+----------+-------+---------------+--------------+--------------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641736253266,"submitTime":1641736251852,"finishTime":1641736253771,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"a533d34c-8933-411d-83e9-0569134fdc3e"},{"version":"CommandV1","origId":1575837098435967,"guid":"6837cce7-e71a-4a26-abb3-da6ae7ea2fa8","subtype":"command","commandType":"auto","position":4.75,"command":"course_enrolments_df. \\\n    join(users_df, 'user_id', 'right'). \\\n    show()","commandVersion":8,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+-------+-------------------+---------+----------+---------------+--------------+--------------------+\n|user_id|course_enrolment_id|course_id|price_paid|user_first_name|user_last_name|          user_email|\n+-------+-------------------+---------+----------+---------------+--------------+--------------------+\n|      1|               null|     null|      null|         Sandra|        Karpov|    skarpov0@ovh.net|\n|      2|               null|     null|      null|           Kari|        Dearth|kdearth1@so-net.n...|\n|      3|                 10|        3|     10.99|         Joanna|      Spennock|jspennock2@redcro...|\n|      3|                 12|        2|      9.99|         Joanna|      Spennock|jspennock2@redcro...|\n|      4|                  7|        5|     10.99|         Hirsch|       Conaboy|hconaboy3@barnesa...|\n|      4|                 14|        3|     10.99|         Hirsch|       Conaboy|hconaboy3@barnesa...|\n|      5|                  2|        2|      9.99|         Loreen|         Malin|lmalin4@independe...|\n|      5|                  6|        5|     10.99|         Loreen|         Malin|lmalin4@independe...|\n|      5|                 13|        2|      9.99|         Loreen|         Malin|lmalin4@independe...|\n|      6|               null|     null|      null|           Augy|      Christon|  achriston5@mlb.com|\n|      7|                  3|        5|     10.99|         Trudey|       Choupin|     tchoupin6@de.vu|\n|      7|                  8|        3|     10.99|         Trudey|       Choupin|     tchoupin6@de.vu|\n|      7|                 11|        5|     10.99|         Trudey|       Choupin|     tchoupin6@de.vu|\n|      8|                  5|        2|      9.99|         Nadine|     Grimsdell|ngrimsdell7@sohu.com|\n|      8|                  9|        5|     10.99|         Nadine|     Grimsdell|ngrimsdell7@sohu.com|\n|      8|                 15|        2|      9.99|         Nadine|     Grimsdell|ngrimsdell7@sohu.com|\n|      9|                  4|        2|      9.99|        Vassily|         Tamas|vtamas8@businessw...|\n|     10|                  1|        2|      9.99|          Wells|      Simpkins|wsimpkins9@amazon...|\n+-------+-------------------+---------+----------+---------------+--------------+--------------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641736253777,"submitTime":1641736251862,"finishTime":1641736254036,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"7e6afdd3-2b05-4007-8649-733c4696503a"},{"version":"CommandV1","origId":1575837098435968,"guid":"c465e44d-921d-419e-8573-1d3de727d72a","subtype":"command","commandType":"auto","position":5.0,"command":"course_enrolments_df. \\\n    join(users_df, users_df.user_id == course_enrolments_df.user_id, 'right'). \\\n    select(users_df['*'], course_enrolments_df['course_id'], course_enrolments_df['course_enrolment_id']). \\\n    show()","commandVersion":29,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+-------+---------------+--------------+--------------------+---------+-------------------+\n|user_id|user_first_name|user_last_name|          user_email|course_id|course_enrolment_id|\n+-------+---------------+--------------+--------------------+---------+-------------------+\n|      1|         Sandra|        Karpov|    skarpov0@ovh.net|     null|               null|\n|      2|           Kari|        Dearth|kdearth1@so-net.n...|     null|               null|\n|      3|         Joanna|      Spennock|jspennock2@redcro...|        3|                 10|\n|      3|         Joanna|      Spennock|jspennock2@redcro...|        2|                 12|\n|      4|         Hirsch|       Conaboy|hconaboy3@barnesa...|        5|                  7|\n|      4|         Hirsch|       Conaboy|hconaboy3@barnesa...|        3|                 14|\n|      5|         Loreen|         Malin|lmalin4@independe...|        2|                  2|\n|      5|         Loreen|         Malin|lmalin4@independe...|        5|                  6|\n|      5|         Loreen|         Malin|lmalin4@independe...|        2|                 13|\n|      6|           Augy|      Christon|  achriston5@mlb.com|     null|               null|\n|      7|         Trudey|       Choupin|     tchoupin6@de.vu|        5|                  3|\n|      7|         Trudey|       Choupin|     tchoupin6@de.vu|        3|                  8|\n|      7|         Trudey|       Choupin|     tchoupin6@de.vu|        5|                 11|\n|      8|         Nadine|     Grimsdell|ngrimsdell7@sohu.com|        2|                  5|\n|      8|         Nadine|     Grimsdell|ngrimsdell7@sohu.com|        5|                  9|\n|      8|         Nadine|     Grimsdell|ngrimsdell7@sohu.com|        2|                 15|\n|      9|        Vassily|         Tamas|vtamas8@businessw...|        2|                  4|\n|     10|          Wells|      Simpkins|wsimpkins9@amazon...|        2|                  1|\n+-------+---------------+--------------+--------------------+---------+-------------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641736254040,"submitTime":1641736251871,"finishTime":1641736254413,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"c4d96db9-0121-45c6-8f08-2d747fd2fee1"},{"version":"CommandV1","origId":1575837098435969,"guid":"4f582bd4-9de9-4b38-80f5-43e6af7f322e","subtype":"command","commandType":"auto","position":6.0,"command":"# using alias\ncourse_enrolments_df.alias('ce'). \\\n    join(users_df.alias('u'), users_df.user_id == course_enrolments_df.user_id, 'right'). \\\n    select('u.*', 'course_id', 'course_enrolment_id'). \\\n    show()","commandVersion":53,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+-------+---------------+--------------+--------------------+---------+-------------------+\n|user_id|user_first_name|user_last_name|          user_email|course_id|course_enrolment_id|\n+-------+---------------+--------------+--------------------+---------+-------------------+\n|      1|         Sandra|        Karpov|    skarpov0@ovh.net|     null|               null|\n|      2|           Kari|        Dearth|kdearth1@so-net.n...|     null|               null|\n|      3|         Joanna|      Spennock|jspennock2@redcro...|        3|                 10|\n|      3|         Joanna|      Spennock|jspennock2@redcro...|        2|                 12|\n|      4|         Hirsch|       Conaboy|hconaboy3@barnesa...|        5|                  7|\n|      4|         Hirsch|       Conaboy|hconaboy3@barnesa...|        3|                 14|\n|      5|         Loreen|         Malin|lmalin4@independe...|        2|                  2|\n|      5|         Loreen|         Malin|lmalin4@independe...|        5|                  6|\n|      5|         Loreen|         Malin|lmalin4@independe...|        2|                 13|\n|      6|           Augy|      Christon|  achriston5@mlb.com|     null|               null|\n|      7|         Trudey|       Choupin|     tchoupin6@de.vu|        5|                  3|\n|      7|         Trudey|       Choupin|     tchoupin6@de.vu|        3|                  8|\n|      7|         Trudey|       Choupin|     tchoupin6@de.vu|        5|                 11|\n|      8|         Nadine|     Grimsdell|ngrimsdell7@sohu.com|        2|                  5|\n|      8|         Nadine|     Grimsdell|ngrimsdell7@sohu.com|        5|                  9|\n|      8|         Nadine|     Grimsdell|ngrimsdell7@sohu.com|        2|                 15|\n|      9|        Vassily|         Tamas|vtamas8@businessw...|        2|                  4|\n|     10|          Wells|      Simpkins|wsimpkins9@amazon...|        2|                  1|\n+-------+---------------+--------------+--------------------+---------+-------------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641736254418,"submitTime":1641736251882,"finishTime":1641736254671,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"bef8ab8e-b001-4100-9c15-a47e657217b4"},{"version":"CommandV1","origId":1575837098435970,"guid":"3f38b353-6b6b-4b01-b1cc-4618b26ab4be","subtype":"command","commandType":"auto","position":7.0,"command":"# Get all the users who have not enroled for any courses\n# Recommended to use primary key in the child table when comparing with null values\n\ncourse_enrolments_df.alias('ce'). \\\n    join(users_df.alias('u'), users_df.user_id == course_enrolments_df.user_id, 'right'). \\\n    filter('ce.course_enrolment_id IS NULL'). \\\n    select('u.*', 'course_id', 'course_enrolment_id'). \\\n    show()","commandVersion":44,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+-------+---------------+--------------+--------------------+---------+-------------------+\n|user_id|user_first_name|user_last_name|          user_email|course_id|course_enrolment_id|\n+-------+---------------+--------------+--------------------+---------+-------------------+\n|      1|         Sandra|        Karpov|    skarpov0@ovh.net|     null|               null|\n|      2|           Kari|        Dearth|kdearth1@so-net.n...|     null|               null|\n|      6|           Augy|      Christon|  achriston5@mlb.com|     null|               null|\n+-------+---------------+--------------+--------------------+---------+-------------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641736254676,"submitTime":1641736251891,"finishTime":1641736255206,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"bf96596b-cab3-4480-b15b-d76031c4c538"},{"version":"CommandV1","origId":1575837098435971,"guid":"53960764-9741-4b93-85d2-111f3cbc1e4a","subtype":"command","commandType":"auto","position":8.0,"command":"%md\n\n* Get number of courses enroled by each user\n* If there are no enrolments, then count should return 0","commandVersion":43,"state":"finished","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"65d88175-0fe0-441d-95a8-45bcb79cfb5d"},{"version":"CommandV1","origId":1575837098435972,"guid":"6763e505-b00e-4daa-9a6a-9358ea08fe24","subtype":"command","commandType":"auto","position":8.5,"command":"# count will give incorrect results\n# Even though users 1, 2, 6 are not enrolled for any courses, it returns 1\ncourse_enrolments_df.alias('ce'). \\\n    join(users_df.alias('u'), users_df.user_id == course_enrolments_df.user_id, 'right'). \\\n    groupBy('u.user_id'). \\\n    count(). \\\n    orderBy('u.user_id'). \\\n    show()","commandVersion":31,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+-------+-----+\n|user_id|count|\n+-------+-----+\n|      1|    1|\n|      2|    1|\n|      3|    2|\n|      4|    2|\n|      5|    3|\n|      6|    1|\n|      7|    3|\n|      8|    3|\n|      9|    1|\n|     10|    1|\n+-------+-----+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641736255211,"submitTime":1641736251922,"finishTime":1641736255765,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"309f7070-1247-422c-ac14-fd33873ec2c4"},{"version":"CommandV1","origId":1575837098435973,"guid":"177d1e89-42e5-4cfd-b6ec-f04aee752c6b","subtype":"command","commandType":"auto","position":8.75,"command":"from pyspark.sql.functions import sum, when","commandVersion":18,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641736255771,"submitTime":1641736251929,"finishTime":1641736255785,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"60f965f4-2375-41c9-a884-6b28ba9ed9b7"},{"version":"CommandV1","origId":1575837098435974,"guid":"3a16a268-7393-4ac4-b722-428d9eb53e4b","subtype":"command","commandType":"auto","position":9.0,"command":"course_enrolments_df.alias('ce'). \\\n    join(users_df.alias('u'), users_df.user_id == course_enrolments_df.user_id, 'right'). \\\n    groupBy('u.user_id'). \\\n    agg(sum(when(course_enrolments_df['course_enrolment_id'].isNull(), 0).otherwise(1)).alias('course_count')). \\\n    orderBy('u.user_id'). \\\n    show()","commandVersion":55,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+-------+------------+\n|user_id|course_count|\n+-------+------------+\n|      1|           0|\n|      2|           0|\n|      3|           2|\n|      4|           2|\n|      5|           3|\n|      6|           0|\n|      7|           3|\n|      8|           3|\n|      9|           1|\n|     10|           1|\n+-------+------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641736255789,"submitTime":1641736251938,"finishTime":1641736256413,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"d02601f0-ae0d-4248-be96-187a41f48a13"},{"version":"CommandV1","origId":1575837098435975,"guid":"83527215-df5a-4fe5-8bc8-ff5f377b5fff","subtype":"command","commandType":"auto","position":9.5,"command":"from pyspark.sql.functions import expr","commandVersion":6,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641736256419,"submitTime":1641736251946,"finishTime":1641736256437,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"d432d69f-18a7-49e9-98d3-9c1c332b4e11"},{"version":"CommandV1","origId":1575837098435976,"guid":"1478b48f-cc03-4332-b843-bac024991370","subtype":"command","commandType":"auto","position":10.0,"command":"course_enrolments_df.alias('ce'). \\\n    join(users_df.alias('u'), users_df.user_id == course_enrolments_df.user_id, 'right'). \\\n    groupBy('u.user_id'). \\\n    agg(sum(expr('''\n        CASE WHEN ce.course_enrolment_id IS NULL\n            THEN 0\n        ELSE 1\n        END\n    ''')).alias('course_count')). \\\n    orderBy('u.user_id'). \\\n    show()","commandVersion":30,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+-------+------------+\n|user_id|course_count|\n+-------+------------+\n|      1|           0|\n|      2|           0|\n|      3|           2|\n|      4|           2|\n|      5|           3|\n|      6|           0|\n|      7|           3|\n|      8|           3|\n|      9|           1|\n|     10|           1|\n+-------+------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641736256444,"submitTime":1641736251954,"finishTime":1641736256808,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"ce3d81f3-fa73-4c71-8ee2-cf31afbfb10d"},{"version":"CommandV1","origId":1575837098435977,"guid":"2f1cfc02-e7e7-47d7-b129-2119f4a348a9","subtype":"command","commandType":"auto","position":11.0,"command":"","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"ce732691-28ec-425e-ba48-9c22c9b17357"}],"dashboards":[],"guid":"08222cd0-7dfd-4c45-a8e3-233c1a9e0939","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{"pythonIndentUnit":4}}