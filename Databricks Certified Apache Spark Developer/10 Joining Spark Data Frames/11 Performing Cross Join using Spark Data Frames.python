{"version":"NotebookV1","origId":1575837098436002,"name":"11 Performing Cross Join using Spark Data Frames","language":"python","commands":[{"version":"CommandV1","origId":1575837098436003,"guid":"c7ae5750-7034-4578-babf-ad4b37e1e599","subtype":"command","commandType":"auto","position":1.0,"command":"%run \"./02 Setup Data Sets to perform joins\"","commandVersion":1,"state":"finished","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641741468745,"submitTime":1641741468745,"finishTime":1641741481238,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"15e548c4-3e82-41cf-8700-928072774742"},{"version":"CommandV1","origId":1575837098436004,"guid":"fe3697e8-d81c-478f-9dbf-9ee42b8d5ee9","subtype":"script","commandType":"auto","position":1.125,"command":"","commandVersion":2,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641741472125,"submitTime":0,"finishTime":1641741473191,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["c7ae5750-7034-4578-babf-ad4b37e1e599"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":true,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"df318a68-188c-46f5-82d9-4e4fea16a620"},{"version":"CommandV1","origId":1575837098436005,"guid":"25f46ade-9903-4f6a-8e7f-e92e8a5c032b","subtype":"script","commandType":"auto","position":1.25,"command":"","commandVersion":167,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"courses_df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"course_id","nullable":true,"type":"long"},{"metadata":{},"name":"course_title","nullable":true,"type":"string"},{"metadata":{},"name":"course_published_dt","nullable":true,"type":"date"},{"metadata":{},"name":"is_active","nullable":true,"type":"boolean"},{"metadata":{},"name":"last_updated_ts","nullable":true,"type":"timestamp"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641741473456,"submitTime":0,"finishTime":1641741474940,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["c7ae5750-7034-4578-babf-ad4b37e1e599"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"5838f058-24cd-49f4-b849-de3f130dee8b"},{"version":"CommandV1","origId":1575837098436006,"guid":"2c0c51ca-90d7-4679-8ac0-39325d3981ab","subtype":"script","commandType":"auto","position":1.375,"command":"","commandVersion":14,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"users_df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"user_id","nullable":true,"type":"long"},{"metadata":{},"name":"user_first_name","nullable":true,"type":"string"},{"metadata":{},"name":"user_last_name","nullable":true,"type":"string"},{"metadata":{},"name":"user_email","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641741474985,"submitTime":0,"finishTime":1641741475472,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["c7ae5750-7034-4578-babf-ad4b37e1e599"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"a03a3b12-1e57-467e-9ec3-5e70e7316c1e"},{"version":"CommandV1","origId":1575837098436007,"guid":"5c930fc3-23b1-4aa4-a297-65e249af8418","subtype":"script","commandType":"auto","position":1.5,"command":"","commandVersion":81,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"course_enrolments_df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"course_enrolment_id","nullable":true,"type":"long"},{"metadata":{},"name":"user_id","nullable":true,"type":"long"},{"metadata":{},"name":"course_id","nullable":true,"type":"long"},{"metadata":{},"name":"price_paid","nullable":true,"type":"double"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641741475487,"submitTime":0,"finishTime":1641741475633,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["c7ae5750-7034-4578-babf-ad4b37e1e599"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"e442d912-c35c-473c-ac6b-d655a7b3bc49"},{"version":"CommandV1","origId":1575837098436008,"guid":"10f550ef-ba52-4289-aee2-921208d1f641","subtype":"command","commandType":"auto","position":1.5,"command":"%md\n\n* `crossJoin` results in cartesian product.","commandVersion":12,"state":"finished","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"224a9ed9-5997-4b6e-bc94-140ee9f7a467"},{"version":"CommandV1","origId":1575837098436009,"guid":"90d09302-b23d-42ed-992d-a85e5e44119c","subtype":"script","commandType":"auto","position":1.625,"command":"","commandVersion":6,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+---------+--------------------+-------------------+---------+-------------------+\n|course_id|        course_title|course_published_dt|is_active|    last_updated_ts|\n+---------+--------------------+-------------------+---------+-------------------+\n|        1|    Mastering Python|         2021-01-14|     true|2021-02-18 16:57:25|\n|        2|Data Engineering ...|         2021-02-10|     true|2021-03-05 12:07:33|\n|        3|   Mastering Pyspark|         2021-01-07|     true|2021-04-06 10:05:42|\n|        4|      AWS Essentials|         2021-03-19|    false|2021-04-10 02:25:36|\n|        5|          Docker 101|         2021-02-28|     true|2021-03-21 07:18:52|\n+---------+--------------------+-------------------+---------+-------------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641741475645,"submitTime":0,"finishTime":1641741479836,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["c7ae5750-7034-4578-babf-ad4b37e1e599"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"60130f0e-6b80-40fb-bb54-5975cf7238b1"},{"version":"CommandV1","origId":1575837098436010,"guid":"99eab1ba-75d4-4dfd-9209-4451f30b1a28","subtype":"script","commandType":"auto","position":1.75,"command":"","commandVersion":5,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+-------+---------------+--------------+--------------------+\n|user_id|user_first_name|user_last_name|          user_email|\n+-------+---------------+--------------+--------------------+\n|      1|         Sandra|        Karpov|    skarpov0@ovh.net|\n|      2|           Kari|        Dearth|kdearth1@so-net.n...|\n|      3|         Joanna|      Spennock|jspennock2@redcro...|\n|      4|         Hirsch|       Conaboy|hconaboy3@barnesa...|\n|      5|         Loreen|         Malin|lmalin4@independe...|\n|      6|           Augy|      Christon|  achriston5@mlb.com|\n|      7|         Trudey|       Choupin|     tchoupin6@de.vu|\n|      8|         Nadine|     Grimsdell|ngrimsdell7@sohu.com|\n|      9|        Vassily|         Tamas|vtamas8@businessw...|\n|     10|          Wells|      Simpkins|wsimpkins9@amazon...|\n+-------+---------------+--------------+--------------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641741479963,"submitTime":0,"finishTime":1641741480532,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["c7ae5750-7034-4578-babf-ad4b37e1e599"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"84564a9c-56ba-4596-9ab9-3ac5acb45d7e"},{"version":"CommandV1","origId":1575837098436011,"guid":"41bec551-7c1c-43ae-aa24-f20db608a27d","subtype":"script","commandType":"auto","position":1.875,"command":"","commandVersion":6,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+-------------------+-------+---------+----------+\n|course_enrolment_id|user_id|course_id|price_paid|\n+-------------------+-------+---------+----------+\n|                  1|     10|        2|      9.99|\n|                  2|      5|        2|      9.99|\n|                  3|      7|        5|     10.99|\n|                  4|      9|        2|      9.99|\n|                  5|      8|        2|      9.99|\n|                  6|      5|        5|     10.99|\n|                  7|      4|        5|     10.99|\n|                  8|      7|        3|     10.99|\n|                  9|      8|        5|     10.99|\n|                 10|      3|        3|     10.99|\n|                 11|      7|        5|     10.99|\n|                 12|      3|        2|      9.99|\n|                 13|      5|        2|      9.99|\n|                 14|      4|        3|     10.99|\n|                 15|      8|        2|      9.99|\n+-------------------+-------+---------+----------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641741480546,"submitTime":0,"finishTime":1641741481210,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["c7ae5750-7034-4578-babf-ad4b37e1e599"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"2759a6ae-787f-4a4d-9406-73c249ca986f"},{"version":"CommandV1","origId":1575837098436012,"guid":"5476492f-b976-4d22-ba64-a38b71353eb6","subtype":"command","commandType":"auto","position":2.0,"command":"help(courses_df.crossJoin)","commandVersion":8,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Help on method crossJoin in module pyspark.sql.dataframe:\n\ncrossJoin(other) method of pyspark.sql.dataframe.DataFrame instance\n    Returns the cartesian product with another :class:`DataFrame`.\n    \n    .. versionadded:: 2.1.0\n    \n    Parameters\n    ----------\n    other : :class:`DataFrame`\n        Right side of the cartesian product.\n    \n    Examples\n    --------\n    &gt;&gt;&gt; df.select(&#34;age&#34;, &#34;name&#34;).collect()\n    [Row(age=2, name=&#39;Alice&#39;), Row(age=5, name=&#39;Bob&#39;)]\n    &gt;&gt;&gt; df2.select(&#34;name&#34;, &#34;height&#34;).collect()\n    [Row(name=&#39;Tom&#39;, height=80), Row(name=&#39;Bob&#39;, height=85)]\n    &gt;&gt;&gt; df.crossJoin(df2.select(&#34;height&#34;)).select(&#34;age&#34;, &#34;name&#34;, &#34;height&#34;).collect()\n    [Row(age=2, name=&#39;Alice&#39;, height=80), Row(age=2, name=&#39;Alice&#39;, height=85),\n     Row(age=5, name=&#39;Bob&#39;, height=80), Row(age=5, name=&#39;Bob&#39;, height=85)]\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641741486299,"submitTime":1641741486259,"finishTime":1641741486347,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"5000b724-abb9-4a1f-9633-673d5d3e8560"},{"version":"CommandV1","origId":1575837098436013,"guid":"d67fb338-d88a-4d24-8692-b210b1936b81","subtype":"command","commandType":"auto","position":3.0,"command":"users_df. \\\n    crossJoin(courses_df). \\\n    show()","commandVersion":12,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+-------+---------------+--------------+--------------------+---------+--------------------+-------------------+---------+-------------------+\n|user_id|user_first_name|user_last_name|          user_email|course_id|        course_title|course_published_dt|is_active|    last_updated_ts|\n+-------+---------------+--------------+--------------------+---------+--------------------+-------------------+---------+-------------------+\n|      1|         Sandra|        Karpov|    skarpov0@ovh.net|        1|    Mastering Python|         2021-01-14|     true|2021-02-18 16:57:25|\n|      2|           Kari|        Dearth|kdearth1@so-net.n...|        1|    Mastering Python|         2021-01-14|     true|2021-02-18 16:57:25|\n|      1|         Sandra|        Karpov|    skarpov0@ovh.net|        2|Data Engineering ...|         2021-02-10|     true|2021-03-05 12:07:33|\n|      2|           Kari|        Dearth|kdearth1@so-net.n...|        2|Data Engineering ...|         2021-02-10|     true|2021-03-05 12:07:33|\n|      1|         Sandra|        Karpov|    skarpov0@ovh.net|        3|   Mastering Pyspark|         2021-01-07|     true|2021-04-06 10:05:42|\n|      2|           Kari|        Dearth|kdearth1@so-net.n...|        3|   Mastering Pyspark|         2021-01-07|     true|2021-04-06 10:05:42|\n|      1|         Sandra|        Karpov|    skarpov0@ovh.net|        4|      AWS Essentials|         2021-03-19|    false|2021-04-10 02:25:36|\n|      1|         Sandra|        Karpov|    skarpov0@ovh.net|        5|          Docker 101|         2021-02-28|     true|2021-03-21 07:18:52|\n|      2|           Kari|        Dearth|kdearth1@so-net.n...|        4|      AWS Essentials|         2021-03-19|    false|2021-04-10 02:25:36|\n|      2|           Kari|        Dearth|kdearth1@so-net.n...|        5|          Docker 101|         2021-02-28|     true|2021-03-21 07:18:52|\n|      3|         Joanna|      Spennock|jspennock2@redcro...|        1|    Mastering Python|         2021-01-14|     true|2021-02-18 16:57:25|\n|      4|         Hirsch|       Conaboy|hconaboy3@barnesa...|        1|    Mastering Python|         2021-01-14|     true|2021-02-18 16:57:25|\n|      3|         Joanna|      Spennock|jspennock2@redcro...|        2|Data Engineering ...|         2021-02-10|     true|2021-03-05 12:07:33|\n|      4|         Hirsch|       Conaboy|hconaboy3@barnesa...|        2|Data Engineering ...|         2021-02-10|     true|2021-03-05 12:07:33|\n|      3|         Joanna|      Spennock|jspennock2@redcro...|        3|   Mastering Pyspark|         2021-01-07|     true|2021-04-06 10:05:42|\n|      4|         Hirsch|       Conaboy|hconaboy3@barnesa...|        3|   Mastering Pyspark|         2021-01-07|     true|2021-04-06 10:05:42|\n|      3|         Joanna|      Spennock|jspennock2@redcro...|        4|      AWS Essentials|         2021-03-19|    false|2021-04-10 02:25:36|\n|      3|         Joanna|      Spennock|jspennock2@redcro...|        5|          Docker 101|         2021-02-28|     true|2021-03-21 07:18:52|\n|      4|         Hirsch|       Conaboy|hconaboy3@barnesa...|        4|      AWS Essentials|         2021-03-19|    false|2021-04-10 02:25:36|\n|      4|         Hirsch|       Conaboy|hconaboy3@barnesa...|        5|          Docker 101|         2021-02-28|     true|2021-03-21 07:18:52|\n+-------+---------------+--------------+--------------------+---------+--------------------+-------------------+---------+-------------------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641741523832,"submitTime":1641741523229,"finishTime":1641741525876,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"ad19f565-6e43-42b2-9d84-4a4f43182bdb"},{"version":"CommandV1","origId":1575837098436014,"guid":"ad3bdfda-7a0c-452e-ab2f-02d70b8f0030","subtype":"command","commandType":"auto","position":3.5,"command":"# Number of records will be equal to \n# number of records in first data frame multipled by number of records in second data frame\nusers_df. \\\n    crossJoin(courses_df). \\\n    count()","commandVersion":30,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Out[11]: 50</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641741590949,"submitTime":1641741590913,"finishTime":1641741592779,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"51270d6b-e1a8-4d4d-a802-ab0809dd64e4"},{"version":"CommandV1","origId":1575837098436015,"guid":"af5ea2fd-b20e-444a-adc1-313ffcb033e0","subtype":"command","commandType":"auto","position":4.0,"command":"# Even join with out conditions result in cross join or cartesian product\nusers_df. \\\n    join(courses_df). \\\n    show()","commandVersion":19,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+-------+---------------+--------------+--------------------+---------+--------------------+-------------------+---------+-------------------+\n|user_id|user_first_name|user_last_name|          user_email|course_id|        course_title|course_published_dt|is_active|    last_updated_ts|\n+-------+---------------+--------------+--------------------+---------+--------------------+-------------------+---------+-------------------+\n|      1|         Sandra|        Karpov|    skarpov0@ovh.net|        1|    Mastering Python|         2021-01-14|     true|2021-02-18 16:57:25|\n|      2|           Kari|        Dearth|kdearth1@so-net.n...|        1|    Mastering Python|         2021-01-14|     true|2021-02-18 16:57:25|\n|      1|         Sandra|        Karpov|    skarpov0@ovh.net|        2|Data Engineering ...|         2021-02-10|     true|2021-03-05 12:07:33|\n|      2|           Kari|        Dearth|kdearth1@so-net.n...|        2|Data Engineering ...|         2021-02-10|     true|2021-03-05 12:07:33|\n|      1|         Sandra|        Karpov|    skarpov0@ovh.net|        3|   Mastering Pyspark|         2021-01-07|     true|2021-04-06 10:05:42|\n|      2|           Kari|        Dearth|kdearth1@so-net.n...|        3|   Mastering Pyspark|         2021-01-07|     true|2021-04-06 10:05:42|\n|      1|         Sandra|        Karpov|    skarpov0@ovh.net|        4|      AWS Essentials|         2021-03-19|    false|2021-04-10 02:25:36|\n|      1|         Sandra|        Karpov|    skarpov0@ovh.net|        5|          Docker 101|         2021-02-28|     true|2021-03-21 07:18:52|\n|      2|           Kari|        Dearth|kdearth1@so-net.n...|        4|      AWS Essentials|         2021-03-19|    false|2021-04-10 02:25:36|\n|      2|           Kari|        Dearth|kdearth1@so-net.n...|        5|          Docker 101|         2021-02-28|     true|2021-03-21 07:18:52|\n|      3|         Joanna|      Spennock|jspennock2@redcro...|        1|    Mastering Python|         2021-01-14|     true|2021-02-18 16:57:25|\n|      4|         Hirsch|       Conaboy|hconaboy3@barnesa...|        1|    Mastering Python|         2021-01-14|     true|2021-02-18 16:57:25|\n|      3|         Joanna|      Spennock|jspennock2@redcro...|        2|Data Engineering ...|         2021-02-10|     true|2021-03-05 12:07:33|\n|      4|         Hirsch|       Conaboy|hconaboy3@barnesa...|        2|Data Engineering ...|         2021-02-10|     true|2021-03-05 12:07:33|\n|      3|         Joanna|      Spennock|jspennock2@redcro...|        3|   Mastering Pyspark|         2021-01-07|     true|2021-04-06 10:05:42|\n|      4|         Hirsch|       Conaboy|hconaboy3@barnesa...|        3|   Mastering Pyspark|         2021-01-07|     true|2021-04-06 10:05:42|\n|      3|         Joanna|      Spennock|jspennock2@redcro...|        4|      AWS Essentials|         2021-03-19|    false|2021-04-10 02:25:36|\n|      3|         Joanna|      Spennock|jspennock2@redcro...|        5|          Docker 101|         2021-02-28|     true|2021-03-21 07:18:52|\n|      4|         Hirsch|       Conaboy|hconaboy3@barnesa...|        4|      AWS Essentials|         2021-03-19|    false|2021-04-10 02:25:36|\n|      4|         Hirsch|       Conaboy|hconaboy3@barnesa...|        5|          Docker 101|         2021-02-28|     true|2021-03-21 07:18:52|\n+-------+---------------+--------------+--------------------+---------+--------------------+-------------------+---------+-------------------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641741534711,"submitTime":1641741534673,"finishTime":1641741535314,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"38ff6d93-22f7-488f-aecd-0a24c1a42fc7"},{"version":"CommandV1","origId":1575837098436016,"guid":"2da26b7d-bb8a-4dcc-a8e1-0c7112f4d675","subtype":"command","commandType":"auto","position":5.0,"command":"users_df. \\\n    join(courses_df). \\\n    count()","commandVersion":2,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Out[12]: 50</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641741604148,"submitTime":1641741604112,"finishTime":1641741604819,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"b5780ac8-9c4c-4ac3-8aac-fd5192f2bcd9"},{"version":"CommandV1","origId":1575837098436017,"guid":"708aa234-3d45-43b0-b8fd-ee51402a9ead","subtype":"command","commandType":"auto","position":6.0,"command":"users_df. \\\n    join(courses_df, how='cross'). \\\n    show()","commandVersion":4,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+-------+---------------+--------------+--------------------+---------+--------------------+-------------------+---------+-------------------+\n|user_id|user_first_name|user_last_name|          user_email|course_id|        course_title|course_published_dt|is_active|    last_updated_ts|\n+-------+---------------+--------------+--------------------+---------+--------------------+-------------------+---------+-------------------+\n|      1|         Sandra|        Karpov|    skarpov0@ovh.net|        1|    Mastering Python|         2021-01-14|     true|2021-02-18 16:57:25|\n|      2|           Kari|        Dearth|kdearth1@so-net.n...|        1|    Mastering Python|         2021-01-14|     true|2021-02-18 16:57:25|\n|      1|         Sandra|        Karpov|    skarpov0@ovh.net|        2|Data Engineering ...|         2021-02-10|     true|2021-03-05 12:07:33|\n|      2|           Kari|        Dearth|kdearth1@so-net.n...|        2|Data Engineering ...|         2021-02-10|     true|2021-03-05 12:07:33|\n|      1|         Sandra|        Karpov|    skarpov0@ovh.net|        3|   Mastering Pyspark|         2021-01-07|     true|2021-04-06 10:05:42|\n|      2|           Kari|        Dearth|kdearth1@so-net.n...|        3|   Mastering Pyspark|         2021-01-07|     true|2021-04-06 10:05:42|\n|      1|         Sandra|        Karpov|    skarpov0@ovh.net|        4|      AWS Essentials|         2021-03-19|    false|2021-04-10 02:25:36|\n|      1|         Sandra|        Karpov|    skarpov0@ovh.net|        5|          Docker 101|         2021-02-28|     true|2021-03-21 07:18:52|\n|      2|           Kari|        Dearth|kdearth1@so-net.n...|        4|      AWS Essentials|         2021-03-19|    false|2021-04-10 02:25:36|\n|      2|           Kari|        Dearth|kdearth1@so-net.n...|        5|          Docker 101|         2021-02-28|     true|2021-03-21 07:18:52|\n|      3|         Joanna|      Spennock|jspennock2@redcro...|        1|    Mastering Python|         2021-01-14|     true|2021-02-18 16:57:25|\n|      4|         Hirsch|       Conaboy|hconaboy3@barnesa...|        1|    Mastering Python|         2021-01-14|     true|2021-02-18 16:57:25|\n|      3|         Joanna|      Spennock|jspennock2@redcro...|        2|Data Engineering ...|         2021-02-10|     true|2021-03-05 12:07:33|\n|      4|         Hirsch|       Conaboy|hconaboy3@barnesa...|        2|Data Engineering ...|         2021-02-10|     true|2021-03-05 12:07:33|\n|      3|         Joanna|      Spennock|jspennock2@redcro...|        3|   Mastering Pyspark|         2021-01-07|     true|2021-04-06 10:05:42|\n|      4|         Hirsch|       Conaboy|hconaboy3@barnesa...|        3|   Mastering Pyspark|         2021-01-07|     true|2021-04-06 10:05:42|\n|      3|         Joanna|      Spennock|jspennock2@redcro...|        4|      AWS Essentials|         2021-03-19|    false|2021-04-10 02:25:36|\n|      3|         Joanna|      Spennock|jspennock2@redcro...|        5|          Docker 101|         2021-02-28|     true|2021-03-21 07:18:52|\n|      4|         Hirsch|       Conaboy|hconaboy3@barnesa...|        4|      AWS Essentials|         2021-03-19|    false|2021-04-10 02:25:36|\n|      4|         Hirsch|       Conaboy|hconaboy3@barnesa...|        5|          Docker 101|         2021-02-28|     true|2021-03-21 07:18:52|\n+-------+---------------+--------------+--------------------+---------+--------------------+-------------------+---------+-------------------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641741619572,"submitTime":1641741619536,"finishTime":1641741620312,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"00d00ad1-5c39-43ca-87a9-4f4302e942bd"},{"version":"CommandV1","origId":1575837098436018,"guid":"8fa5c3b0-be72-4d58-a117-2c724d85498b","subtype":"command","commandType":"auto","position":7.0,"command":"users_df. \\\n    join(courses_df, how='cross'). \\\n    count()","commandVersion":2,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Out[14]: 50</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641741626423,"submitTime":1641741626362,"finishTime":1641741626931,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"d31d3c35-4556-48d3-b913-09b338dfd20a"}],"dashboards":[],"guid":"b3791b99-5120-4a36-8554-2c9061b424d0","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{"pythonIndentUnit":4}}