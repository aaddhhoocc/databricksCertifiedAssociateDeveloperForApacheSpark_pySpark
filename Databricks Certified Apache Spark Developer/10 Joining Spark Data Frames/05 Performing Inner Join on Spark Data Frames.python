{"version":"NotebookV1","origId":1575837098435894,"name":"05 Performing Inner Join on Spark Data Frames","language":"python","commands":[{"version":"CommandV1","origId":1575837098435895,"guid":"55158d6c-7708-4ca5-992e-c73290605e01","subtype":"command","commandType":"auto","position":1.0,"command":"%run \"./02 Setup Data Sets to perform joins\"","commandVersion":1,"state":"finished","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641730153336,"submitTime":1641730153336,"finishTime":1641730154686,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"1bbb8fa7-31f4-4b5f-84a1-bce5322a589f"},{"version":"CommandV1","origId":1575837098435896,"guid":"aefccc6a-8eab-4d7b-ae36-61be78ec4b19","subtype":"script","commandType":"auto","position":1.125,"command":"","commandVersion":2,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641730153533,"submitTime":0,"finishTime":1641730153564,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["55158d6c-7708-4ca5-992e-c73290605e01"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":true,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"df318a68-188c-46f5-82d9-4e4fea16a620"},{"version":"CommandV1","origId":1575837098435897,"guid":"85698eb2-5ea3-46ec-aa8b-fb97d134a06d","subtype":"script","commandType":"auto","position":1.25,"command":"","commandVersion":167,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"courses_df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"course_id","nullable":true,"type":"long"},{"metadata":{},"name":"course_title","nullable":true,"type":"string"},{"metadata":{},"name":"course_published_dt","nullable":true,"type":"date"},{"metadata":{},"name":"is_active","nullable":true,"type":"boolean"},{"metadata":{},"name":"last_updated_ts","nullable":true,"type":"timestamp"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641730153572,"submitTime":0,"finishTime":1641730153646,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["55158d6c-7708-4ca5-992e-c73290605e01"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"5838f058-24cd-49f4-b849-de3f130dee8b"},{"version":"CommandV1","origId":1575837098435898,"guid":"d38adde2-bc37-4363-a394-c5346ae3e74b","subtype":"script","commandType":"auto","position":1.375,"command":"","commandVersion":14,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"users_df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"user_id","nullable":true,"type":"long"},{"metadata":{},"name":"user_first_name","nullable":true,"type":"string"},{"metadata":{},"name":"user_last_name","nullable":true,"type":"string"},{"metadata":{},"name":"user_email","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641730153655,"submitTime":0,"finishTime":1641730153721,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["55158d6c-7708-4ca5-992e-c73290605e01"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"a03a3b12-1e57-467e-9ec3-5e70e7316c1e"},{"version":"CommandV1","origId":1575837098435899,"guid":"fbcc8551-61a0-41ba-98fd-d00291931a04","subtype":"script","commandType":"auto","position":1.5,"command":"","commandVersion":81,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"course_enrolments_df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"course_enrolment_id","nullable":true,"type":"long"},{"metadata":{},"name":"user_id","nullable":true,"type":"long"},{"metadata":{},"name":"course_id","nullable":true,"type":"long"},{"metadata":{},"name":"price_paid","nullable":true,"type":"double"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641730153726,"submitTime":0,"finishTime":1641730153782,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["55158d6c-7708-4ca5-992e-c73290605e01"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"e442d912-c35c-473c-ac6b-d655a7b3bc49"},{"version":"CommandV1","origId":1575837098435900,"guid":"735085b4-3708-4775-90f0-5459fd8476b9","subtype":"script","commandType":"auto","position":1.625,"command":"","commandVersion":6,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+---------+--------------------+-------------------+---------+-------------------+\n|course_id|        course_title|course_published_dt|is_active|    last_updated_ts|\n+---------+--------------------+-------------------+---------+-------------------+\n|        1|    Mastering Python|         2021-01-14|     true|2021-02-18 16:57:25|\n|        2|Data Engineering ...|         2021-02-10|     true|2021-03-05 12:07:33|\n|        3|   Mastering Pyspark|         2021-01-07|     true|2021-04-06 10:05:42|\n|        4|      AWS Essentials|         2021-03-19|    false|2021-04-10 02:25:36|\n|        5|          Docker 101|         2021-02-28|     true|2021-03-21 07:18:52|\n+---------+--------------------+-------------------+---------+-------------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641730153788,"submitTime":0,"finishTime":1641730154000,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["55158d6c-7708-4ca5-992e-c73290605e01"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"60130f0e-6b80-40fb-bb54-5975cf7238b1"},{"version":"CommandV1","origId":1575837098435901,"guid":"16fc8d4f-8de6-40ac-ad1f-622a4f6c63d5","subtype":"script","commandType":"auto","position":1.75,"command":"","commandVersion":5,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+-------+---------------+--------------+--------------------+\n|user_id|user_first_name|user_last_name|          user_email|\n+-------+---------------+--------------+--------------------+\n|      1|         Sandra|        Karpov|    skarpov0@ovh.net|\n|      2|           Kari|        Dearth|kdearth1@so-net.n...|\n|      3|         Joanna|      Spennock|jspennock2@redcro...|\n|      4|         Hirsch|       Conaboy|hconaboy3@barnesa...|\n|      5|         Loreen|         Malin|lmalin4@independe...|\n|      6|           Augy|      Christon|  achriston5@mlb.com|\n|      7|         Trudey|       Choupin|     tchoupin6@de.vu|\n|      8|         Nadine|     Grimsdell|ngrimsdell7@sohu.com|\n|      9|        Vassily|         Tamas|vtamas8@businessw...|\n|     10|          Wells|      Simpkins|wsimpkins9@amazon...|\n+-------+---------------+--------------+--------------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641730154006,"submitTime":0,"finishTime":1641730154185,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["55158d6c-7708-4ca5-992e-c73290605e01"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"84564a9c-56ba-4596-9ab9-3ac5acb45d7e"},{"version":"CommandV1","origId":1575837098435902,"guid":"062bc4bc-9c8e-4903-9774-a742460eb94f","subtype":"script","commandType":"auto","position":1.875,"command":"","commandVersion":6,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+-------------------+-------+---------+----------+\n|course_enrolment_id|user_id|course_id|price_paid|\n+-------------------+-------+---------+----------+\n|                  1|     10|        2|      9.99|\n|                  2|      5|        2|      9.99|\n|                  3|      7|        5|     10.99|\n|                  4|      9|        2|      9.99|\n|                  5|      8|        2|      9.99|\n|                  6|      5|        5|     10.99|\n|                  7|      4|        5|     10.99|\n|                  8|      7|        3|     10.99|\n|                  9|      8|        5|     10.99|\n|                 10|      3|        3|     10.99|\n|                 11|      7|        5|     10.99|\n|                 12|      3|        2|      9.99|\n|                 13|      5|        2|      9.99|\n|                 14|      4|        3|     10.99|\n|                 15|      8|        2|      9.99|\n+-------------------+-------+---------+----------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641730154193,"submitTime":0,"finishTime":1641730154413,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["55158d6c-7708-4ca5-992e-c73290605e01"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"2759a6ae-787f-4a4d-9406-73c249ca986f"},{"version":"CommandV1","origId":1575837098435903,"guid":"597dc4ab-82e9-4c40-94d7-7ad16fd4235b","subtype":"command","commandType":"auto","position":2.0,"command":"help(courses_df.join)","commandVersion":6,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Help on method join in module pyspark.sql.dataframe:\n\njoin(other, on=None, how=None) method of pyspark.sql.dataframe.DataFrame instance\n    Joins with another :class:`DataFrame`, using the given join expression.\n    \n    .. versionadded:: 1.3.0\n    \n    Parameters\n    ----------\n    other : :class:`DataFrame`\n        Right side of the join\n    on : str, list or :class:`Column`, optional\n        a string for the join column name, a list of column names,\n        a join expression (Column), or a list of Columns.\n        If `on` is a string or a list of strings indicating the name of the join column(s),\n        the column(s) must exist on both sides, and this performs an equi-join.\n    how : str, optional\n        default ``inner``. Must be one of: ``inner``, ``cross``, ``outer``,\n        ``full``, ``fullouter``, ``full_outer``, ``left``, ``leftouter``, ``left_outer``,\n        ``right``, ``rightouter``, ``right_outer``, ``semi``, ``leftsemi``, ``left_semi``,\n        ``anti``, ``leftanti`` and ``left_anti``.\n    \n    Examples\n    --------\n    The following performs a full outer join between ``df1`` and ``df2``.\n    \n    &gt;&gt;&gt; from pyspark.sql.functions import desc\n    &gt;&gt;&gt; df.join(df2, df.name == df2.name, &#39;outer&#39;).select(df.name, df2.height)                 .sort(desc(&#34;name&#34;)).collect()\n    [Row(name=&#39;Bob&#39;, height=85), Row(name=&#39;Alice&#39;, height=None), Row(name=None, height=80)]\n    \n    &gt;&gt;&gt; df.join(df2, &#39;name&#39;, &#39;outer&#39;).select(&#39;name&#39;, &#39;height&#39;).sort(desc(&#34;name&#34;)).collect()\n    [Row(name=&#39;Tom&#39;, height=80), Row(name=&#39;Bob&#39;, height=85), Row(name=&#39;Alice&#39;, height=None)]\n    \n    &gt;&gt;&gt; cond = [df.name == df3.name, df.age == df3.age]\n    &gt;&gt;&gt; df.join(df3, cond, &#39;outer&#39;).select(df.name, df3.age).collect()\n    [Row(name=&#39;Alice&#39;, age=2), Row(name=&#39;Bob&#39;, age=5)]\n    \n    &gt;&gt;&gt; df.join(df2, &#39;name&#39;).select(df.name, df2.height).collect()\n    [Row(name=&#39;Bob&#39;, height=85)]\n    \n    &gt;&gt;&gt; df.join(df4, [&#39;name&#39;, &#39;age&#39;]).select(df.name, df.age).collect()\n    [Row(name=&#39;Bob&#39;, age=5)]\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641730154420,"submitTime":1641730153372,"finishTime":1641730154437,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"18efa1da-2805-45bb-bb59-c10c28f21255"},{"version":"CommandV1","origId":1575837098435904,"guid":"dc928c7d-aeb3-424c-a4b3-c57d59217eb3","subtype":"command","commandType":"auto","position":3.0,"command":"%md\n\n* Get the user details who have enrolled for the courses.\n  * Need to join **users_df** and **course_enrolments_df**.\n  * Here are the fields that needs to be displayed.\n    * All fields from `users_df`\n    * `course_id` and `course_enrolment_id` from `course_enrolments`","commandVersion":68,"state":"finished","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"b3a34dea-33a3-4a5d-81d9-40cd722c5819"},{"version":"CommandV1","origId":1575837098435905,"guid":"8ba1dffe-d17a-4023-93ee-ad74c2101ab7","subtype":"command","commandType":"auto","position":4.0,"command":"users_df. \\\n    join(course_enrolments_df, users_df.user_id == course_enrolments_df.user_id). \\\n    show()","commandVersion":21,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+-------+---------------+--------------+--------------------+-------------------+-------+---------+----------+\n|user_id|user_first_name|user_last_name|          user_email|course_enrolment_id|user_id|course_id|price_paid|\n+-------+---------------+--------------+--------------------+-------------------+-------+---------+----------+\n|      3|         Joanna|      Spennock|jspennock2@redcro...|                 10|      3|        3|     10.99|\n|      3|         Joanna|      Spennock|jspennock2@redcro...|                 12|      3|        2|      9.99|\n|      4|         Hirsch|       Conaboy|hconaboy3@barnesa...|                  7|      4|        5|     10.99|\n|      4|         Hirsch|       Conaboy|hconaboy3@barnesa...|                 14|      4|        3|     10.99|\n|      5|         Loreen|         Malin|lmalin4@independe...|                  2|      5|        2|      9.99|\n|      5|         Loreen|         Malin|lmalin4@independe...|                  6|      5|        5|     10.99|\n|      5|         Loreen|         Malin|lmalin4@independe...|                 13|      5|        2|      9.99|\n|      7|         Trudey|       Choupin|     tchoupin6@de.vu|                  3|      7|        5|     10.99|\n|      7|         Trudey|       Choupin|     tchoupin6@de.vu|                  8|      7|        3|     10.99|\n|      7|         Trudey|       Choupin|     tchoupin6@de.vu|                 11|      7|        5|     10.99|\n|      8|         Nadine|     Grimsdell|ngrimsdell7@sohu.com|                  5|      8|        2|      9.99|\n|      8|         Nadine|     Grimsdell|ngrimsdell7@sohu.com|                  9|      8|        5|     10.99|\n|      8|         Nadine|     Grimsdell|ngrimsdell7@sohu.com|                 15|      8|        2|      9.99|\n|      9|        Vassily|         Tamas|vtamas8@businessw...|                  4|      9|        2|      9.99|\n|     10|          Wells|      Simpkins|wsimpkins9@amazon...|                  1|     10|        2|      9.99|\n+-------+---------------+--------------+--------------------+-------------------+-------+---------+----------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641730154443,"submitTime":1641730153400,"finishTime":1641730155383,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"3bf4c6f9-f309-4516-88c0-cbbe76e5142c"},{"version":"CommandV1","origId":1575837098435906,"guid":"60df47a0-bf61-4657-849b-213e2f16028c","subtype":"command","commandType":"auto","position":4.5,"command":"# as both data frames have user id using same name, we can pass column name as string as well\nusers_df. \\\n    join(course_enrolments_df, 'user_id'). \\\n    show()","commandVersion":25,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+-------+---------------+--------------+--------------------+-------------------+---------+----------+\n|user_id|user_first_name|user_last_name|          user_email|course_enrolment_id|course_id|price_paid|\n+-------+---------------+--------------+--------------------+-------------------+---------+----------+\n|      3|         Joanna|      Spennock|jspennock2@redcro...|                 10|        3|     10.99|\n|      3|         Joanna|      Spennock|jspennock2@redcro...|                 12|        2|      9.99|\n|      4|         Hirsch|       Conaboy|hconaboy3@barnesa...|                  7|        5|     10.99|\n|      4|         Hirsch|       Conaboy|hconaboy3@barnesa...|                 14|        3|     10.99|\n|      5|         Loreen|         Malin|lmalin4@independe...|                  2|        2|      9.99|\n|      5|         Loreen|         Malin|lmalin4@independe...|                  6|        5|     10.99|\n|      5|         Loreen|         Malin|lmalin4@independe...|                 13|        2|      9.99|\n|      7|         Trudey|       Choupin|     tchoupin6@de.vu|                  3|        5|     10.99|\n|      7|         Trudey|       Choupin|     tchoupin6@de.vu|                  8|        3|     10.99|\n|      7|         Trudey|       Choupin|     tchoupin6@de.vu|                 11|        5|     10.99|\n|      8|         Nadine|     Grimsdell|ngrimsdell7@sohu.com|                  5|        2|      9.99|\n|      8|         Nadine|     Grimsdell|ngrimsdell7@sohu.com|                  9|        5|     10.99|\n|      8|         Nadine|     Grimsdell|ngrimsdell7@sohu.com|                 15|        2|      9.99|\n|      9|        Vassily|         Tamas|vtamas8@businessw...|                  4|        2|      9.99|\n|     10|          Wells|      Simpkins|wsimpkins9@amazon...|                  1|        2|      9.99|\n+-------+---------------+--------------+--------------------+-------------------+---------+----------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641730155392,"submitTime":1641730153406,"finishTime":1641730155990,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"562c7a90-96bc-4616-9085-b20de7e014fb"},{"version":"CommandV1","origId":1575837098435907,"guid":"b0e97feb-f88c-4c24-848b-5fcc2482ca60","subtype":"command","commandType":"auto","position":5.0,"command":"# Get all columns from users_df and course_id as well as course_enrolment_id from course_enrolments\nusers_df. \\\n    join(course_enrolments_df, users_df.user_id == course_enrolments_df.user_id). \\\n    select(users_df['*'], course_enrolments_df['course_id'], course_enrolments_df['course_enrolment_id']). \\\n    show()","commandVersion":42,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+-------+---------------+--------------+--------------------+---------+-------------------+\n|user_id|user_first_name|user_last_name|          user_email|course_id|course_enrolment_id|\n+-------+---------------+--------------+--------------------+---------+-------------------+\n|      3|         Joanna|      Spennock|jspennock2@redcro...|        3|                 10|\n|      3|         Joanna|      Spennock|jspennock2@redcro...|        2|                 12|\n|      4|         Hirsch|       Conaboy|hconaboy3@barnesa...|        5|                  7|\n|      4|         Hirsch|       Conaboy|hconaboy3@barnesa...|        3|                 14|\n|      5|         Loreen|         Malin|lmalin4@independe...|        2|                  2|\n|      5|         Loreen|         Malin|lmalin4@independe...|        5|                  6|\n|      5|         Loreen|         Malin|lmalin4@independe...|        2|                 13|\n|      7|         Trudey|       Choupin|     tchoupin6@de.vu|        5|                  3|\n|      7|         Trudey|       Choupin|     tchoupin6@de.vu|        3|                  8|\n|      7|         Trudey|       Choupin|     tchoupin6@de.vu|        5|                 11|\n|      8|         Nadine|     Grimsdell|ngrimsdell7@sohu.com|        2|                  5|\n|      8|         Nadine|     Grimsdell|ngrimsdell7@sohu.com|        5|                  9|\n|      8|         Nadine|     Grimsdell|ngrimsdell7@sohu.com|        2|                 15|\n|      9|        Vassily|         Tamas|vtamas8@businessw...|        2|                  4|\n|     10|          Wells|      Simpkins|wsimpkins9@amazon...|        2|                  1|\n+-------+---------------+--------------+--------------------+---------+-------------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641730155997,"submitTime":1641730153411,"finishTime":1641730156613,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"c4d96db9-0121-45c6-8f08-2d747fd2fee1"},{"version":"CommandV1","origId":1575837098435908,"guid":"4700995d-323b-4b83-873d-300400cbcf06","subtype":"command","commandType":"auto","position":6.0,"command":"# using alias\nusers_df.alias('u'). \\\n    join(course_enrolments_df.alias('ce'), users_df.user_id == course_enrolments_df.user_id). \\\n    select('u.*', 'course_id', 'course_enrolment_id'). \\\n    show()","commandVersion":47,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+-------+---------------+--------------+--------------------+---------+-------------------+\n|user_id|user_first_name|user_last_name|          user_email|course_id|course_enrolment_id|\n+-------+---------------+--------------+--------------------+---------+-------------------+\n|      3|         Joanna|      Spennock|jspennock2@redcro...|        3|                 10|\n|      3|         Joanna|      Spennock|jspennock2@redcro...|        2|                 12|\n|      4|         Hirsch|       Conaboy|hconaboy3@barnesa...|        5|                  7|\n|      4|         Hirsch|       Conaboy|hconaboy3@barnesa...|        3|                 14|\n|      5|         Loreen|         Malin|lmalin4@independe...|        2|                  2|\n|      5|         Loreen|         Malin|lmalin4@independe...|        5|                  6|\n|      5|         Loreen|         Malin|lmalin4@independe...|        2|                 13|\n|      7|         Trudey|       Choupin|     tchoupin6@de.vu|        5|                  3|\n|      7|         Trudey|       Choupin|     tchoupin6@de.vu|        3|                  8|\n|      7|         Trudey|       Choupin|     tchoupin6@de.vu|        5|                 11|\n|      8|         Nadine|     Grimsdell|ngrimsdell7@sohu.com|        2|                  5|\n|      8|         Nadine|     Grimsdell|ngrimsdell7@sohu.com|        5|                  9|\n|      8|         Nadine|     Grimsdell|ngrimsdell7@sohu.com|        2|                 15|\n|      9|        Vassily|         Tamas|vtamas8@businessw...|        2|                  4|\n|     10|          Wells|      Simpkins|wsimpkins9@amazon...|        2|                  1|\n+-------+---------------+--------------+--------------------+---------+-------------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641730156622,"submitTime":1641730153416,"finishTime":1641730157238,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"bef8ab8e-b001-4100-9c15-a47e657217b4"},{"version":"CommandV1","origId":1575837098435909,"guid":"066e9ab9-f934-4a45-9d75-0f16480d3bce","subtype":"command","commandType":"auto","position":7.0,"command":"# Get number of courses enroled by each user\n# Fails as user_id is part of both the data frames\nusers_df.alias('u'). \\\n    join(course_enrolments_df.alias('ce'), users_df.user_id == course_enrolments_df.user_id). \\\n    groupBy('user_id'). \\\n    count(). \\\n    show()","commandVersion":27,"state":"error","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":"<span class=\"ansi-red-fg\">AnalysisException</span>: Reference &#39;user_id&#39; is ambiguous, could be: u.user_id, ce.user_id.","errorTraceType":"html","error":"<div class=\"ansiout\"><span class=\"ansi-red-fg\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg\">AnalysisException</span>                         Traceback (most recent call last)\n<span class=\"ansi-green-fg\">&lt;command-3392491687867311&gt;</span> in <span class=\"ansi-cyan-fg\">&lt;module&gt;</span>\n<span class=\"ansi-green-intense-fg ansi-bold\">      1</span> <span class=\"ansi-red-fg\"># Get number of courses enroled by each user</span>\n<span class=\"ansi-green-intense-fg ansi-bold\">      2</span> <span class=\"ansi-red-fg\"># Fails as user_id is part of both the data frames</span>\n<span class=\"ansi-green-fg\">----&gt; 3</span><span class=\"ansi-red-fg\"> </span>users_df<span class=\"ansi-blue-fg\">.</span>alias<span class=\"ansi-blue-fg\">(</span><span class=\"ansi-blue-fg\">&#39;u&#39;</span><span class=\"ansi-blue-fg\">)</span><span class=\"ansi-blue-fg\">.</span><span class=\"ansi-red-fg\"> </span><span class=\"ansi-red-fg\">\\</span>\n<span class=\"ansi-green-intense-fg ansi-bold\">      4</span>     join<span class=\"ansi-blue-fg\">(</span>course_enrolments_df<span class=\"ansi-blue-fg\">.</span>alias<span class=\"ansi-blue-fg\">(</span><span class=\"ansi-blue-fg\">&#39;ce&#39;</span><span class=\"ansi-blue-fg\">)</span><span class=\"ansi-blue-fg\">,</span> users_df<span class=\"ansi-blue-fg\">.</span>user_id <span class=\"ansi-blue-fg\">==</span> course_enrolments_df<span class=\"ansi-blue-fg\">.</span>user_id<span class=\"ansi-blue-fg\">)</span><span class=\"ansi-blue-fg\">.</span><span class=\"ansi-red-fg\"> </span><span class=\"ansi-red-fg\">\\</span>\n<span class=\"ansi-green-intense-fg ansi-bold\">      5</span>     groupBy<span class=\"ansi-blue-fg\">(</span><span class=\"ansi-blue-fg\">&#39;user_id&#39;</span><span class=\"ansi-blue-fg\">)</span><span class=\"ansi-blue-fg\">.</span><span class=\"ansi-red-fg\"> </span><span class=\"ansi-red-fg\">\\</span>\n\n<span class=\"ansi-green-fg\">/databricks/spark/python/pyspark/sql/group.py</span> in <span class=\"ansi-cyan-fg\">_api</span><span class=\"ansi-blue-fg\">(self)</span>\n<span class=\"ansi-green-intense-fg ansi-bold\">     29</span>     <span class=\"ansi-green-fg\">def</span> _api<span class=\"ansi-blue-fg\">(</span>self<span class=\"ansi-blue-fg\">)</span><span class=\"ansi-blue-fg\">:</span>\n<span class=\"ansi-green-intense-fg ansi-bold\">     30</span>         name <span class=\"ansi-blue-fg\">=</span> f<span class=\"ansi-blue-fg\">.</span>__name__\n<span class=\"ansi-green-fg\">---&gt; 31</span><span class=\"ansi-red-fg\">         </span>jdf <span class=\"ansi-blue-fg\">=</span> getattr<span class=\"ansi-blue-fg\">(</span>self<span class=\"ansi-blue-fg\">.</span>_jgd<span class=\"ansi-blue-fg\">,</span> name<span class=\"ansi-blue-fg\">)</span><span class=\"ansi-blue-fg\">(</span><span class=\"ansi-blue-fg\">)</span>\n<span class=\"ansi-green-intense-fg ansi-bold\">     32</span>         <span class=\"ansi-green-fg\">return</span> DataFrame<span class=\"ansi-blue-fg\">(</span>jdf<span class=\"ansi-blue-fg\">,</span> self<span class=\"ansi-blue-fg\">.</span>sql_ctx<span class=\"ansi-blue-fg\">)</span>\n<span class=\"ansi-green-intense-fg ansi-bold\">     33</span>     _api<span class=\"ansi-blue-fg\">.</span>__name__ <span class=\"ansi-blue-fg\">=</span> f<span class=\"ansi-blue-fg\">.</span>__name__\n\n<span class=\"ansi-green-fg\">/databricks/spark/python/lib/py4j-0.10.9-src.zip/py4j/java_gateway.py</span> in <span class=\"ansi-cyan-fg\">__call__</span><span class=\"ansi-blue-fg\">(self, *args)</span>\n<span class=\"ansi-green-intense-fg ansi-bold\">   1302</span> \n<span class=\"ansi-green-intense-fg ansi-bold\">   1303</span>         answer <span class=\"ansi-blue-fg\">=</span> self<span class=\"ansi-blue-fg\">.</span>gateway_client<span class=\"ansi-blue-fg\">.</span>send_command<span class=\"ansi-blue-fg\">(</span>command<span class=\"ansi-blue-fg\">)</span>\n<span class=\"ansi-green-fg\">-&gt; 1304</span><span class=\"ansi-red-fg\">         return_value = get_return_value(\n</span><span class=\"ansi-green-intense-fg ansi-bold\">   1305</span>             answer, self.gateway_client, self.target_id, self.name)\n<span class=\"ansi-green-intense-fg ansi-bold\">   1306</span> \n\n<span class=\"ansi-green-fg\">/databricks/spark/python/pyspark/sql/utils.py</span> in <span class=\"ansi-cyan-fg\">deco</span><span class=\"ansi-blue-fg\">(*a, **kw)</span>\n<span class=\"ansi-green-intense-fg ansi-bold\">    121</span>                 <span class=\"ansi-red-fg\"># Hide where the exception came from that shows a non-Pythonic</span>\n<span class=\"ansi-green-intense-fg ansi-bold\">    122</span>                 <span class=\"ansi-red-fg\"># JVM exception message.</span>\n<span class=\"ansi-green-fg\">--&gt; 123</span><span class=\"ansi-red-fg\">                 </span><span class=\"ansi-green-fg\">raise</span> converted <span class=\"ansi-green-fg\">from</span> <span class=\"ansi-green-fg\">None</span>\n<span class=\"ansi-green-intense-fg ansi-bold\">    124</span>             <span class=\"ansi-green-fg\">else</span><span class=\"ansi-blue-fg\">:</span>\n<span class=\"ansi-green-intense-fg ansi-bold\">    125</span>                 <span class=\"ansi-green-fg\">raise</span>\n\n<span class=\"ansi-red-fg\">AnalysisException</span>: Reference &#39;user_id&#39; is ambiguous, could be: u.user_id, ce.user_id.</div>","workflows":[],"startTime":1641730153421,"submitTime":1641730153421,"finishTime":1641730157614,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"bf96596b-cab3-4480-b15b-d76031c4c538"},{"version":"CommandV1","origId":1575837098435910,"guid":"cd5b936a-8714-4db8-b734-f8822a758d41","subtype":"command","commandType":"auto","position":8.0,"command":"# Succeeds as we are picking up user_id from users_df\nusers_df. \\\n    join(course_enrolments_df, users_df.user_id == course_enrolments_df.user_id). \\\n    groupBy(users_df['user_id']). \\\n    count(). \\\n    show()","commandVersion":18,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+-------+-----+\n|user_id|count|\n+-------+-----+\n|      3|    2|\n|      4|    2|\n|      5|    3|\n|      7|    3|\n|      8|    3|\n|      9|    1|\n|     10|    1|\n+-------+-----+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641730164359,"submitTime":1641730164322,"finishTime":1641730165193,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"e07df260-6db9-421a-b7b3-714e80f538b8"},{"version":"CommandV1","origId":1575837098435911,"guid":"916feea5-b598-4583-9b91-76617290b396","subtype":"command","commandType":"auto","position":9.0,"command":"# Using alias\nusers_df.alias('u'). \\\n    join(course_enrolments_df.alias('ce'), users_df.user_id == course_enrolments_df.user_id). \\\n    groupBy('u.user_id'). \\\n    count(). \\\n    show()","commandVersion":8,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+-------+-----+\n|user_id|count|\n+-------+-----+\n|      3|    2|\n|      4|    2|\n|      5|    3|\n|      7|    3|\n|      8|    3|\n|      9|    1|\n|     10|    1|\n+-------+-----+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641730169065,"submitTime":1641730169032,"finishTime":1641730169667,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"c07c7956-7afa-4650-baf9-cfbd111dffb6"},{"version":"CommandV1","origId":1575837098435912,"guid":"39548a23-99d4-42f9-a7b6-132420de9b4d","subtype":"command","commandType":"auto","position":10.0,"command":"users_df. \\\n    join(course_enrolments_df, 'user_id'). \\\n    groupBy('user_id'). \\\n    count(). \\\n    show()","commandVersion":10,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+-------+-----+\n|user_id|count|\n+-------+-----+\n|      3|    2|\n|      4|    2|\n|      5|    3|\n|      7|    3|\n|      8|    3|\n|      9|    1|\n|     10|    1|\n+-------+-----+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641731765639,"submitTime":1641731765609,"finishTime":1641731766320,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"54815fcc-7577-47b6-8de0-242874326c8d"},{"version":"CommandV1","origId":1575837098435913,"guid":"f4c2ebba-59e6-431c-919a-a3917186b33c","subtype":"command","commandType":"auto","position":11.0,"command":"","commandVersion":0,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"16ee1892-edfd-47a7-b5ee-748cb0aa1196"}],"dashboards":[],"guid":"0739f17e-bd76-4324-ad35-0c49996ab025","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{"pythonIndentUnit":4}}