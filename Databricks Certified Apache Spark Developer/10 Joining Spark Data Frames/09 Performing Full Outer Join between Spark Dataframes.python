{"version":"NotebookV1","origId":1575837098435877,"name":"09 Performing Full Outer Join between Spark Dataframes","language":"python","commands":[{"version":"CommandV1","origId":1575837098435878,"guid":"240810f9-2975-4d5c-bc91-fd25afc0105c","subtype":"command","commandType":"auto","position":0.25,"command":"users1 = [\n    {\n        \"email\":\"alovett0@nsw.gov.au\",\n        \"first_name\":\"Aundrea\",\n        \"last_name\":\"Lovett\",\n        \"gender\":\"Male\",\n        \"ip_address\":\"62.72.1.143\"\n    },\n    {\n        \"email\":\"bjowling1@spiegel.de\",\n        \"first_name\":\"Bettine\",\n        \"last_name\":\"Jowling\",\n        \"gender\":\"Female\",\n        \"ip_address\":\"26.250.197.47\"\n    },\n    {\n        \"email\":\"rablitt2@technorati.com\",\n        \"first_name\":\"Reggie\",\n        \"last_name\":\"Ablitt\",\n        \"gender\":\"Male\",\n        \"ip_address\":\"104.181.218.238\"\n    },\n    {\n        \"email\":\"tgavahan3@printfriendly.com\",\n        \"first_name\":\"Ted\",\n        \"last_name\":\"Gavahan\",\n        \"gender\":\"Female\",\n        \"ip_address\":\"216.80.86.100\"\n    },\n    {\n        \"email\":\"ccastellan4@bloglovin.com\",\n        \"first_name\":\"Chantal\",\n        \"last_name\":\"Castellan\",\n        \"gender\":\"Female\",\n        \"ip_address\":\"178.93.82.145\"\n    },\n    {\n        \"email\":\"hcurrier5@hexun.com\",\n        \"first_name\":\"Herrick\",\n        \"last_name\":\"Currier\",\n        \"gender\":\"Male\",\n        \"ip_address\":\"98.120.5.78\"\n    },\n    {\n        \"email\":\"zlendrem6@columbia.edu\",\n        \"first_name\":\"Zorina\",\n        \"last_name\":\"Lendrem\",\n        \"gender\":\"Female\",\n        \"ip_address\":\"219.128.213.53\"\n    },\n    {\n        \"email\":\"lbutland7@time.com\",\n        \"first_name\":\"Lilas\",\n        \"last_name\":\"Butland\",\n        \"gender\":\"Female\",\n        \"ip_address\":\"109.110.131.151\"\n    },\n    {\n        \"email\":\"palfonsetti8@ask.com\",\n        \"first_name\":\"Putnam\",\n        \"last_name\":\"Alfonsetti\",\n        \"gender\":\"Female\",\n        \"ip_address\":\"167.97.48.246\"\n    },\n    {\n        \"email\":\"hunitt9@bizjournals.com\",\n        \"first_name\":\"Holden\",\n        \"last_name\":\"Unitt\",\n        \"gender\":\"Female\",\n        \"ip_address\":\"142.228.161.192\"\n    },\n    {\n        \"email\":\"dmcmorrana@reference.com\",\n        \"first_name\":\"Dorice\",\n        \"last_name\":\"McMorran\",\n        \"gender\":\"Female\",\n        \"ip_address\":\"233.1.28.220\"\n    },\n    {\n        \"email\":\"afaulconerb@barnesandnoble.com\",\n        \"first_name\":\"Andris\",\n        \"last_name\":\"Faulconer\",\n        \"gender\":\"Female\",\n        \"ip_address\":\"109.40.175.103\"\n    },\n    {\n        \"email\":\"kupexc@sun.com\",\n        \"first_name\":\"Krispin\",\n        \"last_name\":\"Upex\",\n        \"gender\":\"Male\",\n        \"ip_address\":\"154.110.22.75\"\n    },\n    {\n        \"email\":\"fmancktelowd@youku.com\",\n        \"first_name\":\"Farand\",\n        \"last_name\":\"Mancktelow\",\n        \"gender\":\"Genderqueer\",\n        \"ip_address\":\"190.20.187.10\"\n    },\n    {\n        \"email\":\"kdodgshune@google.com\",\n        \"first_name\":\"Kellyann\",\n        \"last_name\":\"Dodgshun\",\n        \"gender\":\"Female\",\n        \"ip_address\":\"80.247.105.228\"\n    }\n]\n\nfrom pyspark.sql import Row\nusers1_df = spark.createDataFrame([Row(**user) for user in users1])","commandVersion":37,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"users1_df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"email","nullable":true,"type":"string"},{"metadata":{},"name":"first_name","nullable":true,"type":"string"},{"metadata":{},"name":"last_name","nullable":true,"type":"string"},{"metadata":{},"name":"gender","nullable":true,"type":"string"},{"metadata":{},"name":"ip_address","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641742543170,"submitTime":1641742542435,"finishTime":1641742543248,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"b37d4a60-18f0-4b78-a58a-52a2428351b0"},{"version":"CommandV1","origId":1575837098435879,"guid":"ecae5617-88c1-4502-923b-1cdecf40de96","subtype":"command","commandType":"auto","position":1.25,"command":"users2 = [{\n        \"email\":\"lbutland7@time.com\",\n        \"first_name\":\"Lilas\",\n        \"last_name\":\"Butland\",\n        \"gender\":\"Female\",\n        \"ip_address\":\"109.110.131.151\"\n    },\n    {\n        \"email\":\"palfonsetti8@ask.com\",\n        \"first_name\":\"Putnam\",\n        \"last_name\":\"Alfonsetti\",\n        \"gender\":\"Female\",\n        \"ip_address\":\"167.97.48.246\"\n    },\n    {\n        \"email\":\"hunitt9@bizjournals.com\",\n        \"first_name\":\"Holden\",\n        \"last_name\":\"Unitt\",\n        \"gender\":\"Female\",\n        \"ip_address\":\"142.228.161.192\"\n    },\n    {\n        \"email\":\"dmcmorrana@reference.com\",\n        \"first_name\":\"Dorice\",\n        \"last_name\":\"McMorran\",\n        \"gender\":\"Female\",\n        \"ip_address\":\"233.1.28.220\"\n    },\n    {\n        \"email\":\"afaulconerb@barnesandnoble.com\",\n        \"first_name\":\"Andris\",\n        \"last_name\":\"Faulconer\",\n        \"gender\":\"Female\",\n        \"ip_address\":\"109.40.175.103\"\n    },\n    {\n        \"email\":\"kupexc@sun.com\",\n        \"first_name\":\"Krispin\",\n        \"last_name\":\"Upex\",\n        \"gender\":\"Male\",\n        \"ip_address\":\"154.110.22.75\"\n    },\n    {\n        \"email\":\"fmancktelowd@youku.com\",\n        \"first_name\":\"Farand\",\n        \"last_name\":\"Mancktelow\",\n        \"gender\":\"Genderqueer\",\n        \"ip_address\":\"190.20.187.10\"\n    },\n    {\n        \"email\":\"kdodgshune@google.com\",\n        \"first_name\":\"Kellyann\",\n        \"last_name\":\"Dodgshun\",\n        \"gender\":\"Female\",\n        \"ip_address\":\"80.247.105.228\"\n    },\n    {\n        \"email\":\"kbaressf@geocities.jp\",\n        \"first_name\":\"Karly\",\n        \"last_name\":\"Baress\",\n        \"gender\":\"Female\",\n        \"ip_address\":\"145.232.153.145\"\n    },\n    {\n        \"email\":\"amillinsg@com.com\",\n        \"first_name\":\"Adelaide\",\n        \"last_name\":\"Millins\",\n        \"gender\":\"Female\",\n        \"ip_address\":\"75.160.220.182\"\n    },\n    {\n        \"email\":\"skemsleyh@quantcast.com\",\n        \"first_name\":\"Shir\",\n        \"last_name\":\"Kemsley\",\n        \"gender\":\"Male\",\n        \"ip_address\":\"234.195.73.177\"\n    },\n    {\n        \"email\":\"kchomiszewskii@simplemachines.org\",\n        \"first_name\":\"Kristo\",\n        \"last_name\":\"Chomiszewski\",\n        \"gender\":\"Female\",\n        \"ip_address\":\"60.91.73.198\"\n    },\n    {\n        \"email\":\"rkelwickj@baidu.com\",\n        \"first_name\":\"Rosemonde\",\n        \"last_name\":\"Kelwick\",\n        \"gender\":\"Genderfluid\",\n        \"ip_address\":\"42.50.134.65\"\n    }\n]\n\nfrom pyspark.sql import Row\nusers2_df = spark.createDataFrame([Row(**user) for user in users2])","commandVersion":10,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"users2_df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"email","nullable":true,"type":"string"},{"metadata":{},"name":"first_name","nullable":true,"type":"string"},{"metadata":{},"name":"last_name","nullable":true,"type":"string"},{"metadata":{},"name":"gender","nullable":true,"type":"string"},{"metadata":{},"name":"ip_address","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641742543256,"submitTime":1641742542484,"finishTime":1641742543320,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"5e50cd0a-3e35-4ba1-b881-67613e173dac"},{"version":"CommandV1","origId":1575837098435880,"guid":"3837bcb4-b3f6-4a38-857e-f70ab7f0acde","subtype":"command","commandType":"auto","position":2.25,"command":"users1_df.count()","commandVersion":3,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Out[4]: 15</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641742543325,"submitTime":1641742542528,"finishTime":1641742544027,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"327086d2-a2ae-4e2b-bd11-5b44ecb12752"},{"version":"CommandV1","origId":1575837098435881,"guid":"37399db2-5908-4566-a3b5-a15823614732","subtype":"command","commandType":"auto","position":3.25,"command":"users2_df.count()","commandVersion":2,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Out[5]: 13</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641742544035,"submitTime":1641742542564,"finishTime":1641742544408,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"d1dccdf3-b104-4c39-93aa-a71db61dd193"},{"version":"CommandV1","origId":1575837098435882,"guid":"740c3fd5-ddb5-4834-9f18-54a8feca07fa","subtype":"command","commandType":"auto","position":4.25,"command":"# outer or full or fullouter or full_outer are same\n\nusers1_df. \\\n    join(users2_df, users1_df.email == users2_df.email, 'full'). \\\n    show()","commandVersion":34,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+--------------------+----------+----------+-----------+---------------+--------------------+----------+------------+-----------+---------------+\n|               email|first_name| last_name|     gender|     ip_address|               email|first_name|   last_name|     gender|     ip_address|\n+--------------------+----------+----------+-----------+---------------+--------------------+----------+------------+-----------+---------------+\n|afaulconerb@barne...|    Andris| Faulconer|     Female| 109.40.175.103|afaulconerb@barne...|    Andris|   Faulconer|     Female| 109.40.175.103|\n| alovett0@nsw.gov.au|   Aundrea|    Lovett|       Male|    62.72.1.143|                null|      null|        null|       null|           null|\n|                null|      null|      null|       null|           null|   amillinsg@com.com|  Adelaide|     Millins|     Female| 75.160.220.182|\n|bjowling1@spiegel.de|   Bettine|   Jowling|     Female|  26.250.197.47|                null|      null|        null|       null|           null|\n|ccastellan4@blogl...|   Chantal| Castellan|     Female|  178.93.82.145|                null|      null|        null|       null|           null|\n|dmcmorrana@refere...|    Dorice|  McMorran|     Female|   233.1.28.220|dmcmorrana@refere...|    Dorice|    McMorran|     Female|   233.1.28.220|\n|fmancktelowd@youk...|    Farand|Mancktelow|Genderqueer|  190.20.187.10|fmancktelowd@youk...|    Farand|  Mancktelow|Genderqueer|  190.20.187.10|\n| hcurrier5@hexun.com|   Herrick|   Currier|       Male|    98.120.5.78|                null|      null|        null|       null|           null|\n|hunitt9@bizjourna...|    Holden|     Unitt|     Female|142.228.161.192|hunitt9@bizjourna...|    Holden|       Unitt|     Female|142.228.161.192|\n|                null|      null|      null|       null|           null|kbaressf@geocitie...|     Karly|      Baress|     Female|145.232.153.145|\n|                null|      null|      null|       null|           null|kchomiszewskii@si...|    Kristo|Chomiszewski|     Female|   60.91.73.198|\n|kdodgshune@google...|  Kellyann|  Dodgshun|     Female| 80.247.105.228|kdodgshune@google...|  Kellyann|    Dodgshun|     Female| 80.247.105.228|\n|      kupexc@sun.com|   Krispin|      Upex|       Male|  154.110.22.75|      kupexc@sun.com|   Krispin|        Upex|       Male|  154.110.22.75|\n|  lbutland7@time.com|     Lilas|   Butland|     Female|109.110.131.151|  lbutland7@time.com|     Lilas|     Butland|     Female|109.110.131.151|\n|palfonsetti8@ask.com|    Putnam|Alfonsetti|     Female|  167.97.48.246|palfonsetti8@ask.com|    Putnam|  Alfonsetti|     Female|  167.97.48.246|\n|rablitt2@technora...|    Reggie|    Ablitt|       Male|104.181.218.238|                null|      null|        null|       null|           null|\n|                null|      null|      null|       null|           null| rkelwickj@baidu.com| Rosemonde|     Kelwick|Genderfluid|   42.50.134.65|\n|                null|      null|      null|       null|           null|skemsleyh@quantca...|      Shir|     Kemsley|       Male| 234.195.73.177|\n|tgavahan3@printfr...|       Ted|   Gavahan|     Female|  216.80.86.100|                null|      null|        null|       null|           null|\n|zlendrem6@columbi...|    Zorina|   Lendrem|     Female| 219.128.213.53|                null|      null|        null|       null|           null|\n+--------------------+----------+----------+-----------+---------------+--------------------+----------+------------+-----------+---------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641742544415,"submitTime":1641742542600,"finishTime":1641742546649,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"17f7f29d-6f63-45bc-b7dd-73f7eb264f33"},{"version":"CommandV1","origId":1575837098435883,"guid":"6a720743-59d5-42b2-9897-9550703ef757","subtype":"command","commandType":"auto","position":5.25,"command":"users1_df. \\\n    join(users2_df, users1_df.email == users2_df.email, 'fullouter'). \\\n    show()","commandVersion":4,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+--------------------+----------+----------+-----------+---------------+--------------------+----------+------------+-----------+---------------+\n|               email|first_name| last_name|     gender|     ip_address|               email|first_name|   last_name|     gender|     ip_address|\n+--------------------+----------+----------+-----------+---------------+--------------------+----------+------------+-----------+---------------+\n|afaulconerb@barne...|    Andris| Faulconer|     Female| 109.40.175.103|afaulconerb@barne...|    Andris|   Faulconer|     Female| 109.40.175.103|\n| alovett0@nsw.gov.au|   Aundrea|    Lovett|       Male|    62.72.1.143|                null|      null|        null|       null|           null|\n|                null|      null|      null|       null|           null|   amillinsg@com.com|  Adelaide|     Millins|     Female| 75.160.220.182|\n|bjowling1@spiegel.de|   Bettine|   Jowling|     Female|  26.250.197.47|                null|      null|        null|       null|           null|\n|ccastellan4@blogl...|   Chantal| Castellan|     Female|  178.93.82.145|                null|      null|        null|       null|           null|\n|dmcmorrana@refere...|    Dorice|  McMorran|     Female|   233.1.28.220|dmcmorrana@refere...|    Dorice|    McMorran|     Female|   233.1.28.220|\n|fmancktelowd@youk...|    Farand|Mancktelow|Genderqueer|  190.20.187.10|fmancktelowd@youk...|    Farand|  Mancktelow|Genderqueer|  190.20.187.10|\n| hcurrier5@hexun.com|   Herrick|   Currier|       Male|    98.120.5.78|                null|      null|        null|       null|           null|\n|hunitt9@bizjourna...|    Holden|     Unitt|     Female|142.228.161.192|hunitt9@bizjourna...|    Holden|       Unitt|     Female|142.228.161.192|\n|                null|      null|      null|       null|           null|kbaressf@geocitie...|     Karly|      Baress|     Female|145.232.153.145|\n|                null|      null|      null|       null|           null|kchomiszewskii@si...|    Kristo|Chomiszewski|     Female|   60.91.73.198|\n|kdodgshune@google...|  Kellyann|  Dodgshun|     Female| 80.247.105.228|kdodgshune@google...|  Kellyann|    Dodgshun|     Female| 80.247.105.228|\n|      kupexc@sun.com|   Krispin|      Upex|       Male|  154.110.22.75|      kupexc@sun.com|   Krispin|        Upex|       Male|  154.110.22.75|\n|  lbutland7@time.com|     Lilas|   Butland|     Female|109.110.131.151|  lbutland7@time.com|     Lilas|     Butland|     Female|109.110.131.151|\n|palfonsetti8@ask.com|    Putnam|Alfonsetti|     Female|  167.97.48.246|palfonsetti8@ask.com|    Putnam|  Alfonsetti|     Female|  167.97.48.246|\n|rablitt2@technora...|    Reggie|    Ablitt|       Male|104.181.218.238|                null|      null|        null|       null|           null|\n|                null|      null|      null|       null|           null| rkelwickj@baidu.com| Rosemonde|     Kelwick|Genderfluid|   42.50.134.65|\n|                null|      null|      null|       null|           null|skemsleyh@quantca...|      Shir|     Kemsley|       Male| 234.195.73.177|\n|tgavahan3@printfr...|       Ted|   Gavahan|     Female|  216.80.86.100|                null|      null|        null|       null|           null|\n|zlendrem6@columbi...|    Zorina|   Lendrem|     Female| 219.128.213.53|                null|      null|        null|       null|           null|\n+--------------------+----------+----------+-----------+---------------+--------------------+----------+------------+-----------+---------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641743105619,"submitTime":1641743105566,"finishTime":1641743106235,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"f5d739fa-6b8f-4b64-9a0f-e0eb1e220dbd"},{"version":"CommandV1","origId":1575837098435884,"guid":"9dc3a050-3653-4828-8e3a-3c6617968131","subtype":"command","commandType":"auto","position":6.25,"command":"users1_df. \\\n    join(users2_df, users1_df.email == users2_df.email, 'full_outer'). \\\n    show()","commandVersion":2,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+--------------------+----------+----------+-----------+---------------+--------------------+----------+------------+-----------+---------------+\n|               email|first_name| last_name|     gender|     ip_address|               email|first_name|   last_name|     gender|     ip_address|\n+--------------------+----------+----------+-----------+---------------+--------------------+----------+------------+-----------+---------------+\n|afaulconerb@barne...|    Andris| Faulconer|     Female| 109.40.175.103|afaulconerb@barne...|    Andris|   Faulconer|     Female| 109.40.175.103|\n| alovett0@nsw.gov.au|   Aundrea|    Lovett|       Male|    62.72.1.143|                null|      null|        null|       null|           null|\n|                null|      null|      null|       null|           null|   amillinsg@com.com|  Adelaide|     Millins|     Female| 75.160.220.182|\n|bjowling1@spiegel.de|   Bettine|   Jowling|     Female|  26.250.197.47|                null|      null|        null|       null|           null|\n|ccastellan4@blogl...|   Chantal| Castellan|     Female|  178.93.82.145|                null|      null|        null|       null|           null|\n|dmcmorrana@refere...|    Dorice|  McMorran|     Female|   233.1.28.220|dmcmorrana@refere...|    Dorice|    McMorran|     Female|   233.1.28.220|\n|fmancktelowd@youk...|    Farand|Mancktelow|Genderqueer|  190.20.187.10|fmancktelowd@youk...|    Farand|  Mancktelow|Genderqueer|  190.20.187.10|\n| hcurrier5@hexun.com|   Herrick|   Currier|       Male|    98.120.5.78|                null|      null|        null|       null|           null|\n|hunitt9@bizjourna...|    Holden|     Unitt|     Female|142.228.161.192|hunitt9@bizjourna...|    Holden|       Unitt|     Female|142.228.161.192|\n|                null|      null|      null|       null|           null|kbaressf@geocitie...|     Karly|      Baress|     Female|145.232.153.145|\n|                null|      null|      null|       null|           null|kchomiszewskii@si...|    Kristo|Chomiszewski|     Female|   60.91.73.198|\n|kdodgshune@google...|  Kellyann|  Dodgshun|     Female| 80.247.105.228|kdodgshune@google...|  Kellyann|    Dodgshun|     Female| 80.247.105.228|\n|      kupexc@sun.com|   Krispin|      Upex|       Male|  154.110.22.75|      kupexc@sun.com|   Krispin|        Upex|       Male|  154.110.22.75|\n|  lbutland7@time.com|     Lilas|   Butland|     Female|109.110.131.151|  lbutland7@time.com|     Lilas|     Butland|     Female|109.110.131.151|\n|palfonsetti8@ask.com|    Putnam|Alfonsetti|     Female|  167.97.48.246|palfonsetti8@ask.com|    Putnam|  Alfonsetti|     Female|  167.97.48.246|\n|rablitt2@technora...|    Reggie|    Ablitt|       Male|104.181.218.238|                null|      null|        null|       null|           null|\n|                null|      null|      null|       null|           null| rkelwickj@baidu.com| Rosemonde|     Kelwick|Genderfluid|   42.50.134.65|\n|                null|      null|      null|       null|           null|skemsleyh@quantca...|      Shir|     Kemsley|       Male| 234.195.73.177|\n|tgavahan3@printfr...|       Ted|   Gavahan|     Female|  216.80.86.100|                null|      null|        null|       null|           null|\n|zlendrem6@columbi...|    Zorina|   Lendrem|     Female| 219.128.213.53|                null|      null|        null|       null|           null|\n+--------------------+----------+----------+-----------+---------------+--------------------+----------+------------+-----------+---------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641742547145,"submitTime":1641742542680,"finishTime":1641742547587,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"be38c392-3776-41d1-b1a5-6794b9aa5986"},{"version":"CommandV1","origId":1575837098435885,"guid":"f8d58cb1-6730-4786-bdcf-778cfa83d1a4","subtype":"command","commandType":"auto","position":6.75,"command":"users1_df. \\\n    join(users2_df, 'email', 'full_outer'). \\\n    show()","commandVersion":4,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+--------------------+----------+----------+-----------+---------------+----------+------------+-----------+---------------+\n|               email|first_name| last_name|     gender|     ip_address|first_name|   last_name|     gender|     ip_address|\n+--------------------+----------+----------+-----------+---------------+----------+------------+-----------+---------------+\n|afaulconerb@barne...|    Andris| Faulconer|     Female| 109.40.175.103|    Andris|   Faulconer|     Female| 109.40.175.103|\n| alovett0@nsw.gov.au|   Aundrea|    Lovett|       Male|    62.72.1.143|      null|        null|       null|           null|\n|   amillinsg@com.com|      null|      null|       null|           null|  Adelaide|     Millins|     Female| 75.160.220.182|\n|bjowling1@spiegel.de|   Bettine|   Jowling|     Female|  26.250.197.47|      null|        null|       null|           null|\n|ccastellan4@blogl...|   Chantal| Castellan|     Female|  178.93.82.145|      null|        null|       null|           null|\n|dmcmorrana@refere...|    Dorice|  McMorran|     Female|   233.1.28.220|    Dorice|    McMorran|     Female|   233.1.28.220|\n|fmancktelowd@youk...|    Farand|Mancktelow|Genderqueer|  190.20.187.10|    Farand|  Mancktelow|Genderqueer|  190.20.187.10|\n| hcurrier5@hexun.com|   Herrick|   Currier|       Male|    98.120.5.78|      null|        null|       null|           null|\n|hunitt9@bizjourna...|    Holden|     Unitt|     Female|142.228.161.192|    Holden|       Unitt|     Female|142.228.161.192|\n|kbaressf@geocitie...|      null|      null|       null|           null|     Karly|      Baress|     Female|145.232.153.145|\n|kchomiszewskii@si...|      null|      null|       null|           null|    Kristo|Chomiszewski|     Female|   60.91.73.198|\n|kdodgshune@google...|  Kellyann|  Dodgshun|     Female| 80.247.105.228|  Kellyann|    Dodgshun|     Female| 80.247.105.228|\n|      kupexc@sun.com|   Krispin|      Upex|       Male|  154.110.22.75|   Krispin|        Upex|       Male|  154.110.22.75|\n|  lbutland7@time.com|     Lilas|   Butland|     Female|109.110.131.151|     Lilas|     Butland|     Female|109.110.131.151|\n|palfonsetti8@ask.com|    Putnam|Alfonsetti|     Female|  167.97.48.246|    Putnam|  Alfonsetti|     Female|  167.97.48.246|\n|rablitt2@technora...|    Reggie|    Ablitt|       Male|104.181.218.238|      null|        null|       null|           null|\n| rkelwickj@baidu.com|      null|      null|       null|           null| Rosemonde|     Kelwick|Genderfluid|   42.50.134.65|\n|skemsleyh@quantca...|      null|      null|       null|           null|      Shir|     Kemsley|       Male| 234.195.73.177|\n|tgavahan3@printfr...|       Ted|   Gavahan|     Female|  216.80.86.100|      null|        null|       null|           null|\n|zlendrem6@columbi...|    Zorina|   Lendrem|     Female| 219.128.213.53|      null|        null|       null|           null|\n+--------------------+----------+----------+-----------+---------------+----------+------------+-----------+---------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641742547594,"submitTime":1641742542725,"finishTime":1641742548103,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"d70be9f0-209d-4079-8314-10501cdf7a9f"},{"version":"CommandV1","origId":1575837098435886,"guid":"3db660e1-f470-4564-b134-865ac36a203a","subtype":"command","commandType":"auto","position":6.875,"command":"users1_df. \\\n    join(users2_df, 'email', 'full_outer'). \\\n    count()","commandVersion":2,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Out[10]: 20</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641742548113,"submitTime":1641742542771,"finishTime":1641742549236,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"a589cb70-b445-403f-97d7-0c916700420b"},{"version":"CommandV1","origId":1575837098435887,"guid":"75657939-a407-4302-a608-d7edbcecd0fe","subtype":"command","commandType":"auto","position":7.0,"command":"users1_df. \\\n    join(users2_df, 'email', 'left'). \\\n    union(\n        users1_df. \\\n            join(users2_df, 'email', 'right')\n    ). \\\n    show()","commandVersion":25,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+--------------------+----------+----------+-----------+---------------+----------+----------+-----------+---------------+\n|               email|first_name| last_name|     gender|     ip_address|first_name| last_name|     gender|     ip_address|\n+--------------------+----------+----------+-----------+---------------+----------+----------+-----------+---------------+\n|afaulconerb@barne...|    Andris| Faulconer|     Female| 109.40.175.103|    Andris| Faulconer|     Female| 109.40.175.103|\n| alovett0@nsw.gov.au|   Aundrea|    Lovett|       Male|    62.72.1.143|      null|      null|       null|           null|\n|bjowling1@spiegel.de|   Bettine|   Jowling|     Female|  26.250.197.47|      null|      null|       null|           null|\n|ccastellan4@blogl...|   Chantal| Castellan|     Female|  178.93.82.145|      null|      null|       null|           null|\n|dmcmorrana@refere...|    Dorice|  McMorran|     Female|   233.1.28.220|    Dorice|  McMorran|     Female|   233.1.28.220|\n|fmancktelowd@youk...|    Farand|Mancktelow|Genderqueer|  190.20.187.10|    Farand|Mancktelow|Genderqueer|  190.20.187.10|\n| hcurrier5@hexun.com|   Herrick|   Currier|       Male|    98.120.5.78|      null|      null|       null|           null|\n|hunitt9@bizjourna...|    Holden|     Unitt|     Female|142.228.161.192|    Holden|     Unitt|     Female|142.228.161.192|\n|kdodgshune@google...|  Kellyann|  Dodgshun|     Female| 80.247.105.228|  Kellyann|  Dodgshun|     Female| 80.247.105.228|\n|      kupexc@sun.com|   Krispin|      Upex|       Male|  154.110.22.75|   Krispin|      Upex|       Male|  154.110.22.75|\n|  lbutland7@time.com|     Lilas|   Butland|     Female|109.110.131.151|     Lilas|   Butland|     Female|109.110.131.151|\n|palfonsetti8@ask.com|    Putnam|Alfonsetti|     Female|  167.97.48.246|    Putnam|Alfonsetti|     Female|  167.97.48.246|\n|rablitt2@technora...|    Reggie|    Ablitt|       Male|104.181.218.238|      null|      null|       null|           null|\n|tgavahan3@printfr...|       Ted|   Gavahan|     Female|  216.80.86.100|      null|      null|       null|           null|\n|zlendrem6@columbi...|    Zorina|   Lendrem|     Female| 219.128.213.53|      null|      null|       null|           null|\n|afaulconerb@barne...|    Andris| Faulconer|     Female| 109.40.175.103|    Andris| Faulconer|     Female| 109.40.175.103|\n|   amillinsg@com.com|      null|      null|       null|           null|  Adelaide|   Millins|     Female| 75.160.220.182|\n|dmcmorrana@refere...|    Dorice|  McMorran|     Female|   233.1.28.220|    Dorice|  McMorran|     Female|   233.1.28.220|\n|fmancktelowd@youk...|    Farand|Mancktelow|Genderqueer|  190.20.187.10|    Farand|Mancktelow|Genderqueer|  190.20.187.10|\n|hunitt9@bizjourna...|    Holden|     Unitt|     Female|142.228.161.192|    Holden|     Unitt|     Female|142.228.161.192|\n+--------------------+----------+----------+-----------+---------------+----------+----------+-----------+---------------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641742549243,"submitTime":1641742542807,"finishTime":1641742550676,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"565da7ba-2ddc-448c-a272-05175c3a3e92"},{"version":"CommandV1","origId":1575837098435888,"guid":"a838dbe8-7eaf-447b-8fb3-23a411ffd0b0","subtype":"command","commandType":"auto","position":7.125,"command":"users1_df. \\\n    join(users2_df, 'email', 'left'). \\\n    union(\n        users1_df. \\\n            join(users2_df, 'email', 'right')\n    ). \\\n    count()","commandVersion":3,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Out[12]: 28</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641742550694,"submitTime":1641742542859,"finishTime":1641742552226,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"d76aa1d2-e57a-43ad-a099-704e4d756d37"},{"version":"CommandV1","origId":1575837098435889,"guid":"2b43fb37-b79f-4a85-9e3a-1d8af89064e6","subtype":"command","commandType":"auto","position":7.1875,"command":"users1_df. \\\n    join(users2_df, 'email', 'left'). \\\n    union(\n        users1_df. \\\n            join(users2_df, 'email', 'right')\n    ). \\\n    distinct(). \\\n    show()","commandVersion":6,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+--------------------+----------+----------+-----------+---------------+----------+------------+-----------+---------------+\n|               email|first_name| last_name|     gender|     ip_address|first_name|   last_name|     gender|     ip_address|\n+--------------------+----------+----------+-----------+---------------+----------+------------+-----------+---------------+\n|kdodgshune@google...|  Kellyann|  Dodgshun|     Female| 80.247.105.228|  Kellyann|    Dodgshun|     Female| 80.247.105.228|\n|hunitt9@bizjourna...|    Holden|     Unitt|     Female|142.228.161.192|    Holden|       Unitt|     Female|142.228.161.192|\n|fmancktelowd@youk...|    Farand|Mancktelow|Genderqueer|  190.20.187.10|    Farand|  Mancktelow|Genderqueer|  190.20.187.10|\n|bjowling1@spiegel.de|   Bettine|   Jowling|     Female|  26.250.197.47|      null|        null|       null|           null|\n|palfonsetti8@ask.com|    Putnam|Alfonsetti|     Female|  167.97.48.246|    Putnam|  Alfonsetti|     Female|  167.97.48.246|\n|zlendrem6@columbi...|    Zorina|   Lendrem|     Female| 219.128.213.53|      null|        null|       null|           null|\n| hcurrier5@hexun.com|   Herrick|   Currier|       Male|    98.120.5.78|      null|        null|       null|           null|\n|      kupexc@sun.com|   Krispin|      Upex|       Male|  154.110.22.75|   Krispin|        Upex|       Male|  154.110.22.75|\n|ccastellan4@blogl...|   Chantal| Castellan|     Female|  178.93.82.145|      null|        null|       null|           null|\n|afaulconerb@barne...|    Andris| Faulconer|     Female| 109.40.175.103|    Andris|   Faulconer|     Female| 109.40.175.103|\n|rablitt2@technora...|    Reggie|    Ablitt|       Male|104.181.218.238|      null|        null|       null|           null|\n|tgavahan3@printfr...|       Ted|   Gavahan|     Female|  216.80.86.100|      null|        null|       null|           null|\n| alovett0@nsw.gov.au|   Aundrea|    Lovett|       Male|    62.72.1.143|      null|        null|       null|           null|\n|  lbutland7@time.com|     Lilas|   Butland|     Female|109.110.131.151|     Lilas|     Butland|     Female|109.110.131.151|\n|dmcmorrana@refere...|    Dorice|  McMorran|     Female|   233.1.28.220|    Dorice|    McMorran|     Female|   233.1.28.220|\n|kchomiszewskii@si...|      null|      null|       null|           null|    Kristo|Chomiszewski|     Female|   60.91.73.198|\n| rkelwickj@baidu.com|      null|      null|       null|           null| Rosemonde|     Kelwick|Genderfluid|   42.50.134.65|\n|skemsleyh@quantca...|      null|      null|       null|           null|      Shir|     Kemsley|       Male| 234.195.73.177|\n|kbaressf@geocitie...|      null|      null|       null|           null|     Karly|      Baress|     Female|145.232.153.145|\n|   amillinsg@com.com|      null|      null|       null|           null|  Adelaide|     Millins|     Female| 75.160.220.182|\n+--------------------+----------+----------+-----------+---------------+----------+------------+-----------+---------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641743731812,"submitTime":1641743731761,"finishTime":1641743733438,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"e4ba7063-ca93-47ef-ae97-423c7b6f3300"},{"version":"CommandV1","origId":1575837098435890,"guid":"17c6b5a5-22a0-4468-9c41-623c1bb2fa80","subtype":"command","commandType":"auto","position":7.21875,"command":"users1_df. \\\n    join(users2_df, 'email', 'left'). \\\n    union(\n        users1_df. \\\n            join(users2_df, 'email', 'right')\n    ). \\\n    distinct(). \\\n    count()","commandVersion":2,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Out[17]: 20</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641743745039,"submitTime":1641743745006,"finishTime":1641743746669,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"72321084-54ac-4237-846e-d5582b3db50a"},{"version":"CommandV1","origId":1575837098435891,"guid":"40b47121-7e8f-4b2a-8e26-ecf584c279b9","subtype":"command","commandType":"auto","position":7.25,"command":"# Projecting data after full outer join\n# Get the details from the users1_df, if missing get details from users2_df\n\nfrom pyspark.sql.functions import coalesce\nusers1_df. \\\n    join(users2_df, users1_df.email == users2_df.email, 'full'). \\\n    select(\n        coalesce(users1_df['email'], users2_df['email']).alias('email'),\n        coalesce(users1_df['first_name'], users2_df['first_name']).alias('first_name'),\n        coalesce(users1_df['last_name'], users2_df['last_name']).alias('last_name'),\n        coalesce(users1_df['gender'], users2_df['gender']).alias('gender'),\n        coalesce(users1_df['ip_address'], users2_df['ip_address']).alias('ip_address'),\n    ). \\\n    show()","commandVersion":81,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+--------------------+----------+------------+-----------+---------------+\n|               email|first_name|   last_name|     gender|     ip_address|\n+--------------------+----------+------------+-----------+---------------+\n|afaulconerb@barne...|    Andris|   Faulconer|     Female| 109.40.175.103|\n| alovett0@nsw.gov.au|   Aundrea|      Lovett|       Male|    62.72.1.143|\n|   amillinsg@com.com|  Adelaide|     Millins|     Female| 75.160.220.182|\n|bjowling1@spiegel.de|   Bettine|     Jowling|     Female|  26.250.197.47|\n|ccastellan4@blogl...|   Chantal|   Castellan|     Female|  178.93.82.145|\n|dmcmorrana@refere...|    Dorice|    McMorran|     Female|   233.1.28.220|\n|fmancktelowd@youk...|    Farand|  Mancktelow|Genderqueer|  190.20.187.10|\n| hcurrier5@hexun.com|   Herrick|     Currier|       Male|    98.120.5.78|\n|hunitt9@bizjourna...|    Holden|       Unitt|     Female|142.228.161.192|\n|kbaressf@geocitie...|     Karly|      Baress|     Female|145.232.153.145|\n|kchomiszewskii@si...|    Kristo|Chomiszewski|     Female|   60.91.73.198|\n|kdodgshune@google...|  Kellyann|    Dodgshun|     Female| 80.247.105.228|\n|      kupexc@sun.com|   Krispin|        Upex|       Male|  154.110.22.75|\n|  lbutland7@time.com|     Lilas|     Butland|     Female|109.110.131.151|\n|palfonsetti8@ask.com|    Putnam|  Alfonsetti|     Female|  167.97.48.246|\n|rablitt2@technora...|    Reggie|      Ablitt|       Male|104.181.218.238|\n| rkelwickj@baidu.com| Rosemonde|     Kelwick|Genderfluid|   42.50.134.65|\n|skemsleyh@quantca...|      Shir|     Kemsley|       Male| 234.195.73.177|\n|tgavahan3@printfr...|       Ted|     Gavahan|     Female|  216.80.86.100|\n|zlendrem6@columbi...|    Zorina|     Lendrem|     Female| 219.128.213.53|\n+--------------------+----------+------------+-----------+---------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641742552241,"submitTime":1641742542893,"finishTime":1641742552741,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"8f14d7e6-824d-49a9-86ca-ae0bf03ca375"},{"version":"CommandV1","origId":1575837098435892,"guid":"8788d482-a48b-4be7-ba28-6f34394a13e3","subtype":"command","commandType":"auto","position":8.25,"command":"# Using alias\nusers1_df.alias('u1'). \\\n    join(users2_df.alias('u2'), users1_df.email == users2_df.email, 'full'). \\\n    select(\n        coalesce('u1.email', 'u2.email').alias('email'),\n        coalesce('u1.first_name', 'u2.first_name').alias('first_name'),\n        coalesce('u1.last_name', 'u2.last_name').alias('last_name'),\n        coalesce('u1.gender', 'u2.gender').alias('gender'),\n        coalesce('u1.ip_address', 'u2.ip_address').alias('ip_address'),\n    ). \\\n    show()","commandVersion":42,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+--------------------+----------+------------+-----------+---------------+\n|               email|first_name|   last_name|     gender|     ip_address|\n+--------------------+----------+------------+-----------+---------------+\n|afaulconerb@barne...|    Andris|   Faulconer|     Female| 109.40.175.103|\n| alovett0@nsw.gov.au|   Aundrea|      Lovett|       Male|    62.72.1.143|\n|   amillinsg@com.com|  Adelaide|     Millins|     Female| 75.160.220.182|\n|bjowling1@spiegel.de|   Bettine|     Jowling|     Female|  26.250.197.47|\n|ccastellan4@blogl...|   Chantal|   Castellan|     Female|  178.93.82.145|\n|dmcmorrana@refere...|    Dorice|    McMorran|     Female|   233.1.28.220|\n|fmancktelowd@youk...|    Farand|  Mancktelow|Genderqueer|  190.20.187.10|\n| hcurrier5@hexun.com|   Herrick|     Currier|       Male|    98.120.5.78|\n|hunitt9@bizjourna...|    Holden|       Unitt|     Female|142.228.161.192|\n|kbaressf@geocitie...|     Karly|      Baress|     Female|145.232.153.145|\n|kchomiszewskii@si...|    Kristo|Chomiszewski|     Female|   60.91.73.198|\n|kdodgshune@google...|  Kellyann|    Dodgshun|     Female| 80.247.105.228|\n|      kupexc@sun.com|   Krispin|        Upex|       Male|  154.110.22.75|\n|  lbutland7@time.com|     Lilas|     Butland|     Female|109.110.131.151|\n|palfonsetti8@ask.com|    Putnam|  Alfonsetti|     Female|  167.97.48.246|\n|rablitt2@technora...|    Reggie|      Ablitt|       Male|104.181.218.238|\n| rkelwickj@baidu.com| Rosemonde|     Kelwick|Genderfluid|   42.50.134.65|\n|skemsleyh@quantca...|      Shir|     Kemsley|       Male| 234.195.73.177|\n|tgavahan3@printfr...|       Ted|     Gavahan|     Female|  216.80.86.100|\n|zlendrem6@columbi...|    Zorina|     Lendrem|     Female| 219.128.213.53|\n+--------------------+----------+------------+-----------+---------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641742552752,"submitTime":1641742542972,"finishTime":1641742553278,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"e1cabf30-388a-47e3-9fa8-1becab819ee5"},{"version":"CommandV1","origId":1575837098435893,"guid":"f4938d92-29b9-4394-ae87-001a84744f3f","subtype":"command","commandType":"auto","position":10.25,"command":"","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"febbdbe0-86d1-4dc7-9bf6-ed409aa9e560"}],"dashboards":[],"guid":"1e8402e2-273c-4267-833c-aa8178b43959","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{"pythonIndentUnit":4}}