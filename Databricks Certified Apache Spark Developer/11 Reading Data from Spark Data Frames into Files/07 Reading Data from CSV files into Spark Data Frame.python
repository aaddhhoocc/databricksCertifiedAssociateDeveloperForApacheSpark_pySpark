{"version":"NotebookV1","origId":1575837098435042,"name":"07 Reading Data from CSV files into Spark Data Frame","language":"python","commands":[{"version":"CommandV1","origId":1575837098435043,"guid":"e8ee5361-6338-46e8-8b54-1d5620ec4ef5","subtype":"command","commandType":"auto","position":1.0,"command":"%md\n\n* We can read the data from CSV files into Spark Data Frame using multiple approaches.\n* Approach 1: `spark.read.csv('path_to_folder')`\n* Approach 2: `spark.read.format('csv').load('path_to_folder')`\n* We can explicitly specify the schema as `string` or using `StructType`.\n* We can also read the data which is delimited or separated by other characters than comma.\n* If the files have header we can create the Data Frame with schema by using options such as `header` and `inferSchema`. It will pick column names from the header while data types will be inferred based on the data.\n* If the files does not have header we can create the Data Frame with schema by passing column names using `toDF` and by using `inferSchema` option.","commandVersion":179,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"bb0df909-df4b-4584-adcd-74459f6864f9"},{"version":"CommandV1","origId":1575837098435044,"guid":"85074a27-77b3-4353-aa04-f3b9304cb296","subtype":"command","commandType":"auto","position":2.0,"command":"# Default behavior\n# It will delimit the data using comma as separator\n# Column names will be system generated\n# All the fields will be of type strings\norders = spark.read.csv('/public/retail_db/orders')","commandVersion":42,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"orders","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"_c0","nullable":true,"type":"string"},{"metadata":{},"name":"_c1","nullable":true,"type":"string"},{"metadata":{},"name":"_c2","nullable":true,"type":"string"},{"metadata":{},"name":"_c3","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641508326778,"submitTime":1641508326699,"finishTime":1641508328104,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"d4520988-7f01-4f70-af96-67495a062c15"},{"version":"CommandV1","origId":1575837098435045,"guid":"47f5ca7c-b339-4406-bcdd-c34007bb52ba","subtype":"command","commandType":"auto","position":3.0,"command":"orders.columns","commandVersion":2,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Out[2]: [&#39;_c0&#39;, &#39;_c1&#39;, &#39;_c2&#39;, &#39;_c3&#39;]</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641508333795,"submitTime":1641508333780,"finishTime":1641508333819,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"7783562f-dba8-441b-ab8c-8f2314ad9abb"},{"version":"CommandV1","origId":1575837098435046,"guid":"e70f7d9a-a7f7-4188-a6e5-503ec26fb7d6","subtype":"command","commandType":"auto","position":4.0,"command":"orders.dtypes","commandVersion":2,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Out[3]: [(&#39;_c0&#39;, &#39;string&#39;), (&#39;_c1&#39;, &#39;string&#39;), (&#39;_c2&#39;, &#39;string&#39;), (&#39;_c3&#39;, &#39;string&#39;)]</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641508341669,"submitTime":1641508341604,"finishTime":1641508341687,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"a5835ba3-44b8-411c-816a-4c82c28294df"},{"version":"CommandV1","origId":1575837098435047,"guid":"94e2adf2-8584-4f98-8ca6-d72af7c47da4","subtype":"command","commandType":"auto","position":5.0,"command":"","commandVersion":0,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"37701bc2-c587-4ba2-8019-0cac5e8fcc17"}],"dashboards":[],"guid":"e63438b4-eb5a-4326-a195-bf2ff9b62e26","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{"pythonIndentUnit":4}}