{"version":"NotebookV1","origId":1575837098434953,"name":"06 Steps to follow to read data from files into Spark Data Frame","language":"python","commands":[{"version":"CommandV1","origId":1575837098434954,"guid":"e8ef5762-6539-49b2-a8e2-eeb3ba288f13","subtype":"command","commandType":"auto","position":1.0,"command":"%md\n\n* Check if the files are compressed (gz, snappy, bz2, etc). Most common ones are gz and snappy.\n* Understand the file format (text, json, avro, parquet, orc, etc). Sometimes files will not have extensions.\n* If files does not have extensions, make sure to confirm the details by going through the tech spec or by opening the file.\n* We will get tech specs from our leads or architects while working on real world projects.\n* If the files are of text file format, check if the data is delimited or separated by a specific character.\n* Use appropriate API under `spark.read` to read the data.","commandVersion":139,"state":"finished","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"d4d0a3cc-17ff-4fb6-989f-d03f1fd486a9"},{"version":"CommandV1","origId":1575837098434955,"guid":"30b5933f-9243-4ee0-b321-6c203a5cdc2c","subtype":"command","commandType":"auto","position":2.0,"command":"%fs ls /public/retail_db/orders","commandVersion":8,"state":"finished","results":{"type":"table","data":[["dbfs:/public/retail_db/orders/part-00000","part-00000",2999944]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"path","type":"\"string\"","metadata":"{}"},{"name":"name","type":"\"string\"","metadata":"{}"},{"name":"size","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641497404146,"submitTime":1641497404157,"finishTime":1641497407367,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"544","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"beb2af2d-5832-4c5c-a905-2725425f2484"},{"version":"CommandV1","origId":1575837098434956,"guid":"a437ffc0-8000-4d2e-a620-88eb5bb903f0","subtype":"command","commandType":"auto","position":2.5,"command":"spark.read.text('/public/retail_db/orders').show(truncate=False)","commandVersion":10,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+---------------------------------------------+\n|value                                        |\n+---------------------------------------------+\n|1,2013-07-25 00:00:00.0,11599,CLOSED         |\n|2,2013-07-25 00:00:00.0,256,PENDING_PAYMENT  |\n|3,2013-07-25 00:00:00.0,12111,COMPLETE       |\n|4,2013-07-25 00:00:00.0,8827,CLOSED          |\n|5,2013-07-25 00:00:00.0,11318,COMPLETE       |\n|6,2013-07-25 00:00:00.0,7130,COMPLETE        |\n|7,2013-07-25 00:00:00.0,4530,COMPLETE        |\n|8,2013-07-25 00:00:00.0,2911,PROCESSING      |\n|9,2013-07-25 00:00:00.0,5657,PENDING_PAYMENT |\n|10,2013-07-25 00:00:00.0,5648,PENDING_PAYMENT|\n|11,2013-07-25 00:00:00.0,918,PAYMENT_REVIEW  |\n|12,2013-07-25 00:00:00.0,1837,CLOSED         |\n|13,2013-07-25 00:00:00.0,9149,PENDING_PAYMENT|\n|14,2013-07-25 00:00:00.0,9842,PROCESSING     |\n|15,2013-07-25 00:00:00.0,2568,COMPLETE       |\n|16,2013-07-25 00:00:00.0,7276,PENDING_PAYMENT|\n|17,2013-07-25 00:00:00.0,2667,COMPLETE       |\n|18,2013-07-25 00:00:00.0,1205,CLOSED         |\n|19,2013-07-25 00:00:00.0,9488,PENDING_PAYMENT|\n|20,2013-07-25 00:00:00.0,9198,PROCESSING     |\n+---------------------------------------------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641497575196,"submitTime":1641497575232,"finishTime":1641497575493,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"98680401-b02b-4da6-a907-44b401566feb"},{"version":"CommandV1","origId":1575837098434957,"guid":"0103d6eb-4c34-47ac-8008-c427ec2c6d84","subtype":"command","commandType":"auto","position":3.0,"command":"%fs ls /public/retail_db_json/orders","commandVersion":3,"state":"finished","results":{"type":"table","data":[["dbfs:/public/retail_db_json/orders/part-r-00000-990f5773-9005-49ba-b670-631286032674","part-r-00000-990f5773-9005-49ba-b670-631286032674",7477339]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"path","type":"\"string\"","metadata":"{}"},{"name":"name","type":"\"string\"","metadata":"{}"},{"name":"size","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641497640516,"submitTime":1641497640554,"finishTime":1641497641298,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"1155","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"e3be237e-6a15-4523-b1bf-faa75eb79f17"},{"version":"CommandV1","origId":1575837098434958,"guid":"a62958bd-116a-4203-aa4a-347b4ec3251c","subtype":"command","commandType":"auto","position":3.5,"command":"spark.read.json('/public/retail_db_json/orders').show()","commandVersion":4,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+-----------------+--------------------+--------+---------------+\n|order_customer_id|          order_date|order_id|   order_status|\n+-----------------+--------------------+--------+---------------+\n|            11599|2013-07-25 00:00:...|       1|         CLOSED|\n|              256|2013-07-25 00:00:...|       2|PENDING_PAYMENT|\n|            12111|2013-07-25 00:00:...|       3|       COMPLETE|\n|             8827|2013-07-25 00:00:...|       4|         CLOSED|\n|            11318|2013-07-25 00:00:...|       5|       COMPLETE|\n|             7130|2013-07-25 00:00:...|       6|       COMPLETE|\n|             4530|2013-07-25 00:00:...|       7|       COMPLETE|\n|             2911|2013-07-25 00:00:...|       8|     PROCESSING|\n|             5657|2013-07-25 00:00:...|       9|PENDING_PAYMENT|\n|             5648|2013-07-25 00:00:...|      10|PENDING_PAYMENT|\n|              918|2013-07-25 00:00:...|      11| PAYMENT_REVIEW|\n|             1837|2013-07-25 00:00:...|      12|         CLOSED|\n|             9149|2013-07-25 00:00:...|      13|PENDING_PAYMENT|\n|             9842|2013-07-25 00:00:...|      14|     PROCESSING|\n|             2568|2013-07-25 00:00:...|      15|       COMPLETE|\n|             7276|2013-07-25 00:00:...|      16|PENDING_PAYMENT|\n|             2667|2013-07-25 00:00:...|      17|       COMPLETE|\n|             1205|2013-07-25 00:00:...|      18|         CLOSED|\n|             9488|2013-07-25 00:00:...|      19|PENDING_PAYMENT|\n|             9198|2013-07-25 00:00:...|      20|     PROCESSING|\n+-----------------+--------------------+--------+---------------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641497698722,"submitTime":1641497698761,"finishTime":1641497699477,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"4ffb6350-195a-4272-a65f-85daac4f532a"},{"version":"CommandV1","origId":1575837098434959,"guid":"f0473c91-a3c6-4c1d-b84e-7c7a7e2eedb5","subtype":"command","commandType":"auto","position":6.0,"command":"%fs ls /user/root/retail_db_parquet/orders","commandVersion":1,"state":"finished","results":{"type":"table","data":[["dbfs:/user/root/retail_db_parquet/orders/_committed_2813264261469267571","_committed_2813264261469267571",223],["dbfs:/user/root/retail_db_parquet/orders/_committed_3739854076266658903","_committed_3739854076266658903",123],["dbfs:/user/root/retail_db_parquet/orders/_committed_7198418882314090348","_committed_7198418882314090348",232],["dbfs:/user/root/retail_db_parquet/orders/_committed_7958689718562853532","_committed_7958689718562853532",222],["dbfs:/user/root/retail_db_parquet/orders/_committed_vacuum4032435399200819253","_committed_vacuum4032435399200819253",96],["dbfs:/user/root/retail_db_parquet/orders/_started_2813264261469267571","_started_2813264261469267571",0],["dbfs:/user/root/retail_db_parquet/orders/_started_7958689718562853532","_started_7958689718562853532",0],["dbfs:/user/root/retail_db_parquet/orders/part-00000-tid-2813264261469267571-eecb8f31-4c90-4763-89c5-6e2d7f0fafb1-168-1-c000.snappy.parquet","part-00000-tid-2813264261469267571-eecb8f31-4c90-4763-89c5-6e2d7f0fafb1-168-1-c000.snappy.parquet",489203]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"path","type":"\"string\"","metadata":"{}"},{"name":"name","type":"\"string\"","metadata":"{}"},{"name":"size","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641497864523,"submitTime":1641497864561,"finishTime":1641497865302,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"1638","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"b01a37b5-6c27-4843-a66b-c98eedc33827"},{"version":"CommandV1","origId":1575837098434960,"guid":"88ddfece-67e3-40ae-af2d-4dce5203d146","subtype":"command","commandType":"auto","position":7.0,"command":"","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"b5263b1d-b10f-4f71-9c28-035af4e0dbfd"}],"dashboards":[],"guid":"de80e587-f430-48de-bc9a-03f0e4288d4f","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{"pythonIndentUnit":4}}