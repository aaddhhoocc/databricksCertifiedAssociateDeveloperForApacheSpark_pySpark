{"version":"NotebookV1","origId":1575837098435571,"name":"08 Dropping Null based Records from Spark Data Frames","language":"python","commands":[{"version":"CommandV1","origId":1575837098435572,"guid":"c3b8b02e-fbfe-4f7c-8af3-d3becfe3f1d4","subtype":"command","commandType":"auto","position":0.5,"command":"%md\n\nHere are the features that are available with respect to dropping records based on null values.\n* Drop records when all column values are nulls.\n* Drop records any of the column value is null.\n* Drop records that have less than `thresh` non-null values.\n* Drop records when any of the column value or all column values are nulls for provided subset of columns.\n* We can use `df.na.drop` or `df.dropna` to take care of dealing with records having columns with null values.","commandVersion":94,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"7f8f4701-94aa-4f78-be76-265b1b7ff09c"},{"version":"CommandV1","origId":1575837098435573,"guid":"7a82e415-1436-4ab0-b0f9-ead342c654db","subtype":"command","commandType":"auto","position":1.0,"command":"import datetime\nusers = [\n    {\n        \"id\": 1,\n        \"first_name\": \"Corrie\",\n        \"last_name\": \"Van den Oord\",\n        \"email\": \"cvandenoord0@etsy.com\",\n        \"is_customer\": True,\n        \"amount_paid\": 1000.55,\n        \"customer_from\": datetime.date(2021, 1, 15),\n        \"last_updated_ts\": datetime.datetime(2021, 2, 10, 1, 15, 0)\n    },\n    {\n        \"id\": None,\n        \"first_name\": None,\n        \"last_name\": None,\n        \"email\": None,\n        \"is_customer\": None,\n        \"amount_paid\": None,\n        \"customer_from\": None,\n        \"last_updated_ts\": None\n    },\n    {\n        \"id\": 2,\n        \"first_name\": \"Nikolaus\",\n        \"last_name\": \"Brewitt\",\n        \"email\": \"nbrewitt1@dailymail.co.uk\",\n        \"is_customer\": True,\n        \"amount_paid\": 900.0,\n        \"customer_from\": datetime.date(2021, 2, 14),\n        \"last_updated_ts\": datetime.datetime(2021, 2, 18, 3, 33, 0)\n    },\n    {\n        \"id\": 3,\n        \"first_name\": \"Orelie\",\n        \"last_name\": \"Penney\",\n        \"email\": \"openney2@vistaprint.com\",\n        \"is_customer\": True,\n        \"amount_paid\": 850.55,\n        \"customer_from\": datetime.date(2021, 1, 21),\n        \"last_updated_ts\": datetime.datetime(2021, 3, 15, 15, 16, 55)\n    },\n    {\n        \"id\": 3,\n        \"first_name\": \"Orelie\",\n        \"last_name\": \"Penney\",\n        \"email\": \"openney2@vistaprint.com\",\n        \"is_customer\": True,\n        \"amount_paid\": 850.55,\n        \"customer_from\": datetime.date(2021, 1, 21),\n        \"last_updated_ts\": datetime.datetime(2021, 3, 15, 15, 16, 55)\n    },\n    {\n        \"id\": 4,\n        \"first_name\": \"Ashby\",\n        \"last_name\": \"Maddocks\",\n        \"email\": \"amaddocks3@home.pl\",\n        \"is_customer\": False,\n        \"amount_paid\": None,\n        \"customer_from\": None,\n        \"last_updated_ts\": datetime.datetime(2021, 4, 10, 17, 45, 30)\n    },\n    {\n        \"id\": 4,\n        \"first_name\": \"Ashby\",\n        \"last_name\": \"Maddocks\",\n        \"email\": \"amaddocks3@home.pl\",\n        \"is_customer\": False,\n        \"amount_paid\": None,\n        \"customer_from\": None,\n        \"last_updated_ts\": datetime.datetime(2021, 4, 10, 17, 45, 30)\n    },\n    {\n        \"id\": 5,\n        \"first_name\": \"Kurt\",\n        \"last_name\": \"Rome\",\n        \"email\": \"krome4@shutterfly.com\",\n        \"is_customer\": False,\n        \"amount_paid\": None,\n        \"customer_from\": None,\n        \"last_updated_ts\": datetime.datetime(2021, 4, 2, 0, 55, 18)\n    },\n    {\n        \"id\": None,\n        \"first_name\": None,\n        \"last_name\": None,\n        \"email\": None,\n        \"is_customer\": None,\n        \"amount_paid\": None,\n        \"customer_from\": None,\n        \"last_updated_ts\": None\n    },\n    {\n        \"id\": 5,\n        \"first_name\": None,\n        \"last_name\": None,\n        \"email\": None,\n        \"is_customer\": None,\n        \"amount_paid\": None,\n        \"customer_from\": None,\n        \"last_updated_ts\": None\n    },\n    {\n        \"id\": None,\n        \"first_name\": None,\n        \"last_name\": None,\n        \"email\": \"nbrewitt1@dailymail.co.uk\",\n        \"is_customer\": None,\n        \"amount_paid\": None,\n        \"customer_from\": None,\n        \"last_updated_ts\": None\n    },\n    {\n        \"id\": None,\n        \"first_name\": \"Kurt\",\n        \"last_name\": \"Rome\",\n        \"email\": None,\n        \"is_customer\": False,\n        \"amount_paid\": None,\n        \"customer_from\": None,\n        \"last_updated_ts\": datetime.datetime(2021, 4, 2, 0, 55, 18)\n    },\n    {\n        \"id\": 2,\n        \"first_name\": \"Nikolaus\",\n        \"last_name\": \"Brewitt\",\n        \"email\": \"nbrewitt1@dailymail.co.uk\",\n        \"is_customer\": True,\n        \"amount_paid\": 1050.0,\n        \"customer_from\": datetime.date(2021, 2, 14),\n        \"last_updated_ts\": datetime.datetime(2021, 2, 25, 3, 33, 0)\n    }\n]\n\n\nimport pandas as pd\nusers_df = spark.createDataFrame(pd.DataFrame(users))","commandVersion":101,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"users_df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"id","nullable":true,"type":"double"},{"metadata":{},"name":"first_name","nullable":true,"type":"string"},{"metadata":{},"name":"last_name","nullable":true,"type":"string"},{"metadata":{},"name":"email","nullable":true,"type":"string"},{"metadata":{},"name":"is_customer","nullable":true,"type":"boolean"},{"metadata":{},"name":"amount_paid","nullable":true,"type":"double"},{"metadata":{},"name":"customer_from","nullable":true,"type":"date"},{"metadata":{},"name":"last_updated_ts","nullable":true,"type":"timestamp"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641899758555,"submitTime":1641899758418,"finishTime":1641899758963,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"0160f05b-b18d-4b3c-815c-e39454b704d2"},{"version":"CommandV1","origId":1575837098435574,"guid":"2fcb7916-1756-4161-93d8-5905d897d0a0","subtype":"command","commandType":"auto","position":2.0,"command":"users_df.show()","commandVersion":3,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+----+----------+------------+--------------------+-----------+-----------+-------------+-------------------+\n|  id|first_name|   last_name|               email|is_customer|amount_paid|customer_from|    last_updated_ts|\n+----+----------+------------+--------------------+-----------+-----------+-------------+-------------------+\n| 1.0|    Corrie|Van den Oord|cvandenoord0@etsy...|       true|    1000.55|   2021-01-15|2021-02-10 01:15:00|\n|null|      null|        null|                null|       null|       null|         null|               null|\n| 2.0|  Nikolaus|     Brewitt|nbrewitt1@dailyma...|       true|      900.0|   2021-02-14|2021-02-18 03:33:00|\n| 3.0|    Orelie|      Penney|openney2@vistapri...|       true|     850.55|   2021-01-21|2021-03-15 15:16:55|\n| 3.0|    Orelie|      Penney|openney2@vistapri...|       true|     850.55|   2021-01-21|2021-03-15 15:16:55|\n| 4.0|     Ashby|    Maddocks|  amaddocks3@home.pl|      false|       null|         null|2021-04-10 17:45:30|\n| 4.0|     Ashby|    Maddocks|  amaddocks3@home.pl|      false|       null|         null|2021-04-10 17:45:30|\n| 5.0|      Kurt|        Rome|krome4@shutterfly...|      false|       null|         null|2021-04-02 00:55:18|\n|null|      null|        null|                null|       null|       null|         null|               null|\n| 5.0|      null|        null|                null|       null|       null|         null|               null|\n|null|      null|        null|nbrewitt1@dailyma...|       null|       null|         null|               null|\n|null|      Kurt|        Rome|                null|      false|       null|         null|2021-04-02 00:55:18|\n| 2.0|  Nikolaus|     Brewitt|nbrewitt1@dailyma...|       true|     1050.0|   2021-02-14|2021-02-25 03:33:00|\n+----+----------+------------+--------------------+-----------+-----------+-------------+-------------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641899758970,"submitTime":1641899758424,"finishTime":1641899759111,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"d5a54490-651f-4347-9e9c-bb7cc1ca2fd7"},{"version":"CommandV1","origId":1575837098435575,"guid":"afc53190-e676-4464-9e92-69172c056a01","subtype":"command","commandType":"auto","position":3.0,"command":"users_df.count()","commandVersion":3,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Out[3]: 13</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641899759118,"submitTime":1641899758430,"finishTime":1641899759320,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"bd3f6a2b-9500-4ca9-9aa1-bf230ebf38e6"},{"version":"CommandV1","origId":1575837098435576,"guid":"980fde78-a66f-4227-82b4-755a07d5eb7a","subtype":"command","commandType":"auto","position":4.0,"command":"# Attribute which exposes functions dealing with null records\n# drop => users_df.dropna\n# fill => users_df.fillna\n# replace => users_df.replacena\nusers_df.na","commandVersion":35,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Out[4]: &lt;pyspark.sql.dataframe.DataFrameNaFunctions at 0x7f981892ee80&gt;</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641899759327,"submitTime":1641899758437,"finishTime":1641899759345,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"729921bb-1a00-4bf5-8f6b-f7f1269fc0a9"},{"version":"CommandV1","origId":1575837098435577,"guid":"ac68249d-0ed4-4b49-bc19-503867736aaa","subtype":"command","commandType":"auto","position":5.0,"command":"help(users_df.dropna)","commandVersion":19,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Help on method dropna in module pyspark.sql.dataframe:\n\ndropna(how=&#39;any&#39;, thresh=None, subset=None) method of pyspark.sql.dataframe.DataFrame instance\n    Returns a new :class:`DataFrame` omitting rows with null values.\n    :func:`DataFrame.dropna` and :func:`DataFrameNaFunctions.drop` are aliases of each other.\n    \n    .. versionadded:: 1.3.1\n    \n    Parameters\n    ----------\n    how : str, optional\n        &#39;any&#39; or &#39;all&#39;.\n        If &#39;any&#39;, drop a row if it contains any nulls.\n        If &#39;all&#39;, drop a row only if all its values are null.\n    thresh: int, optional\n        default None\n        If specified, drop rows that have less than `thresh` non-null values.\n        This overwrites the `how` parameter.\n    subset : str, tuple or list, optional\n        optional list of column names to consider.\n    \n    Examples\n    --------\n    &gt;&gt;&gt; df4.na.drop().show()\n    +---+------+-----+\n    |age|height| name|\n    +---+------+-----+\n    | 10|    80|Alice|\n    +---+------+-----+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641899759349,"submitTime":1641899758441,"finishTime":1641899759372,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"a26fb860-360a-4899-aa53-7d6ef60c7326"},{"version":"CommandV1","origId":1575837098435578,"guid":"d6aa45f2-718c-4b79-90f6-0c4b65281614","subtype":"command","commandType":"auto","position":6.0,"command":"help(users_df.na.drop)","commandVersion":2,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Help on method drop in module pyspark.sql.dataframe:\n\ndrop(how=&#39;any&#39;, thresh=None, subset=None) method of pyspark.sql.dataframe.DataFrameNaFunctions instance\n    Returns a new :class:`DataFrame` omitting rows with null values.\n    :func:`DataFrame.dropna` and :func:`DataFrameNaFunctions.drop` are aliases of each other.\n    \n    .. versionadded:: 1.3.1\n    \n    Parameters\n    ----------\n    how : str, optional\n        &#39;any&#39; or &#39;all&#39;.\n        If &#39;any&#39;, drop a row if it contains any nulls.\n        If &#39;all&#39;, drop a row only if all its values are null.\n    thresh: int, optional\n        default None\n        If specified, drop rows that have less than `thresh` non-null values.\n        This overwrites the `how` parameter.\n    subset : str, tuple or list, optional\n        optional list of column names to consider.\n    \n    Examples\n    --------\n    &gt;&gt;&gt; df4.na.drop().show()\n    +---+------+-----+\n    |age|height| name|\n    +---+------+-----+\n    | 10|    80|Alice|\n    +---+------+-----+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641899759377,"submitTime":1641899758446,"finishTime":1641899759397,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"554a28b9-defc-48c0-b737-c0dc406b5885"},{"version":"CommandV1","origId":1575837098435579,"guid":"b1ecce86-55ab-45e0-beee-b646b8f04a6d","subtype":"command","commandType":"auto","position":6.5,"command":"users_df.show()","commandVersion":3,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+----+----------+------------+--------------------+-----------+-----------+-------------+-------------------+\n|  id|first_name|   last_name|               email|is_customer|amount_paid|customer_from|    last_updated_ts|\n+----+----------+------------+--------------------+-----------+-----------+-------------+-------------------+\n| 1.0|    Corrie|Van den Oord|cvandenoord0@etsy...|       true|    1000.55|   2021-01-15|2021-02-10 01:15:00|\n|null|      null|        null|                null|       null|       null|         null|               null|\n| 2.0|  Nikolaus|     Brewitt|nbrewitt1@dailyma...|       true|      900.0|   2021-02-14|2021-02-18 03:33:00|\n| 3.0|    Orelie|      Penney|openney2@vistapri...|       true|     850.55|   2021-01-21|2021-03-15 15:16:55|\n| 3.0|    Orelie|      Penney|openney2@vistapri...|       true|     850.55|   2021-01-21|2021-03-15 15:16:55|\n| 4.0|     Ashby|    Maddocks|  amaddocks3@home.pl|      false|       null|         null|2021-04-10 17:45:30|\n| 4.0|     Ashby|    Maddocks|  amaddocks3@home.pl|      false|       null|         null|2021-04-10 17:45:30|\n| 5.0|      Kurt|        Rome|krome4@shutterfly...|      false|       null|         null|2021-04-02 00:55:18|\n|null|      null|        null|                null|       null|       null|         null|               null|\n| 5.0|      null|        null|                null|       null|       null|         null|               null|\n|null|      null|        null|nbrewitt1@dailyma...|       null|       null|         null|               null|\n|null|      Kurt|        Rome|                null|      false|       null|         null|2021-04-02 00:55:18|\n| 2.0|  Nikolaus|     Brewitt|nbrewitt1@dailyma...|       true|     1050.0|   2021-02-14|2021-02-25 03:33:00|\n+----+----------+------------+--------------------+-----------+-----------+-------------+-------------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641899759402,"submitTime":1641899758451,"finishTime":1641899759493,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"61202090-43cb-49f8-95aa-d0d0dc2154bf"},{"version":"CommandV1","origId":1575837098435580,"guid":"43114d75-c49d-42e7-bc4a-303a336c9be1","subtype":"command","commandType":"auto","position":7.0,"command":"users_df.na.drop('all').show()","commandVersion":6,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+----+----------+------------+--------------------+-----------+-----------+-------------+-------------------+\n|  id|first_name|   last_name|               email|is_customer|amount_paid|customer_from|    last_updated_ts|\n+----+----------+------------+--------------------+-----------+-----------+-------------+-------------------+\n| 1.0|    Corrie|Van den Oord|cvandenoord0@etsy...|       true|    1000.55|   2021-01-15|2021-02-10 01:15:00|\n| 2.0|  Nikolaus|     Brewitt|nbrewitt1@dailyma...|       true|      900.0|   2021-02-14|2021-02-18 03:33:00|\n| 3.0|    Orelie|      Penney|openney2@vistapri...|       true|     850.55|   2021-01-21|2021-03-15 15:16:55|\n| 3.0|    Orelie|      Penney|openney2@vistapri...|       true|     850.55|   2021-01-21|2021-03-15 15:16:55|\n| 4.0|     Ashby|    Maddocks|  amaddocks3@home.pl|      false|       null|         null|2021-04-10 17:45:30|\n| 4.0|     Ashby|    Maddocks|  amaddocks3@home.pl|      false|       null|         null|2021-04-10 17:45:30|\n| 5.0|      Kurt|        Rome|krome4@shutterfly...|      false|       null|         null|2021-04-02 00:55:18|\n| 5.0|      null|        null|                null|       null|       null|         null|               null|\n|null|      null|        null|nbrewitt1@dailyma...|       null|       null|         null|               null|\n|null|      Kurt|        Rome|                null|      false|       null|         null|2021-04-02 00:55:18|\n| 2.0|  Nikolaus|     Brewitt|nbrewitt1@dailyma...|       true|     1050.0|   2021-02-14|2021-02-25 03:33:00|\n+----+----------+------------+--------------------+-----------+-----------+-------------+-------------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641899759500,"submitTime":1641899758457,"finishTime":1641899759640,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"be667fc9-af17-4ad7-a1bd-4c827f998cfa"},{"version":"CommandV1","origId":1575837098435581,"guid":"95565ed6-e16f-45a8-b7f3-5cc46e94cc8d","subtype":"command","commandType":"auto","position":8.0,"command":"# Drop if any column value is null\nusers_df.na.drop('any').show()","commandVersion":8,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+---+----------+------------+--------------------+-----------+-----------+-------------+-------------------+\n| id|first_name|   last_name|               email|is_customer|amount_paid|customer_from|    last_updated_ts|\n+---+----------+------------+--------------------+-----------+-----------+-------------+-------------------+\n|1.0|    Corrie|Van den Oord|cvandenoord0@etsy...|       true|    1000.55|   2021-01-15|2021-02-10 01:15:00|\n|2.0|  Nikolaus|     Brewitt|nbrewitt1@dailyma...|       true|      900.0|   2021-02-14|2021-02-18 03:33:00|\n|3.0|    Orelie|      Penney|openney2@vistapri...|       true|     850.55|   2021-01-21|2021-03-15 15:16:55|\n|3.0|    Orelie|      Penney|openney2@vistapri...|       true|     850.55|   2021-01-21|2021-03-15 15:16:55|\n|2.0|  Nikolaus|     Brewitt|nbrewitt1@dailyma...|       true|     1050.0|   2021-02-14|2021-02-25 03:33:00|\n+---+----------+------------+--------------------+-----------+-----------+-------------+-------------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641899759646,"submitTime":1641899758463,"finishTime":1641899759798,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"1e1a4f3b-5255-498d-ba5d-f5e6fcb9eb49"},{"version":"CommandV1","origId":1575837098435582,"guid":"a9005886-2011-4ad3-9ef1-ee742b3e28d7","subtype":"command","commandType":"auto","position":8.5,"command":"users_df.show()","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+----+----------+------------+--------------------+-----------+-----------+-------------+-------------------+\n|  id|first_name|   last_name|               email|is_customer|amount_paid|customer_from|    last_updated_ts|\n+----+----------+------------+--------------------+-----------+-----------+-------------+-------------------+\n| 1.0|    Corrie|Van den Oord|cvandenoord0@etsy...|       true|    1000.55|   2021-01-15|2021-02-10 01:15:00|\n|null|      null|        null|                null|       null|       null|         null|               null|\n| 2.0|  Nikolaus|     Brewitt|nbrewitt1@dailyma...|       true|      900.0|   2021-02-14|2021-02-18 03:33:00|\n| 3.0|    Orelie|      Penney|openney2@vistapri...|       true|     850.55|   2021-01-21|2021-03-15 15:16:55|\n| 3.0|    Orelie|      Penney|openney2@vistapri...|       true|     850.55|   2021-01-21|2021-03-15 15:16:55|\n| 4.0|     Ashby|    Maddocks|  amaddocks3@home.pl|      false|       null|         null|2021-04-10 17:45:30|\n| 4.0|     Ashby|    Maddocks|  amaddocks3@home.pl|      false|       null|         null|2021-04-10 17:45:30|\n| 5.0|      Kurt|        Rome|krome4@shutterfly...|      false|       null|         null|2021-04-02 00:55:18|\n|null|      null|        null|                null|       null|       null|         null|               null|\n| 5.0|      null|        null|                null|       null|       null|         null|               null|\n|null|      null|        null|nbrewitt1@dailyma...|       null|       null|         null|               null|\n|null|      Kurt|        Rome|                null|      false|       null|         null|2021-04-02 00:55:18|\n| 2.0|  Nikolaus|     Brewitt|nbrewitt1@dailyma...|       true|     1050.0|   2021-02-14|2021-02-25 03:33:00|\n+----+----------+------------+--------------------+-----------+-----------+-------------+-------------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641899759810,"submitTime":1641899758468,"finishTime":1641899759918,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"2b4874eb-fe56-4e81-af0c-f4553a31f6b3"},{"version":"CommandV1","origId":1575837098435583,"guid":"98f5ad2b-cbed-475f-bf08-978dddca5a76","subtype":"command","commandType":"auto","position":9.0,"command":"users_df.na.drop(thresh=2).show()","commandVersion":5,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+----+----------+------------+--------------------+-----------+-----------+-------------+-------------------+\n|  id|first_name|   last_name|               email|is_customer|amount_paid|customer_from|    last_updated_ts|\n+----+----------+------------+--------------------+-----------+-----------+-------------+-------------------+\n| 1.0|    Corrie|Van den Oord|cvandenoord0@etsy...|       true|    1000.55|   2021-01-15|2021-02-10 01:15:00|\n| 2.0|  Nikolaus|     Brewitt|nbrewitt1@dailyma...|       true|      900.0|   2021-02-14|2021-02-18 03:33:00|\n| 3.0|    Orelie|      Penney|openney2@vistapri...|       true|     850.55|   2021-01-21|2021-03-15 15:16:55|\n| 3.0|    Orelie|      Penney|openney2@vistapri...|       true|     850.55|   2021-01-21|2021-03-15 15:16:55|\n| 4.0|     Ashby|    Maddocks|  amaddocks3@home.pl|      false|       null|         null|2021-04-10 17:45:30|\n| 4.0|     Ashby|    Maddocks|  amaddocks3@home.pl|      false|       null|         null|2021-04-10 17:45:30|\n| 5.0|      Kurt|        Rome|krome4@shutterfly...|      false|       null|         null|2021-04-02 00:55:18|\n|null|      Kurt|        Rome|                null|      false|       null|         null|2021-04-02 00:55:18|\n| 2.0|  Nikolaus|     Brewitt|nbrewitt1@dailyma...|       true|     1050.0|   2021-02-14|2021-02-25 03:33:00|\n+----+----------+------------+--------------------+-----------+-----------+-------------+-------------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641899759922,"submitTime":1641899758474,"finishTime":1641899760082,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"7fef031e-4878-4322-a038-43ccda2ae065"},{"version":"CommandV1","origId":1575837098435584,"guid":"31fb4bb8-54a3-4f72-8181-4bb3f74035a3","subtype":"command","commandType":"auto","position":9.5,"command":"users_df.show()","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+----+----------+------------+--------------------+-----------+-----------+-------------+-------------------+\n|  id|first_name|   last_name|               email|is_customer|amount_paid|customer_from|    last_updated_ts|\n+----+----------+------------+--------------------+-----------+-----------+-------------+-------------------+\n| 1.0|    Corrie|Van den Oord|cvandenoord0@etsy...|       true|    1000.55|   2021-01-15|2021-02-10 01:15:00|\n|null|      null|        null|                null|       null|       null|         null|               null|\n| 2.0|  Nikolaus|     Brewitt|nbrewitt1@dailyma...|       true|      900.0|   2021-02-14|2021-02-18 03:33:00|\n| 3.0|    Orelie|      Penney|openney2@vistapri...|       true|     850.55|   2021-01-21|2021-03-15 15:16:55|\n| 3.0|    Orelie|      Penney|openney2@vistapri...|       true|     850.55|   2021-01-21|2021-03-15 15:16:55|\n| 4.0|     Ashby|    Maddocks|  amaddocks3@home.pl|      false|       null|         null|2021-04-10 17:45:30|\n| 4.0|     Ashby|    Maddocks|  amaddocks3@home.pl|      false|       null|         null|2021-04-10 17:45:30|\n| 5.0|      Kurt|        Rome|krome4@shutterfly...|      false|       null|         null|2021-04-02 00:55:18|\n|null|      null|        null|                null|       null|       null|         null|               null|\n| 5.0|      null|        null|                null|       null|       null|         null|               null|\n|null|      null|        null|nbrewitt1@dailyma...|       null|       null|         null|               null|\n|null|      Kurt|        Rome|                null|      false|       null|         null|2021-04-02 00:55:18|\n| 2.0|  Nikolaus|     Brewitt|nbrewitt1@dailyma...|       true|     1050.0|   2021-02-14|2021-02-25 03:33:00|\n+----+----------+------------+--------------------+-----------+-----------+-------------+-------------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641899760092,"submitTime":1641899758479,"finishTime":1641899760189,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"f443dffa-d526-422b-af6b-f9fedf3c88d9"},{"version":"CommandV1","origId":1575837098435585,"guid":"7249d527-f54d-4543-9bb4-7e679fa66776","subtype":"command","commandType":"auto","position":10.0,"command":"users_df.na.drop(how='all', subset=['id', 'email']).show()","commandVersion":14,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+----+----------+------------+--------------------+-----------+-----------+-------------+-------------------+\n|  id|first_name|   last_name|               email|is_customer|amount_paid|customer_from|    last_updated_ts|\n+----+----------+------------+--------------------+-----------+-----------+-------------+-------------------+\n| 1.0|    Corrie|Van den Oord|cvandenoord0@etsy...|       true|    1000.55|   2021-01-15|2021-02-10 01:15:00|\n| 2.0|  Nikolaus|     Brewitt|nbrewitt1@dailyma...|       true|      900.0|   2021-02-14|2021-02-18 03:33:00|\n| 3.0|    Orelie|      Penney|openney2@vistapri...|       true|     850.55|   2021-01-21|2021-03-15 15:16:55|\n| 3.0|    Orelie|      Penney|openney2@vistapri...|       true|     850.55|   2021-01-21|2021-03-15 15:16:55|\n| 4.0|     Ashby|    Maddocks|  amaddocks3@home.pl|      false|       null|         null|2021-04-10 17:45:30|\n| 4.0|     Ashby|    Maddocks|  amaddocks3@home.pl|      false|       null|         null|2021-04-10 17:45:30|\n| 5.0|      Kurt|        Rome|krome4@shutterfly...|      false|       null|         null|2021-04-02 00:55:18|\n| 5.0|      null|        null|                null|       null|       null|         null|               null|\n|null|      null|        null|nbrewitt1@dailyma...|       null|       null|         null|               null|\n| 2.0|  Nikolaus|     Brewitt|nbrewitt1@dailyma...|       true|     1050.0|   2021-02-14|2021-02-25 03:33:00|\n+----+----------+------------+--------------------+-----------+-----------+-------------+-------------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641899760194,"submitTime":1641899758485,"finishTime":1641899760394,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"4a20ea5f-180b-4665-889f-fcfcf6911d34"},{"version":"CommandV1","origId":1575837098435586,"guid":"13a8b5a0-76b6-49bb-bac2-3e3ecd93fe8e","subtype":"command","commandType":"auto","position":11.0,"command":"users_df.na.drop(how='any', subset=['id', 'email']).show()","commandVersion":2,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+---+----------+------------+--------------------+-----------+-----------+-------------+-------------------+\n| id|first_name|   last_name|               email|is_customer|amount_paid|customer_from|    last_updated_ts|\n+---+----------+------------+--------------------+-----------+-----------+-------------+-------------------+\n|1.0|    Corrie|Van den Oord|cvandenoord0@etsy...|       true|    1000.55|   2021-01-15|2021-02-10 01:15:00|\n|2.0|  Nikolaus|     Brewitt|nbrewitt1@dailyma...|       true|      900.0|   2021-02-14|2021-02-18 03:33:00|\n|3.0|    Orelie|      Penney|openney2@vistapri...|       true|     850.55|   2021-01-21|2021-03-15 15:16:55|\n|3.0|    Orelie|      Penney|openney2@vistapri...|       true|     850.55|   2021-01-21|2021-03-15 15:16:55|\n|4.0|     Ashby|    Maddocks|  amaddocks3@home.pl|      false|       null|         null|2021-04-10 17:45:30|\n|4.0|     Ashby|    Maddocks|  amaddocks3@home.pl|      false|       null|         null|2021-04-10 17:45:30|\n|5.0|      Kurt|        Rome|krome4@shutterfly...|      false|       null|         null|2021-04-02 00:55:18|\n|2.0|  Nikolaus|     Brewitt|nbrewitt1@dailyma...|       true|     1050.0|   2021-02-14|2021-02-25 03:33:00|\n+---+----------+------------+--------------------+-----------+-----------+-------------+-------------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641899760399,"submitTime":1641899758490,"finishTime":1641899760612,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"f21dd6a0-ed1d-40ed-a8f7-e6bc94fab124"},{"version":"CommandV1","origId":1575837098435587,"guid":"65cb13cb-4b2c-4f6e-a17c-2ee432b77bc3","subtype":"command","commandType":"auto","position":12.0,"command":"","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"7c5fc39d-5599-4a7c-aeb2-ad3a0906fae6"}],"dashboards":[],"guid":"2339142f-1e38-4fcd-8c8d-a1c125b906bb","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{"pythonIndentUnit":4}}