{"version":"NotebookV1","origId":1575837098434889,"name":"04 Partition Spark Data Frame By Multiple Columns","language":"python","commands":[{"version":"CommandV1","origId":1575837098434890,"guid":"dcf718e5-b067-4132-9d66-80a4477df616","subtype":"command","commandType":"auto","position":1.0,"command":"orders = spark.read.json('/public/retail_db_json/orders')","commandVersion":11,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"orders","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"order_customer_id","nullable":true,"type":"long"},{"metadata":{},"name":"order_date","nullable":true,"type":"string"},{"metadata":{},"name":"order_id","nullable":true,"type":"long"},{"metadata":{},"name":"order_status","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641611482931,"submitTime":1641611481018,"finishTime":1641611483708,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"e9ecbd5e-82dd-490c-bb3e-8e7783060afd"},{"version":"CommandV1","origId":1575837098434891,"guid":"4447da99-e50e-461c-a75d-dbd4972b56e8","subtype":"command","commandType":"auto","position":2.0,"command":"import getpass\nusername = getpass.getuser()","commandVersion":7,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641611483720,"submitTime":1641611483181,"finishTime":1641611483738,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"a115d1ee-98a9-4460-ba49-5fc36e059583"},{"version":"CommandV1","origId":1575837098434892,"guid":"c41372c3-52b8-402a-bd70-6e8c4790442d","subtype":"command","commandType":"auto","position":4.0,"command":"%md\n\n* Partition data by year, month and then day_of_month","commandVersion":18,"state":"finished","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"505d4c41-a5ab-42d9-b353-5a151191ec7f"},{"version":"CommandV1","origId":1575837098434893,"guid":"6c04c8a0-31d2-43cd-97c3-c9899af1bf66","subtype":"command","commandType":"auto","position":4.5,"command":"from pyspark.sql.functions import date_format","commandVersion":7,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641611499956,"submitTime":1641611499928,"finishTime":1641611499974,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"498fbceb-a106-4749-b52d-6cd678329d97"},{"version":"CommandV1","origId":1575837098434894,"guid":"f39e3505-a531-45c7-9bd5-76971e2af39c","subtype":"command","commandType":"auto","position":5.0,"command":"orders. \\\n    withColumn('year', date_format('order_date', 'yyyy')). \\\n    withColumn('month', date_format('order_date', 'MM')). \\\n    withColumn('day_of_month', date_format('order_date', 'dd')). \\\n    show()","commandVersion":13,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+-----------------+--------------------+--------+---------------+----+-----+------------+\n|order_customer_id|          order_date|order_id|   order_status|year|month|day_of_month|\n+-----------------+--------------------+--------+---------------+----+-----+------------+\n|            11599|2013-07-25 00:00:...|       1|         CLOSED|2013|   07|          25|\n|              256|2013-07-25 00:00:...|       2|PENDING_PAYMENT|2013|   07|          25|\n|            12111|2013-07-25 00:00:...|       3|       COMPLETE|2013|   07|          25|\n|             8827|2013-07-25 00:00:...|       4|         CLOSED|2013|   07|          25|\n|            11318|2013-07-25 00:00:...|       5|       COMPLETE|2013|   07|          25|\n|             7130|2013-07-25 00:00:...|       6|       COMPLETE|2013|   07|          25|\n|             4530|2013-07-25 00:00:...|       7|       COMPLETE|2013|   07|          25|\n|             2911|2013-07-25 00:00:...|       8|     PROCESSING|2013|   07|          25|\n|             5657|2013-07-25 00:00:...|       9|PENDING_PAYMENT|2013|   07|          25|\n|             5648|2013-07-25 00:00:...|      10|PENDING_PAYMENT|2013|   07|          25|\n|              918|2013-07-25 00:00:...|      11| PAYMENT_REVIEW|2013|   07|          25|\n|             1837|2013-07-25 00:00:...|      12|         CLOSED|2013|   07|          25|\n|             9149|2013-07-25 00:00:...|      13|PENDING_PAYMENT|2013|   07|          25|\n|             9842|2013-07-25 00:00:...|      14|     PROCESSING|2013|   07|          25|\n|             2568|2013-07-25 00:00:...|      15|       COMPLETE|2013|   07|          25|\n|             7276|2013-07-25 00:00:...|      16|PENDING_PAYMENT|2013|   07|          25|\n|             2667|2013-07-25 00:00:...|      17|       COMPLETE|2013|   07|          25|\n|             1205|2013-07-25 00:00:...|      18|         CLOSED|2013|   07|          25|\n|             9488|2013-07-25 00:00:...|      19|PENDING_PAYMENT|2013|   07|          25|\n|             9198|2013-07-25 00:00:...|      20|     PROCESSING|2013|   07|          25|\n+-----------------+--------------------+--------+---------------+----+-----+------------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641611500699,"submitTime":1641611500668,"finishTime":1641611501199,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"aedeeff8-87c4-4b20-a520-ba16a2efba4c"},{"version":"CommandV1","origId":1575837098434895,"guid":"f92854b5-90fe-4592-a560-cfd760491317","subtype":"command","commandType":"auto","position":5.5,"command":"dbutils.fs.rm(f'/user/{username}/retail_db/orders_partitioned', recurse=True)","commandVersion":6,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Out[7]: False</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641611501534,"submitTime":1641611501509,"finishTime":1641611501564,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"c7422078-d0b5-4037-9750-daf5a5135084"},{"version":"CommandV1","origId":1575837098434896,"guid":"2e78ad7f-ecb6-45bb-ac57-624f7535b243","subtype":"command","commandType":"auto","position":6.0,"command":"orders. \\\n    withColumn('year', date_format('order_date', 'yyyy')). \\\n    withColumn('month', date_format('order_date', 'MM')). \\\n    withColumn('day_of_month', date_format('order_date', 'dd')). \\\n    coalesce(1). \\\n    write. \\\n    partitionBy('year', 'month', 'day_of_month'). \\\n    parquet(f'/user/{username}/retail_db/orders_partitioned')","commandVersion":16,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641611502572,"submitTime":1641611502546,"finishTime":1641611607607,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"dbc2354c-fa8b-444c-9c5c-e19cc8f9085c"},{"version":"CommandV1","origId":1575837098434897,"guid":"d5c8e384-2f62-45ee-8d6e-6dd10443b8d6","subtype":"command","commandType":"auto","position":7.0,"command":"dbutils.fs.ls(f'/user/{username}/retail_db/orders_partitioned')","commandVersion":12,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Out[15]: [FileInfo(path=&#39;dbfs:/user/root/retail_db/orders_partitioned/_SUCCESS&#39;, name=&#39;_SUCCESS&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/retail_db/orders_partitioned/year=2013/&#39;, name=&#39;year=2013/&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/retail_db/orders_partitioned/year=2014/&#39;, name=&#39;year=2014/&#39;, size=0)]</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641611659671,"submitTime":1641611659641,"finishTime":1641611659725,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"d802c8e4-cc29-4cc8-ba12-4918e2adef2a"},{"version":"CommandV1","origId":1575837098434898,"guid":"37577a5b-559c-405f-b5da-80e79d96a965","subtype":"command","commandType":"auto","position":7.5,"command":"dbutils.fs.ls(f'/user/{username}/retail_db/orders_partitioned/year=2014/month=01/day_of_month=09')","commandVersion":22,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Out[19]: [FileInfo(path=&#39;dbfs:/user/root/retail_db/orders_partitioned/year=2014/month=01/day_of_month=09/_SUCCESS&#39;, name=&#39;_SUCCESS&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/retail_db/orders_partitioned/year=2014/month=01/day_of_month=09/_committed_6313925012555875767&#39;, name=&#39;_committed_6313925012555875767&#39;, size=126),\n FileInfo(path=&#39;dbfs:/user/root/retail_db/orders_partitioned/year=2014/month=01/day_of_month=09/_started_6313925012555875767&#39;, name=&#39;_started_6313925012555875767&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/retail_db/orders_partitioned/year=2014/month=01/day_of_month=09/part-00000-tid-6313925012555875767-44252370-dcd0-4b86-a2f5-ea8f004a09a3-637-169.c000.snappy.parquet&#39;, name=&#39;part-00000-tid-6313925012555875767-44252370-dcd0-4b86-a2f5-ea8f004a09a3-637-169.c000.snappy.parquet&#39;, size=3488)]</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641611717972,"submitTime":1641611717945,"finishTime":1641611718038,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"80fcb861-91b7-4782-b38d-5b543c94891a"},{"version":"CommandV1","origId":1575837098434899,"guid":"8086cf1c-c37c-427b-aa0c-99dc9539917b","subtype":"command","commandType":"auto","position":8.0,"command":"orders.count()","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Out[10]: 68883</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641611607656,"submitTime":1641611508035,"finishTime":1641611608164,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"648603d8-65bd-45ba-93c0-80a9d93ae520"},{"version":"CommandV1","origId":1575837098434900,"guid":"42c84344-338e-46a4-b018-5f75af17b61e","subtype":"command","commandType":"auto","position":9.0,"command":"spark.read.parquet(f'/user/{username}/retail_db/orders_partitioned').dtypes","commandVersion":4,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Out[11]: [(&#39;order_customer_id&#39;, &#39;bigint&#39;),\n (&#39;order_date&#39;, &#39;string&#39;),\n (&#39;order_id&#39;, &#39;bigint&#39;),\n (&#39;order_status&#39;, &#39;string&#39;),\n (&#39;year&#39;, &#39;int&#39;),\n (&#39;month&#39;, &#39;int&#39;),\n (&#39;day_of_month&#39;, &#39;int&#39;)]</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641611608174,"submitTime":1641611508297,"finishTime":1641611619619,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"aeca4b2e-da56-4e3a-bb28-cec4143f2aaf"},{"version":"CommandV1","origId":1575837098434901,"guid":"2558c920-c702-4379-bd77-480917ba5201","subtype":"command","commandType":"auto","position":10.0,"command":"spark.read.parquet(f'/user/{username}/retail_db/orders_partitioned').show()","commandVersion":3,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+-----------------+--------------------+--------+---------------+----+-----+------------+\n|order_customer_id|          order_date|order_id|   order_status|year|month|day_of_month|\n+-----------------+--------------------+--------+---------------+----+-----+------------+\n|             6471|2013-11-03 00:00:...|   15793|       COMPLETE|2013|   11|           3|\n|             5323|2013-11-03 00:00:...|   15794|     PROCESSING|2013|   11|           3|\n|            10096|2013-11-03 00:00:...|   15795|         CLOSED|2013|   11|           3|\n|            11665|2013-11-03 00:00:...|   15796|       COMPLETE|2013|   11|           3|\n|             6249|2013-11-03 00:00:...|   15797|PENDING_PAYMENT|2013|   11|           3|\n|            10736|2013-11-03 00:00:...|   15798|       COMPLETE|2013|   11|           3|\n|             5475|2013-11-03 00:00:...|   15799|       COMPLETE|2013|   11|           3|\n|             7417|2013-11-03 00:00:...|   15800|     PROCESSING|2013|   11|           3|\n|             4021|2013-11-03 00:00:...|   15801|       COMPLETE|2013|   11|           3|\n|             2284|2013-11-03 00:00:...|   15802|         CLOSED|2013|   11|           3|\n|             1015|2013-11-03 00:00:...|   15803|     PROCESSING|2013|   11|           3|\n|              208|2013-11-03 00:00:...|   15804|       COMPLETE|2013|   11|           3|\n|             3708|2013-11-03 00:00:...|   15805|        PENDING|2013|   11|           3|\n|            10239|2013-11-03 00:00:...|   15806|PENDING_PAYMENT|2013|   11|           3|\n|             4709|2013-11-03 00:00:...|   15807|PENDING_PAYMENT|2013|   11|           3|\n|             5877|2013-11-03 00:00:...|   15808|PENDING_PAYMENT|2013|   11|           3|\n|             5361|2013-11-03 00:00:...|   15809|        PENDING|2013|   11|           3|\n|               49|2013-11-03 00:00:...|   15810|SUSPECTED_FRAUD|2013|   11|           3|\n|             3953|2013-11-03 00:00:...|   15811|       COMPLETE|2013|   11|           3|\n|            11882|2013-11-03 00:00:...|   15812|       COMPLETE|2013|   11|           3|\n+-----------------+--------------------+--------+---------------+----+-----+------------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641611619627,"submitTime":1641611508579,"finishTime":1641611630404,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"89070d16-5737-47de-bbe1-c7f087d6bef2"},{"version":"CommandV1","origId":1575837098434902,"guid":"66b3830d-a99d-4e89-8ef1-9de9e2190531","subtype":"command","commandType":"auto","position":11.0,"command":"spark.read.parquet(f'/user/{username}/retail_db/orders_partitioned').count()","commandVersion":3,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Out[13]: 68883</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641611630412,"submitTime":1641611509016,"finishTime":1641611645444,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"969fe65c-64a2-4c2e-8bad-81170cc3d8be"},{"version":"CommandV1","origId":1575837098434903,"guid":"c7efa5c4-c6a6-407c-841b-128bc37ce053","subtype":"command","commandType":"auto","position":12.0,"command":"","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"fe2f3809-4f9e-494b-a6d0-2deb93161187"}],"dashboards":[],"guid":"057918b6-522a-4e8c-97e4-fadb2cd79032","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{"pythonIndentUnit":4}}