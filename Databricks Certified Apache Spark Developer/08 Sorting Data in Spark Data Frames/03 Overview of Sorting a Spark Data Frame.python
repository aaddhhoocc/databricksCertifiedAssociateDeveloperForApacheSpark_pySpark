{"version":"NotebookV1","origId":1575837098434638,"name":"03 Overview of Sorting a Spark Data Frame","language":"python","commands":[{"version":"CommandV1","origId":1575837098434639,"guid":"71fc7420-11a8-45a1-9775-008b5927f9f8","subtype":"command","commandType":"auto","position":1.0,"command":"%run \"./02 Creating Spark Data Frame for Sorting the Data\"","commandVersion":4,"state":"finished","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641433857586,"submitTime":1641433857586,"finishTime":1641433858751,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"2321d495-10d5-47b4-b087-11f610bd1ca3"},{"version":"CommandV1","origId":1575837098434640,"guid":"d1711e7c-d207-47ff-a771-666d50b0fe71","subtype":"script","commandType":"auto","position":1.1428571428571428,"command":"","commandVersion":8,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641433857602,"submitTime":0,"finishTime":1641433857633,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["71fc7420-11a8-45a1-9775-008b5927f9f8"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"0660bd2b-1a22-45d9-bc0a-0310dd86cbc9"},{"version":"CommandV1","origId":1575837098434641,"guid":"45d54c45-7f3a-47c9-b2cd-e961dcd2280c","subtype":"script","commandType":"auto","position":1.2857142857142856,"command":"","commandVersion":302,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641433857640,"submitTime":0,"finishTime":1641433857660,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["71fc7420-11a8-45a1-9775-008b5927f9f8"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"14b6a601-2c96-46ed-a857-cb5a9a477a4a"},{"version":"CommandV1","origId":1575837098434642,"guid":"97f34ee0-01ba-4524-96f7-35c06dc5cb96","subtype":"script","commandType":"auto","position":1.4285714285714286,"command":"","commandVersion":3,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641433857674,"submitTime":0,"finishTime":1641433857880,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["71fc7420-11a8-45a1-9775-008b5927f9f8"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"1f68d5ea-bc7a-4174-a367-87dfd283c10f"},{"version":"CommandV1","origId":1575837098434643,"guid":"d914a42c-8796-4c91-8fe9-9894da5c9f40","subtype":"command","commandType":"auto","position":1.5,"command":"%md\n\nHere are the sorting scenarios which we should be familiar with.\n* Sort a data frame using ascending order by a specific column.\n* Sort a data frame using descending order by a specific column.\n* Dealing with nulls while sorting the data (having the null values at the beginning or at the end).\n* Sort a data frame using multiple columns (composite sorting). We also need to be aware of how to sort the data in ascending order by first column and then descending order by second column as well as vice versa.\n* We also need to make sure how to perform prioritized sorting. For example, let's say we want to get USA at the top and rest of the countries in ascending order by their respective names.","commandVersion":148,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"abb08103-05bc-4ecb-8e2d-75aa24d66af5"},{"version":"CommandV1","origId":1575837098434644,"guid":"3c8baccf-1c39-4345-8080-2a884c7fdf69","subtype":"script","commandType":"auto","position":1.5714285714285714,"command":"","commandVersion":10,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641433857885,"submitTime":0,"finishTime":1641433857899,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["71fc7420-11a8-45a1-9775-008b5927f9f8"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"190d92f6-78dc-4067-a4d3-540ba3531fc1"},{"version":"CommandV1","origId":1575837098434645,"guid":"38f32672-161e-4000-b8a1-8ad4728db071","subtype":"script","commandType":"auto","position":1.7142857142857144,"command":"","commandVersion":7,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"users_df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"id","nullable":true,"type":"long"},{"metadata":{},"name":"first_name","nullable":true,"type":"string"},{"metadata":{},"name":"last_name","nullable":true,"type":"string"},{"metadata":{},"name":"email","nullable":true,"type":"string"},{"metadata":{},"name":"phone_numbers","nullable":true,"type":{"fields":[{"metadata":{},"name":"mobile","nullable":true,"type":"string"},{"metadata":{},"name":"home","nullable":true,"type":"string"}],"type":"struct"}},{"metadata":{},"name":"courses","nullable":true,"type":{"containsNull":true,"elementType":"long","type":"array"}},{"metadata":{},"name":"is_customer","nullable":true,"type":"boolean"},{"metadata":{},"name":"amount_paid","nullable":true,"type":"double"},{"metadata":{},"name":"customer_from","nullable":true,"type":"date"},{"metadata":{},"name":"last_updated_ts","nullable":true,"type":"timestamp"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641433857904,"submitTime":0,"finishTime":1641433858012,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["71fc7420-11a8-45a1-9775-008b5927f9f8"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"38d702b0-28b4-4191-9c12-807fbd065102"},{"version":"CommandV1","origId":1575837098434646,"guid":"cf75bf65-9087-4a2e-a99e-beb9ae126e93","subtype":"script","commandType":"auto","position":1.8571428571428572,"command":"","commandVersion":3,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+---+----------+------------+--------------------+--------------------+-------+-----------+-----------+-------------+-------------------+\n| id|first_name|   last_name|               email|       phone_numbers|courses|is_customer|amount_paid|customer_from|    last_updated_ts|\n+---+----------+------------+--------------------+--------------------+-------+-----------+-----------+-------------+-------------------+\n|  1|    Corrie|Van den Oord|cvandenoord0@etsy...|{+1 234 567 8901,...| [1, 2]|       true|    1000.55|   2021-01-15|2021-02-10 01:15:00|\n|  2|  Nikolaus|     Brewitt|nbrewitt1@dailyma...|{+1 234 567 8923,...|    [3]|       true|      900.0|   2021-02-14|2021-02-18 03:33:00|\n|  3|    Orelie|      Penney|openney2@vistapri...|{+1 714 512 9752,...| [2, 4]|       true|     850.55|   2021-01-21|2021-03-15 15:16:55|\n|  4|     Ashby|    Maddocks|  amaddocks3@home.pl|        {null, null}|     []|      false|        NaN|         null|2021-04-10 17:45:30|\n|  5|      Kurt|        Rome|krome4@shutterfly...|{+1 817 934 7142,...|     []|      false|        NaN|         null|2021-04-02 00:55:18|\n+---+----------+------------+--------------------+--------------------+-------+-----------+-----------+-------------+-------------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641433858017,"submitTime":0,"finishTime":1641433858592,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["71fc7420-11a8-45a1-9775-008b5927f9f8"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"9d0fda49-18dd-445a-8068-9e5c8d94091e"},{"version":"CommandV1","origId":1575837098434647,"guid":"d6e84dc5-0698-44e7-a78b-32b588d13cd9","subtype":"command","commandType":"auto","position":2.0,"command":"help(users_df.sort)","commandVersion":3,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Help on method sort in module pyspark.sql.dataframe:\n\nsort(*cols, **kwargs) method of pyspark.sql.dataframe.DataFrame instance\n    Returns a new :class:`DataFrame` sorted by the specified column(s).\n    \n    .. versionadded:: 1.3.0\n    \n    Parameters\n    ----------\n    cols : str, list, or :class:`Column`, optional\n         list of :class:`Column` or column names to sort by.\n    \n    Other Parameters\n    ----------------\n    ascending : bool or list, optional\n        boolean or list of boolean (default ``True``).\n        Sort ascending vs. descending. Specify list for multiple sort orders.\n        If a list is specified, length of the list must equal length of the `cols`.\n    \n    Examples\n    --------\n    &gt;&gt;&gt; df.sort(df.age.desc()).collect()\n    [Row(age=5, name=&#39;Bob&#39;), Row(age=2, name=&#39;Alice&#39;)]\n    &gt;&gt;&gt; df.sort(&#34;age&#34;, ascending=False).collect()\n    [Row(age=5, name=&#39;Bob&#39;), Row(age=2, name=&#39;Alice&#39;)]\n    &gt;&gt;&gt; df.orderBy(df.age.desc()).collect()\n    [Row(age=5, name=&#39;Bob&#39;), Row(age=2, name=&#39;Alice&#39;)]\n    &gt;&gt;&gt; from pyspark.sql.functions import *\n    &gt;&gt;&gt; df.sort(asc(&#34;age&#34;)).collect()\n    [Row(age=2, name=&#39;Alice&#39;), Row(age=5, name=&#39;Bob&#39;)]\n    &gt;&gt;&gt; df.orderBy(desc(&#34;age&#34;), &#34;name&#34;).collect()\n    [Row(age=5, name=&#39;Bob&#39;), Row(age=2, name=&#39;Alice&#39;)]\n    &gt;&gt;&gt; df.orderBy([&#34;age&#34;, &#34;name&#34;], ascending=[0, 1]).collect()\n    [Row(age=5, name=&#39;Bob&#39;), Row(age=2, name=&#39;Alice&#39;)]\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641434336752,"submitTime":1641434336758,"finishTime":1641434336773,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"c427a379-2479-4d2b-a500-bb62707c02fc"},{"version":"CommandV1","origId":1575837098434648,"guid":"086ce068-31a5-47c1-a44f-ae19fa4312c1","subtype":"command","commandType":"auto","position":3.0,"command":"help(users_df.orderBy)","commandVersion":2,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Help on method sort in module pyspark.sql.dataframe:\n\nsort(*cols, **kwargs) method of pyspark.sql.dataframe.DataFrame instance\n    Returns a new :class:`DataFrame` sorted by the specified column(s).\n    \n    .. versionadded:: 1.3.0\n    \n    Parameters\n    ----------\n    cols : str, list, or :class:`Column`, optional\n         list of :class:`Column` or column names to sort by.\n    \n    Other Parameters\n    ----------------\n    ascending : bool or list, optional\n        boolean or list of boolean (default ``True``).\n        Sort ascending vs. descending. Specify list for multiple sort orders.\n        If a list is specified, length of the list must equal length of the `cols`.\n    \n    Examples\n    --------\n    &gt;&gt;&gt; df.sort(df.age.desc()).collect()\n    [Row(age=5, name=&#39;Bob&#39;), Row(age=2, name=&#39;Alice&#39;)]\n    &gt;&gt;&gt; df.sort(&#34;age&#34;, ascending=False).collect()\n    [Row(age=5, name=&#39;Bob&#39;), Row(age=2, name=&#39;Alice&#39;)]\n    &gt;&gt;&gt; df.orderBy(df.age.desc()).collect()\n    [Row(age=5, name=&#39;Bob&#39;), Row(age=2, name=&#39;Alice&#39;)]\n    &gt;&gt;&gt; from pyspark.sql.functions import *\n    &gt;&gt;&gt; df.sort(asc(&#34;age&#34;)).collect()\n    [Row(age=2, name=&#39;Alice&#39;), Row(age=5, name=&#39;Bob&#39;)]\n    &gt;&gt;&gt; df.orderBy(desc(&#34;age&#34;), &#34;name&#34;).collect()\n    [Row(age=5, name=&#39;Bob&#39;), Row(age=2, name=&#39;Alice&#39;)]\n    &gt;&gt;&gt; df.orderBy([&#34;age&#34;, &#34;name&#34;], ascending=[0, 1]).collect()\n    [Row(age=5, name=&#39;Bob&#39;), Row(age=2, name=&#39;Alice&#39;)]\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641434337314,"submitTime":1641434337331,"finishTime":1641434337334,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"38f3e58f-e541-4542-b54f-d5b72aeac7fd"},{"version":"CommandV1","origId":1575837098434649,"guid":"8b7c49ba-7090-4944-8c7b-3da4105334a2","subtype":"command","commandType":"auto","position":4.0,"command":"","commandVersion":0,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"119bd36c-0926-44f9-b987-ab8f07944d67"}],"dashboards":[],"guid":"9dd18389-85e7-4234-bd6d-e8d1f6af301d","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{"pythonIndentUnit":4}}