{"version":"NotebookV1","origId":1575837098434555,"name":"08 Prioritized Sorting of a Spark Data Frame","language":"python","commands":[{"version":"CommandV1","origId":1575837098434556,"guid":"b9d894c8-027b-40c4-80a2-a8a5851a1023","subtype":"command","commandType":"auto","position":1.0,"command":"courses = [{'course_id': 1,\n  'course_name': '2020 Complete Python Bootcamp: From Zero to Hero in Python',\n  'suitable_for': 'Beginner',\n  'enrollment': 1100093,\n  'stars': 4.6,\n  'number_of_ratings': 318066},\n {'course_id': 4,\n  'course_name': 'Angular - The Complete Guide (2020 Edition)',\n  'suitable_for': 'Intermediate',\n  'enrollment': 422557,\n  'stars': 4.6,\n  'number_of_ratings': 129984},\n {'course_id': 12,\n  'course_name': 'Automate the Boring Stuff with Python Programming',\n  'suitable_for': 'Advanced',\n  'enrollment': 692617,\n  'stars': 4.6,\n  'number_of_ratings': 70508},\n {'course_id': 10,\n  'course_name': 'Complete C# Unity Game Developer 2D',\n  'suitable_for': 'Advanced',\n  'enrollment': 364934,\n  'stars': 4.6,\n  'number_of_ratings': 78989},\n {'course_id': 5,\n  'course_name': 'Java Programming Masterclass for Software Developers',\n  'suitable_for': 'Advanced',\n  'enrollment': 502572,\n  'stars': 4.6,\n  'number_of_ratings': 123798},\n {'course_id': 15,\n  'course_name': 'Learn Python Programming Masterclass',\n  'suitable_for': 'Advanced',\n  'enrollment': 240790,\n  'stars': 4.5,\n  'number_of_ratings': 58677},\n {'course_id': 3,\n  'course_name': 'Machine Learning A-Zâ„¢: Hands-On Python & R In Data Science',\n  'suitable_for': 'Intermediate',\n  'enrollment': 692812,\n  'stars': 4.5,\n  'number_of_ratings': 132228},\n {'course_id': 14,\n  'course_name': 'Modern React with Redux [2020 Update]',\n  'suitable_for': 'Intermediate',\n  'enrollment': 203214,\n  'stars': 4.7,\n  'number_of_ratings': 60835},\n {'course_id': 8,\n  'course_name': 'Python for Data Science and Machine Learning Bootcamp',\n  'suitable_for': 'Intermediate',\n  'enrollment': 387789,\n  'stars': 4.6,\n  'number_of_ratings': 87403},\n {'course_id': 6,\n  'course_name': 'React - The Complete Guide (incl Hooks, React Router, Redux)',\n  'suitable_for': 'Intermediate',\n  'enrollment': 304670,\n  'stars': 4.6,\n  'number_of_ratings': 90964},\n {'course_id': 18,\n  'course_name': 'Selenium WebDriver with Java -Basics to Advanced+Frameworks',\n  'suitable_for': 'Advanced',\n  'enrollment': 148562,\n  'stars': 4.6,\n  'number_of_ratings': 49947},\n {'course_id': 21,\n  'course_name': 'Spring & Hibernate for Beginners (includes Spring Boot)',\n  'suitable_for': 'Advanced',\n  'enrollment': 177053,\n  'stars': 4.6,\n  'number_of_ratings': 45329},\n {'course_id': 7,\n  'course_name': 'The Complete 2020 Web Development Bootcamp',\n  'suitable_for': 'Beginner',\n  'enrollment': 270656,\n  'stars': 4.7,\n  'number_of_ratings': 88098},\n {'course_id': 9,\n  'course_name': 'The Complete JavaScript Course 2020: Build Real Projects!',\n  'suitable_for': 'Intermediate',\n  'enrollment': 347979,\n  'stars': 4.6,\n  'number_of_ratings': 83521},\n {'course_id': 16,\n  'course_name': 'The Complete Node.js Developer Course (3rd Edition)',\n  'suitable_for': 'Advanced',\n  'enrollment': 202922,\n  'stars': 4.7,\n  'number_of_ratings': 50885},\n {'course_id': 13,\n  'course_name': 'The Complete Web Developer Course 2.0',\n  'suitable_for': 'Intermediate',\n  'enrollment': 273598,\n  'stars': 4.5,\n  'number_of_ratings': 63175},\n {'course_id': 11,\n  'course_name': 'The Data Science Course 2020: Complete Data Science Bootcamp',\n  'suitable_for': 'Beginner',\n  'enrollment': 325047,\n  'stars': 4.5,\n  'number_of_ratings': 76907},\n {'course_id': 20,\n  'course_name': 'The Ultimate MySQL Bootcamp: Go from SQL Beginner to Expert',\n  'suitable_for': 'Beginner',\n  'enrollment': 203366,\n  'stars': 4.6,\n  'number_of_ratings': 45382},\n {'course_id': 2,\n  'course_name': 'The Web Developer Bootcamp',\n  'suitable_for': 'Beginner',\n  'enrollment': 596726,\n  'stars': 4.6,\n  'number_of_ratings': 182997},\n {'course_id': 19,\n  'course_name': 'Unreal Engine C++ Developer: Learn C++ and Make Video Games',\n  'suitable_for': 'Advanced',\n  'enrollment': 229005,\n  'stars': 4.5,\n  'number_of_ratings': 45860},\n {'course_id': 17,\n  'course_name': 'iOS 13 & Swift 5 - The Complete iOS App Development Bootcamp',\n  'suitable_for': 'Advanced',\n  'enrollment': 179598,\n  'stars': 4.8,\n  'number_of_ratings': 49972}]","commandVersion":2,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641443770094,"submitTime":1641443770064,"finishTime":1641443770122,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"e7c66a7b-1871-4386-9604-8f8ce8ac4ea2"},{"version":"CommandV1","origId":1575837098434557,"guid":"83d6c62f-f91d-497d-bdb3-19aa90248f0a","subtype":"command","commandType":"auto","position":2.0,"command":"from pyspark.sql import Row","commandVersion":5,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641443770885,"submitTime":1641443770858,"finishTime":1641443770908,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"4a72e36f-a6a7-4597-bc68-faaa883b9026"},{"version":"CommandV1","origId":1575837098434558,"guid":"a3bac04e-5f64-4d0f-b900-4b608bbb6ec1","subtype":"command","commandType":"auto","position":3.0,"command":"courses_df = spark.createDataFrame([Row(**course) for course in courses])","commandVersion":16,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"courses_df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"course_id","nullable":true,"type":"long"},{"metadata":{},"name":"course_name","nullable":true,"type":"string"},{"metadata":{},"name":"suitable_for","nullable":true,"type":"string"},{"metadata":{},"name":"enrollment","nullable":true,"type":"long"},{"metadata":{},"name":"stars","nullable":true,"type":"double"},{"metadata":{},"name":"number_of_ratings","nullable":true,"type":"long"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641443771815,"submitTime":1641443771792,"finishTime":1641443772154,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"c2690c46-cc42-46d8-bc8a-3a9e52e3ef3b"},{"version":"CommandV1","origId":1575837098434559,"guid":"71be05ec-6b72-4eb8-88a3-35f4ef170e05","subtype":"command","commandType":"auto","position":4.0,"command":"courses_df.show()","commandVersion":6,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+---------+--------------------+------------+----------+-----+-----------------+\n|course_id|         course_name|suitable_for|enrollment|stars|number_of_ratings|\n+---------+--------------------+------------+----------+-----+-----------------+\n|        1|2020 Complete Pyt...|    Beginner|   1100093|  4.6|           318066|\n|        4|Angular - The Com...|Intermediate|    422557|  4.6|           129984|\n|       12|Automate the Bori...|    Advanced|    692617|  4.6|            70508|\n|       10|Complete C# Unity...|    Advanced|    364934|  4.6|            78989|\n|        5|Java Programming ...|    Advanced|    502572|  4.6|           123798|\n|       15|Learn Python Prog...|    Advanced|    240790|  4.5|            58677|\n|        3|Machine Learning ...|Intermediate|    692812|  4.5|           132228|\n|       14|Modern React with...|Intermediate|    203214|  4.7|            60835|\n|        8|Python for Data S...|Intermediate|    387789|  4.6|            87403|\n|        6|React - The Compl...|Intermediate|    304670|  4.6|            90964|\n|       18|Selenium WebDrive...|    Advanced|    148562|  4.6|            49947|\n|       21|Spring &amp; Hibernat...|    Advanced|    177053|  4.6|            45329|\n|        7|The Complete 2020...|    Beginner|    270656|  4.7|            88098|\n|        9|The Complete Java...|Intermediate|    347979|  4.6|            83521|\n|       16|The Complete Node...|    Advanced|    202922|  4.7|            50885|\n|       13|The Complete Web ...|Intermediate|    273598|  4.5|            63175|\n|       11|The Data Science ...|    Beginner|    325047|  4.5|            76907|\n|       20|The Ultimate MySQ...|    Beginner|    203366|  4.6|            45382|\n|        2|The Web Developer...|    Beginner|    596726|  4.6|           182997|\n|       19|Unreal Engine C++...|    Advanced|    229005|  4.5|            45860|\n+---------+--------------------+------------+----------+-----+-----------------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641443774036,"submitTime":1641443774011,"finishTime":1641443774660,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"f15d8097-852d-4970-8d4b-ef792294885a"},{"version":"CommandV1","origId":1575837098434560,"guid":"1f5816a1-dd19-48e3-8858-6e8215c7a653","subtype":"command","commandType":"auto","position":5.0,"command":"%md\n\n* Make sure the data is sorted in custom order by level and then in numerically in descending order by number of ratings. \n* All the Beginner level courses should come first, followed by Intermediate level and then by Advanced level.","commandVersion":5,"state":"finished","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"bbf07544-e38b-45bb-87be-aebc5ee31a65"},{"version":"CommandV1","origId":1575837098434561,"guid":"94ef8f3b-000b-421a-9bdc-b0b7d2574cc9","subtype":"command","commandType":"auto","position":5.5,"command":"from pyspark.sql.functions import col, when","commandVersion":14,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641443878929,"submitTime":1641443878888,"finishTime":1641443878954,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"c938ebd7-f86a-4e2f-955a-f05cf1cee50d"},{"version":"CommandV1","origId":1575837098434562,"guid":"e600463f-8a14-47ad-a5af-c1c76dc5450b","subtype":"command","commandType":"auto","position":5.625,"command":"help(when)","commandVersion":2,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Help on function when in module pyspark.sql.functions:\n\nwhen(condition, value)\n    Evaluates a list of conditions and returns one of multiple possible result expressions.\n    If :func:`pyspark.sql.Column.otherwise` is not invoked, None is returned for unmatched\n    conditions.\n    \n    .. versionadded:: 1.4.0\n    \n    Parameters\n    ----------\n    condition : :class:`~pyspark.sql.Column`\n        a boolean :class:`~pyspark.sql.Column` expression.\n    value :\n        a literal value, or a :class:`~pyspark.sql.Column` expression.\n    \n    &gt;&gt;&gt; df.select(when(df[&#39;age&#39;] == 2, 3).otherwise(4).alias(&#34;age&#34;)).collect()\n    [Row(age=3), Row(age=4)]\n    \n    &gt;&gt;&gt; df.select(when(df.age == 2, df.age + 1).alias(&#34;age&#34;)).collect()\n    [Row(age=3), Row(age=None)]\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641443885388,"submitTime":1641443885362,"finishTime":1641443885414,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"33df7ca9-866c-41ad-abff-efc81ec7bd3c"},{"version":"CommandV1","origId":1575837098434563,"guid":"2b8a7e20-0129-47a7-8fce-693c6e6c26ec","subtype":"command","commandType":"auto","position":5.75,"command":"course_level = when(col('suitable_for') == 'Beginner', 0).otherwise(when(col('suitable_for') == 'Intermediate', 1).otherwise(2))","commandVersion":71,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641444411975,"submitTime":1641444411932,"finishTime":1641444412188,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"ddd75f32-1d16-43e8-9cf6-341f3845203a"},{"version":"CommandV1","origId":1575837098434564,"guid":"737c9182-7783-4c6e-b577-e30bfdd2fafa","subtype":"command","commandType":"auto","position":6.0,"command":"courses_df. \\\n    orderBy(course_level, col('number_of_ratings').desc()). \\\n    show()","commandVersion":21,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+---------+--------------------+------------+----------+-----+-----------------+\n|course_id|         course_name|suitable_for|enrollment|stars|number_of_ratings|\n+---------+--------------------+------------+----------+-----+-----------------+\n|        1|2020 Complete Pyt...|    Beginner|   1100093|  4.6|           318066|\n|        2|The Web Developer...|    Beginner|    596726|  4.6|           182997|\n|        7|The Complete 2020...|    Beginner|    270656|  4.7|            88098|\n|       11|The Data Science ...|    Beginner|    325047|  4.5|            76907|\n|       20|The Ultimate MySQ...|    Beginner|    203366|  4.6|            45382|\n|        3|Machine Learning ...|Intermediate|    692812|  4.5|           132228|\n|        4|Angular - The Com...|Intermediate|    422557|  4.6|           129984|\n|        6|React - The Compl...|Intermediate|    304670|  4.6|            90964|\n|        8|Python for Data S...|Intermediate|    387789|  4.6|            87403|\n|        9|The Complete Java...|Intermediate|    347979|  4.6|            83521|\n|       13|The Complete Web ...|Intermediate|    273598|  4.5|            63175|\n|       14|Modern React with...|Intermediate|    203214|  4.7|            60835|\n|        5|Java Programming ...|    Advanced|    502572|  4.6|           123798|\n|       10|Complete C# Unity...|    Advanced|    364934|  4.6|            78989|\n|       12|Automate the Bori...|    Advanced|    692617|  4.6|            70508|\n|       15|Learn Python Prog...|    Advanced|    240790|  4.5|            58677|\n|       16|The Complete Node...|    Advanced|    202922|  4.7|            50885|\n|       17|iOS 13 &amp; Swift 5 ...|    Advanced|    179598|  4.8|            49972|\n|       18|Selenium WebDrive...|    Advanced|    148562|  4.6|            49947|\n|       19|Unreal Engine C++...|    Advanced|    229005|  4.5|            45860|\n+---------+--------------------+------------+----------+-----+-----------------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641444415899,"submitTime":1641444415873,"finishTime":1641444417726,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"be80db5d-9c63-42e1-aa2f-4caa62a0d569"},{"version":"CommandV1","origId":1575837098434565,"guid":"a6f2cf07-3a85-49aa-a4b3-753341c21a6b","subtype":"command","commandType":"auto","position":6.5,"command":"# Using expr and then case and when\n\nfrom pyspark.sql.functions import expr\n\ncourse_level = expr(\"\"\"\n    CASE \n        WHEN suitable_for = 'Beginner'\n            THEN 0\n        WHEN suitable_for = 'Intermediate'\n            THEN 1\n        ELSE 2\n    END\n\"\"\")\n\ncourses_df. \\\n    sort(course_level, col('number_of_ratings').desc()). \\\n    show()","commandVersion":78,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+---------+--------------------+------------+----------+-----+-----------------+\n|course_id|         course_name|suitable_for|enrollment|stars|number_of_ratings|\n+---------+--------------------+------------+----------+-----+-----------------+\n|        1|2020 Complete Pyt...|    Beginner|   1100093|  4.6|           318066|\n|        2|The Web Developer...|    Beginner|    596726|  4.6|           182997|\n|        7|The Complete 2020...|    Beginner|    270656|  4.7|            88098|\n|       11|The Data Science ...|    Beginner|    325047|  4.5|            76907|\n|       20|The Ultimate MySQ...|    Beginner|    203366|  4.6|            45382|\n|        3|Machine Learning ...|Intermediate|    692812|  4.5|           132228|\n|        4|Angular - The Com...|Intermediate|    422557|  4.6|           129984|\n|        6|React - The Compl...|Intermediate|    304670|  4.6|            90964|\n|        8|Python for Data S...|Intermediate|    387789|  4.6|            87403|\n|        9|The Complete Java...|Intermediate|    347979|  4.6|            83521|\n|       13|The Complete Web ...|Intermediate|    273598|  4.5|            63175|\n|       14|Modern React with...|Intermediate|    203214|  4.7|            60835|\n|        5|Java Programming ...|    Advanced|    502572|  4.6|           123798|\n|       10|Complete C# Unity...|    Advanced|    364934|  4.6|            78989|\n|       12|Automate the Bori...|    Advanced|    692617|  4.6|            70508|\n|       15|Learn Python Prog...|    Advanced|    240790|  4.5|            58677|\n|       16|The Complete Node...|    Advanced|    202922|  4.7|            50885|\n|       17|iOS 13 &amp; Swift 5 ...|    Advanced|    179598|  4.8|            49972|\n|       18|Selenium WebDrive...|    Advanced|    148562|  4.6|            49947|\n|       19|Unreal Engine C++...|    Advanced|    229005|  4.5|            45860|\n+---------+--------------------+------------+----------+-----+-----------------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641444602059,"submitTime":1641444602015,"finishTime":1641444602400,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"a1cfee8c-7463-4535-8241-12a43fcb59b7"},{"version":"CommandV1","origId":1575837098434566,"guid":"eb1c890c-9d00-4e32-a479-2943b45451ff","subtype":"command","commandType":"auto","position":7.5,"command":"","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"c46159ad-e067-4d52-a99d-51b41fd9a40d"}],"dashboards":[],"guid":"a108a7be-4f07-40e6-b6da-1280790592e8","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{"pythonIndentUnit":4}}