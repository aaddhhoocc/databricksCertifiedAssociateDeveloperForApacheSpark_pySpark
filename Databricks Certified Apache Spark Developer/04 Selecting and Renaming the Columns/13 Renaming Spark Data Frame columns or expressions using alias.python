{"version":"NotebookV1","origId":1575837098434032,"name":"13 Renaming Spark Data Frame columns or expressions using alias","language":"python","commands":[{"version":"CommandV1","origId":1575837098434033,"guid":"6b2f6a1c-fcb2-4dec-a3f0-c894491f70aa","subtype":"command","commandType":"auto","position":1.0,"command":"%run \"./02 Creating Spark Data Frame to Select and Rename Columns\"","commandVersion":3,"state":"finished","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641261236132,"submitTime":1641261236132,"finishTime":1641261237319,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"51fb0113-3e28-457f-9f3c-e19761a923c7"},{"version":"CommandV1","origId":1575837098434034,"guid":"e67610ae-44bd-4dc6-b10d-53c428f3be6d","subtype":"script","commandType":"auto","position":1.1428571428571428,"command":"","commandVersion":8,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641261236184,"submitTime":0,"finishTime":1641261236212,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["6b2f6a1c-fcb2-4dec-a3f0-c894491f70aa"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"0660bd2b-1a22-45d9-bc0a-0310dd86cbc9"},{"version":"CommandV1","origId":1575837098434035,"guid":"6648c69b-9721-49cc-82b8-bdb80f2aaf7d","subtype":"command","commandType":"auto","position":1.25,"command":"%md\n\n* Rename `id` to `user_id`\n* Rename `first_name` to `user_first_name`\n* Rename `last_name` to `user_last_name`\n* Also add new column by name `user_full_name` which is derived by concatenating `first_name` and `last_name` with `, ` in between.","commandVersion":24,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"8870bee5-d017-4475-83fc-8f5749c67588"},{"version":"CommandV1","origId":1575837098434036,"guid":"f4821b1f-deef-48d1-81bb-7dcf80965bff","subtype":"script","commandType":"auto","position":1.2857142857142856,"command":"","commandVersion":302,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641261236219,"submitTime":0,"finishTime":1641261236239,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["6b2f6a1c-fcb2-4dec-a3f0-c894491f70aa"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"14b6a601-2c96-46ed-a857-cb5a9a477a4a"},{"version":"CommandV1","origId":1575837098434037,"guid":"f021bfc0-b0f1-40ba-9fc7-1bfe23e07ad5","subtype":"script","commandType":"auto","position":1.4285714285714286,"command":"","commandVersion":3,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641261236244,"submitTime":0,"finishTime":1641261236488,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["6b2f6a1c-fcb2-4dec-a3f0-c894491f70aa"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"1f68d5ea-bc7a-4174-a367-87dfd283c10f"},{"version":"CommandV1","origId":1575837098434038,"guid":"c446a398-9493-40d9-93fa-17234f139deb","subtype":"command","commandType":"auto","position":1.5,"command":"from pyspark.sql.functions import col, concat, lit","commandVersion":9,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641261325907,"submitTime":1641261325875,"finishTime":1641261325925,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"c9537ecb-cb05-469f-a6f7-cd25b02f3ae1"},{"version":"CommandV1","origId":1575837098434039,"guid":"649ba147-07cf-489c-b7be-fab913f33dd1","subtype":"script","commandType":"auto","position":1.5714285714285714,"command":"","commandVersion":10,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641261236493,"submitTime":0,"finishTime":1641261236510,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["6b2f6a1c-fcb2-4dec-a3f0-c894491f70aa"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"190d92f6-78dc-4067-a4d3-540ba3531fc1"},{"version":"CommandV1","origId":1575837098434040,"guid":"de0dee3a-3b24-4ebd-bae7-3c308a34edde","subtype":"script","commandType":"auto","position":1.7142857142857144,"command":"","commandVersion":7,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"users_df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"id","nullable":true,"type":"long"},{"metadata":{},"name":"first_name","nullable":true,"type":"string"},{"metadata":{},"name":"last_name","nullable":true,"type":"string"},{"metadata":{},"name":"email","nullable":true,"type":"string"},{"metadata":{},"name":"phone_numbers","nullable":true,"type":{"fields":[{"metadata":{},"name":"mobile","nullable":true,"type":"string"},{"metadata":{},"name":"home","nullable":true,"type":"string"}],"type":"struct"}},{"metadata":{},"name":"courses","nullable":true,"type":{"containsNull":true,"elementType":"long","type":"array"}},{"metadata":{},"name":"is_customer","nullable":true,"type":"boolean"},{"metadata":{},"name":"amount_paid","nullable":true,"type":"double"},{"metadata":{},"name":"customer_from","nullable":true,"type":"date"},{"metadata":{},"name":"last_updated_ts","nullable":true,"type":"timestamp"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641261236515,"submitTime":0,"finishTime":1641261236642,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["6b2f6a1c-fcb2-4dec-a3f0-c894491f70aa"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"38d702b0-28b4-4191-9c12-807fbd065102"},{"version":"CommandV1","origId":1575837098434041,"guid":"03f78dbc-a0b0-4eeb-a6a7-7bc2c613fdbf","subtype":"command","commandType":"auto","position":1.75,"command":"user_id = col('id')","commandVersion":4,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641261334813,"submitTime":1641261334781,"finishTime":1641261334841,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"0775878b-0047-46bd-bc18-2018025c309a"},{"version":"CommandV1","origId":1575837098434042,"guid":"544f77f1-b3bf-4282-b0c6-2ca5b1e95a06","subtype":"script","commandType":"auto","position":1.8571428571428572,"command":"","commandVersion":3,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+---+----------+------------+--------------------+--------------------+-------+-----------+-----------+-------------+-------------------+\n| id|first_name|   last_name|               email|       phone_numbers|courses|is_customer|amount_paid|customer_from|    last_updated_ts|\n+---+----------+------------+--------------------+--------------------+-------+-----------+-----------+-------------+-------------------+\n|  1|    Corrie|Van den Oord|cvandenoord0@etsy...|{+1 234 567 8901,...| [1, 2]|       true|    1000.55|   2021-01-15|2021-02-10 01:15:00|\n|  2|  Nikolaus|     Brewitt|nbrewitt1@dailyma...|{+1 234 567 8923,...|    [3]|       true|      900.0|   2021-02-14|2021-02-18 03:33:00|\n|  3|    Orelie|      Penney|openney2@vistapri...|{+1 714 512 9752,...| [2, 4]|       true|     850.55|   2021-01-21|2021-03-15 15:16:55|\n|  4|     Ashby|    Maddocks|  amaddocks3@home.pl|        {null, null}|     []|      false|        NaN|         null|2021-04-10 17:45:30|\n|  5|      Kurt|        Rome|krome4@shutterfly...|{+1 817 934 7142,...|     []|      false|        NaN|         null|2021-04-02 00:55:18|\n+---+----------+------------+--------------------+--------------------+-------+-----------+-----------+-------------+-------------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641261236648,"submitTime":0,"finishTime":1641261237302,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["6b2f6a1c-fcb2-4dec-a3f0-c894491f70aa"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"9d0fda49-18dd-445a-8068-9e5c8d94091e"},{"version":"CommandV1","origId":1575837098434043,"guid":"f50565fa-53e7-44f7-a96a-63e0dc27f84f","subtype":"command","commandType":"auto","position":1.875,"command":"help(user_id.alias)","commandVersion":3,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Help on method alias in module pyspark.sql.column:\n\nalias(*alias, **kwargs) method of pyspark.sql.column.Column instance\n    Returns this column aliased with a new name or names (in the case of expressions that\n    return more than one column, such as explode).\n    \n    .. versionadded:: 1.3.0\n    \n    Parameters\n    ----------\n    alias : str\n        desired column names (collects all positional arguments passed)\n    \n    Other Parameters\n    ----------------\n    metadata: dict\n        a dict of information to be stored in ``metadata`` attribute of the\n        corresponding :class:`StructField &lt;pyspark.sql.types.StructField&gt;` (optional, keyword\n        only argument)\n    \n        .. versionchanged:: 2.2.0\n           Added optional ``metadata`` argument.\n    \n    Examples\n    --------\n    &gt;&gt;&gt; df.select(df.age.alias(&#34;age2&#34;)).collect()\n    [Row(age2=2), Row(age2=5)]\n    &gt;&gt;&gt; df.select(df.age.alias(&#34;age3&#34;, metadata={&#39;max&#39;: 99})).schema[&#39;age3&#39;].metadata[&#39;max&#39;]\n    99\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641261347012,"submitTime":1641261346980,"finishTime":1641261347042,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"e12f1bdc-701a-4092-a266-d6b3a88e9ca8"},{"version":"CommandV1","origId":1575837098434044,"guid":"f9239aec-c59f-4739-8119-15746e41b98f","subtype":"command","commandType":"auto","position":1.9375,"command":"# Using select\nusers_df. \\\n    select(\n        col('id').alias('user_id'),\n        col('first_name').alias('user_first_name'),\n        col('last_name').alias('user_last_name'),\n        concat(col('first_name'), lit(', '), col('last_name')).alias('user_full_name')\n    ). \\\n    show()","commandVersion":65,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+-------+---------------+--------------+--------------------+\n|user_id|user_first_name|user_last_name|      user_full_name|\n+-------+---------------+--------------+--------------------+\n|      1|         Corrie|  Van den Oord|Corrie, Van den Oord|\n|      2|       Nikolaus|       Brewitt|   Nikolaus, Brewitt|\n|      3|         Orelie|        Penney|      Orelie, Penney|\n|      4|          Ashby|      Maddocks|     Ashby, Maddocks|\n|      5|           Kurt|          Rome|          Kurt, Rome|\n+-------+---------------+--------------+--------------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641261622572,"submitTime":1641261622513,"finishTime":1641261623069,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"01f1a863-5f24-47ff-b4a0-cb7895dceb2c"},{"version":"CommandV1","origId":1575837098434045,"guid":"f994ea55-3c21-4306-a4e9-0070d9e93c9f","subtype":"command","commandType":"auto","position":2.21875,"command":"users_df. \\\n    select(\n        users_df['id'].alias('user_id'),\n        users_df['first_name'].alias('user_first_name'),\n        users_df['last_name'].alias('user_last_name'),\n        concat(users_df['first_name'], lit(', '), users_df['last_name']).alias('user_full_name')\n    ). \\\n    show()","commandVersion":21,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+-------+---------------+--------------+--------------------+\n|user_id|user_first_name|user_last_name|      user_full_name|\n+-------+---------------+--------------+--------------------+\n|      1|         Corrie|  Van den Oord|Corrie, Van den Oord|\n|      2|       Nikolaus|       Brewitt|   Nikolaus, Brewitt|\n|      3|         Orelie|        Penney|      Orelie, Penney|\n|      4|          Ashby|      Maddocks|     Ashby, Maddocks|\n|      5|           Kurt|          Rome|          Kurt, Rome|\n+-------+---------------+--------------+--------------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641261703757,"submitTime":1641261703709,"finishTime":1641261704005,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"62963e9a-ce99-4159-8871-9007be76330f"},{"version":"CommandV1","origId":1575837098434046,"guid":"5455cd57-250b-48b4-b723-839bb334625c","subtype":"command","commandType":"auto","position":2.5,"command":"# Using withColumn and alias (first select and then withColumn)\nusers_df. \\\n    select(\n        users_df['id'].alias('user_id'),\n        users_df['first_name'].alias('user_first_name'),\n        users_df['last_name'].alias('user_last_name')\n    ). \\\n    withColumn('user_full_name', concat(col('user_first_name'), lit(', '), col('user_last_name'))). \\\n    show()","commandVersion":62,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+-------+---------------+--------------+--------------------+\n|user_id|user_first_name|user_last_name|      user_full_name|\n+-------+---------------+--------------+--------------------+\n|      1|         Corrie|  Van den Oord|Corrie, Van den Oord|\n|      2|       Nikolaus|       Brewitt|   Nikolaus, Brewitt|\n|      3|         Orelie|        Penney|      Orelie, Penney|\n|      4|          Ashby|      Maddocks|     Ashby, Maddocks|\n|      5|           Kurt|          Rome|          Kurt, Rome|\n+-------+---------------+--------------+--------------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641262096776,"submitTime":1641262096726,"finishTime":1641262097241,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"1551fce3-2ad6-462e-a09e-a54b6d3a3eea"},{"version":"CommandV1","origId":1575837098434047,"guid":"5391693d-a1dc-4bfb-85d3-98e26c01f8bf","subtype":"command","commandType":"auto","position":3.0,"command":"# Using withColumn and alias (first withColumn and then select)\nusers_df. \\\n    withColumn('user_full_name', concat(col('first_name'), lit(', '), col('last_name'))). \\\n    select(\n        users_df['id'].alias('user_id'),\n        users_df['first_name'].alias('user_first_name'),\n        users_df['last_name'].alias('user_last_name'),\n        'user_full_name'\n    ). \\\n    show()","commandVersion":69,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+-------+---------------+--------------+--------------------+\n|user_id|user_first_name|user_last_name|      user_full_name|\n+-------+---------------+--------------+--------------------+\n|      1|         Corrie|  Van den Oord|Corrie, Van den Oord|\n|      2|       Nikolaus|       Brewitt|   Nikolaus, Brewitt|\n|      3|         Orelie|        Penney|      Orelie, Penney|\n|      4|          Ashby|      Maddocks|     Ashby, Maddocks|\n|      5|           Kurt|          Rome|          Kurt, Rome|\n+-------+---------------+--------------+--------------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641262143251,"submitTime":1641262143215,"finishTime":1641262143538,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"5ca1167b-380d-4e4c-9063-4a7dbfb734f5"},{"version":"CommandV1","origId":1575837098434048,"guid":"7db74d42-dbab-481a-9f4f-196e9bec7c84","subtype":"command","commandType":"auto","position":4.0,"command":"users_df. \\\n    withColumn('user_full_name', concat(users_df['first_name'], lit(', '), users_df['last_name'])). \\\n    select(\n        users_df['id'].alias('user_id'),\n        users_df['first_name'].alias('user_first_name'),\n        users_df['last_name'].alias('user_last_name'),\n        'user_full_name'\n    ). \\\n    show()","commandVersion":7,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+-------+---------------+--------------+--------------------+\n|user_id|user_first_name|user_last_name|      user_full_name|\n+-------+---------------+--------------+--------------------+\n|      1|         Corrie|  Van den Oord|Corrie, Van den Oord|\n|      2|       Nikolaus|       Brewitt|   Nikolaus, Brewitt|\n|      3|         Orelie|        Penney|      Orelie, Penney|\n|      4|          Ashby|      Maddocks|     Ashby, Maddocks|\n|      5|           Kurt|          Rome|          Kurt, Rome|\n+-------+---------------+--------------+--------------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641262174852,"submitTime":1641262174818,"finishTime":1641262175103,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"80c4bcf6-cad6-42d5-b8df-aac2ed23c158"},{"version":"CommandV1","origId":1575837098434049,"guid":"f66a31fc-1e71-4c82-b1f0-7e79d807962c","subtype":"command","commandType":"auto","position":5.0,"command":"","commandVersion":0,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"46d2e96e-e280-4be0-b5a2-8a938004cdb3"}],"dashboards":[],"guid":"520ec3de-a633-47d5-b26d-c23d56d2eaf3","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{"pythonIndentUnit":4}}