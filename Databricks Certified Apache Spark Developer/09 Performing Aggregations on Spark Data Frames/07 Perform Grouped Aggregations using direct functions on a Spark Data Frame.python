{"version":"NotebookV1","origId":1575837098435597,"name":"07 Perform Grouped Aggregations using direct functions on a Spark Data Frame","language":"python","commands":[{"version":"CommandV1","origId":1575837098435598,"guid":"eced7a20-43bd-4c19-999f-1f51cfe44b81","subtype":"command","commandType":"auto","position":1.0,"command":"order_items = spark.read.json('/public/retail_db_json/order_items')","commandVersion":14,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"order_items","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"order_item_id","nullable":true,"type":"long"},{"metadata":{},"name":"order_item_order_id","nullable":true,"type":"long"},{"metadata":{},"name":"order_item_product_id","nullable":true,"type":"long"},{"metadata":{},"name":"order_item_product_price","nullable":true,"type":"double"},{"metadata":{},"name":"order_item_quantity","nullable":true,"type":"long"},{"metadata":{},"name":"order_item_subtotal","nullable":true,"type":"double"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641487853501,"submitTime":1641487853468,"finishTime":1641487854772,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"b8a7ed41-932a-4e29-8381-de8bffaad82c"},{"version":"CommandV1","origId":1575837098435599,"guid":"e17e1bc5-6ccc-4c49-b253-68f8b2f35d41","subtype":"command","commandType":"auto","position":6.0,"command":"order_items_grouped = order_items. \\\n    groupBy('order_item_order_id')","commandVersion":18,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641487940104,"submitTime":1641487940070,"finishTime":1641487940135,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"29a483c7-3adc-4417-9e92-8773374c3a9c"},{"version":"CommandV1","origId":1575837098435600,"guid":"f79638a6-d07e-48df-9867-1a3c6f9bac06","subtype":"command","commandType":"auto","position":6.5,"command":"type(order_items_grouped)","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Out[3]: pyspark.sql.group.GroupedData</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641487863078,"submitTime":1641487863050,"finishTime":1641487863104,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"fe1f23da-48cb-4323-986c-2fdc7d356f9b"},{"version":"CommandV1","origId":1575837098435601,"guid":"bece43ea-aa37-4492-9d5b-7533741b2ba3","subtype":"command","commandType":"auto","position":7.0,"command":"order_items_grouped. \\\n    count(). \\\n    show()","commandVersion":10,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+-------------------+-----+\n|order_item_order_id|count|\n+-------------------+-----+\n|                 29|    5|\n|                474|    5|\n|                964|    4|\n|               1677|    5|\n|               1806|    3|\n|               1950|    5|\n|               2214|    2|\n|               2250|    4|\n|               2453|    4|\n|               2509|    4|\n|               2529|    1|\n|               2927|    5|\n|               3091|    3|\n|               3764|    1|\n|               4590|    5|\n|               4894|    4|\n|               5385|    4|\n|               5409|    3|\n|               6721|    2|\n|               7225|    4|\n+-------------------+-----+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641487978414,"submitTime":1641487978385,"finishTime":1641487981057,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"29c9c0e8-8c24-43c4-a57a-297051a99c59"},{"version":"CommandV1","origId":1575837098435602,"guid":"81256329-ed29-4843-b691-a7f3d3433b25","subtype":"command","commandType":"auto","position":7.5,"command":"order_items_grouped. \\\n    count(). \\\n    withColumnRenamed('count', 'order_count'). \\\n    show()","commandVersion":12,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+-------------------+-----------+\n|order_item_order_id|order_count|\n+-------------------+-----------+\n|                 29|          5|\n|                474|          5|\n|                964|          4|\n|               1677|          5|\n|               1806|          3|\n|               1950|          5|\n|               2214|          2|\n|               2250|          4|\n|               2453|          4|\n|               2509|          4|\n|               2529|          1|\n|               2927|          5|\n|               3091|          3|\n|               3764|          1|\n|               4590|          5|\n|               4894|          4|\n|               5385|          4|\n|               5409|          3|\n|               6721|          2|\n|               7225|          4|\n+-------------------+-----------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641488026443,"submitTime":1641488026413,"finishTime":1641488028777,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"f2f70d33-3ab3-4d92-b1a6-123f593a60ae"},{"version":"CommandV1","origId":1575837098435603,"guid":"6bfbccf0-b066-419c-a1f1-158f0bdcd79e","subtype":"command","commandType":"auto","position":7.75,"command":"order_items.dtypes","commandVersion":3,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Out[8]: [(&#39;order_item_id&#39;, &#39;bigint&#39;),\n (&#39;order_item_order_id&#39;, &#39;bigint&#39;),\n (&#39;order_item_product_id&#39;, &#39;bigint&#39;),\n (&#39;order_item_product_price&#39;, &#39;double&#39;),\n (&#39;order_item_quantity&#39;, &#39;bigint&#39;),\n (&#39;order_item_subtotal&#39;, &#39;double&#39;)]</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641488073777,"submitTime":1641488073747,"finishTime":1641488073806,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"7bd64582-d6af-4376-95d3-4eec79e92992"},{"version":"CommandV1","origId":1575837098435604,"guid":"185a917a-8350-45b5-ba3a-0962d367fbda","subtype":"command","commandType":"auto","position":8.0,"command":"# Get sum of all numeric fields\norder_items_grouped. \\\n    sum(). \\\n    show()","commandVersion":12,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+-------------------+------------------+------------------------+--------------------------+-----------------------------+------------------------+------------------------+\n|order_item_order_id|sum(order_item_id)|sum(order_item_order_id)|sum(order_item_product_id)|sum(order_item_product_price)|sum(order_item_quantity)|sum(order_item_subtotal)|\n+-------------------+------------------+------------------------+--------------------------+-----------------------------+------------------------+------------------------+\n|                 29|               425|                     145|                      3897|            909.9300000000001|                       9|                 1109.85|\n|                474|              5815|                    2370|                      4508|           374.94000000000005|                      13|       774.8199999999999|\n|                964|              9586|                    3856|                      2964|           499.95000000000005|                      11|       739.8800000000001|\n|               1677|             20860|                    8385|                      2357|                       277.97|                      14|       649.9200000000001|\n|               1806|             13545|                    5418|                      1871|                       509.97|                       8|                  789.94|\n|               1950|             24425|                    9750|                      4180|                       733.94|                      12|      1015.8700000000001|\n|               2214|             11099|                    4428|                       693|                       149.99|                       5|                  449.96|\n|               2250|             22534|                    9000|                      2236|                       569.96|                      10|                  889.94|\n|               2453|             24530|                    9812|                      2607|                       749.95|                       7|       999.9300000000001|\n|               2509|             25090|                   10036|                      2729|                       889.94|                       4|                  889.94|\n|               2529|              6330|                    2529|                       365|                        59.99|                       1|                   59.99|\n|               2927|             36510|                   14635|                      3833|                       819.94|                       8|       999.9100000000001|\n|               3091|             23079|                    9273|                      2598|           389.95000000000005|                       5|      469.93000000000006|\n|               3764|              9358|                    3764|                       822|                        47.99|                       2|                   95.98|\n|               4590|             57515|                   22950|                      3725|            649.9300000000001|                      11|                  949.83|\n|               4894|             49026|                   19576|                      3178|                       899.94|                       4|                  899.94|\n|               5385|             53730|                   21540|                      2347|                       309.96|                      10|                  629.86|\n|               5409|             40482|                   16227|                      1513|           459.96000000000004|                       7|       699.9200000000001|\n|               6721|             33587|                   13442|                      1129|            89.99000000000001|                       3|                  139.99|\n|               7225|             72338|                   28900|                      3221|           434.94000000000005|                      11|                  774.86|\n+-------------------+------------------+------------------------+--------------------------+-----------------------------+------------------------+------------------------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641488056946,"submitTime":1641488056918,"finishTime":1641488058690,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"7137cea5-ce2f-4773-add5-a348b95852c7"},{"version":"CommandV1","origId":1575837098435605,"guid":"2cdc1add-e73c-4b5b-9786-98eb623c150d","subtype":"command","commandType":"auto","position":8.25,"command":"orders = spark.read.json('/public/retail_db_json/orders')","commandVersion":2,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"orders","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"order_customer_id","nullable":true,"type":"long"},{"metadata":{},"name":"order_date","nullable":true,"type":"string"},{"metadata":{},"name":"order_id","nullable":true,"type":"long"},{"metadata":{},"name":"order_status","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641488186826,"submitTime":1641488186782,"finishTime":1641488187627,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"48e15638-2dca-4c03-8ba4-948e6c3d4aeb"},{"version":"CommandV1","origId":1575837098435606,"guid":"8a6d7b6a-56b6-4c1e-b926-a443d6c1fc15","subtype":"command","commandType":"auto","position":8.375,"command":"orders.printSchema()","commandVersion":4,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">root\n |-- order_customer_id: long (nullable = true)\n |-- order_date: string (nullable = true)\n |-- order_id: long (nullable = true)\n |-- order_status: string (nullable = true)\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641488193706,"submitTime":1641488193673,"finishTime":1641488193724,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"0116d5d9-b2f4-49b9-b436-fb5819688314"},{"version":"CommandV1","origId":1575837098435607,"guid":"b1916928-b4ee-49fd-8db7-2779edcb118f","subtype":"command","commandType":"auto","position":8.5,"command":"# Get sum of all numeric fields\n# Ignored order_date and order_status as they are not numeric fields\norders. \\\n    groupBy('order_date'). \\\n    sum(). \\\n    show()","commandVersion":32,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+--------------------+----------------------+-------------+\n|          order_date|sum(order_customer_id)|sum(order_id)|\n+--------------------+----------------------+-------------+\n|2013-08-13 00:00:...|                459650|       916059|\n|2013-10-12 00:00:...|               1002372|      3370470|\n|2013-11-15 00:00:...|                820656|      3349122|\n|2014-03-19 00:00:...|                816861|      5940291|\n|2013-09-16 00:00:...|                795738|      3418732|\n|2013-09-20 00:00:...|                851705|      2247287|\n|2013-12-31 00:00:...|               1619361|      7838750|\n|2013-09-06 00:00:...|               1692297|      4111583|\n|2013-12-24 00:00:...|               1089616|      4918816|\n|2014-01-07 00:00:...|               1017046|      4765725|\n|2013-10-14 00:00:...|                874047|      3535766|\n|2013-11-11 00:00:...|               1596396|      5423151|\n|2014-01-27 00:00:...|               1040337|      6149370|\n|2014-01-29 00:00:...|                976249|      6369973|\n|2014-02-14 00:00:...|               1095116|      7038749|\n|2013-09-07 00:00:...|               1320314|      3294089|\n|2013-09-11 00:00:...|                713835|      2236844|\n|2013-10-20 00:00:...|                918923|      2944067|\n|2014-01-09 00:00:...|               1323522|      6998168|\n|2014-03-03 00:00:...|               1570664|     10486819|\n+--------------------+----------------------+-------------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641488216974,"submitTime":1641488216941,"finishTime":1641488218192,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"10749756-037c-494a-8378-9f9499b1b5cd"},{"version":"CommandV1","origId":1575837098435608,"guid":"0eb382de-95e4-4038-bd07-70aa299b9932","subtype":"command","commandType":"auto","position":9.0,"command":"order_items_grouped = order_items. \\\n    select('order_item_order_id', 'order_item_quantity', 'order_item_subtotal'). \\\n    groupBy('order_item_order_id')","commandVersion":16,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641488385199,"submitTime":1641488385157,"finishTime":1641488385253,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"c1ab2c37-ab6b-4bc4-965c-7de6e8561f6c"},{"version":"CommandV1","origId":1575837098435609,"guid":"d2b753f7-3bb9-4a85-bfe7-c67b709af92a","subtype":"command","commandType":"auto","position":9.5,"command":"help(order_items_grouped.sum)","commandVersion":4,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Help on method sum in module pyspark.sql.group:\n\nsum(*cols) method of pyspark.sql.group.GroupedData instance\n    Computes the sum for each numeric columns for each group.\n    \n    .. versionadded:: 1.3.0\n    \n    Parameters\n    ----------\n    cols : str\n        column names. Non-numeric columns are ignored.\n    \n    Examples\n    --------\n    &gt;&gt;&gt; df.groupBy().sum(&#39;age&#39;).collect()\n    [Row(sum(age)=7)]\n    &gt;&gt;&gt; df3.groupBy().sum(&#39;age&#39;, &#39;height&#39;).collect()\n    [Row(sum(age)=7, sum(height)=165)]\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641488390456,"submitTime":1641488390422,"finishTime":1641488390479,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"686a5d77-e72c-4e79-8aad-d8720198c0c0"},{"version":"CommandV1","origId":1575837098435610,"guid":"2ae65b95-4e4b-4055-8244-75a505fb38fe","subtype":"command","commandType":"auto","position":10.0,"command":"# Gets sum on order_item_order_id as well\n# It is not relevant and better to discard aggregation on key fields such as order_item_order_id\norder_items_grouped. \\\n    sum(). \\\n    show()","commandVersion":32,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+-------------------+------------------------+------------------------+------------------------+\n|order_item_order_id|sum(order_item_order_id)|sum(order_item_quantity)|sum(order_item_subtotal)|\n+-------------------+------------------------+------------------------+------------------------+\n|                 29|                     145|                       9|                 1109.85|\n|                474|                    2370|                      13|       774.8199999999999|\n|                964|                    3856|                      11|       739.8800000000001|\n|               1677|                    8385|                      14|       649.9200000000001|\n|               1806|                    5418|                       8|                  789.94|\n|               1950|                    9750|                      12|      1015.8700000000001|\n|               2214|                    4428|                       5|                  449.96|\n|               2250|                    9000|                      10|                  889.94|\n|               2453|                    9812|                       7|       999.9300000000001|\n|               2509|                   10036|                       4|                  889.94|\n|               2529|                    2529|                       1|                   59.99|\n|               2927|                   14635|                       8|       999.9100000000001|\n|               3091|                    9273|                       5|      469.93000000000006|\n|               3764|                    3764|                       2|                   95.98|\n|               4590|                   22950|                      11|                  949.83|\n|               4894|                   19576|                       4|                  899.94|\n|               5385|                   21540|                      10|                  629.86|\n|               5409|                   16227|                       7|       699.9200000000001|\n|               6721|                   13442|                       3|                  139.99|\n|               7225|                   28900|                      11|                  774.86|\n+-------------------+------------------------+------------------------+------------------------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641488495127,"submitTime":1641488495084,"finishTime":1641488496547,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"ee7add64-2ca5-4ded-a4da-3bee4a032061"},{"version":"CommandV1","origId":1575837098435611,"guid":"5c3b1c6c-c7a9-46b3-84b4-c6e1577554b5","subtype":"command","commandType":"auto","position":11.0,"command":"# Consider only order_item_quantity and order_item_subtotal\norder_items_grouped. \\\n    sum('order_item_quantity', 'order_item_subtotal'). \\\n    show()","commandVersion":21,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+-------------------+------------------------+------------------------+\n|order_item_order_id|sum(order_item_quantity)|sum(order_item_subtotal)|\n+-------------------+------------------------+------------------------+\n|                 29|                       9|                 1109.85|\n|                474|                      13|       774.8199999999999|\n|                964|                      11|       739.8800000000001|\n|               1677|                      14|       649.9200000000001|\n|               1806|                       8|                  789.94|\n|               1950|                      12|      1015.8700000000001|\n|               2214|                       5|                  449.96|\n|               2250|                      10|                  889.94|\n|               2453|                       7|       999.9300000000001|\n|               2509|                       4|                  889.94|\n|               2529|                       1|                   59.99|\n|               2927|                       8|       999.9100000000001|\n|               3091|                       5|      469.93000000000006|\n|               3764|                       2|                   95.98|\n|               4590|                      11|                  949.83|\n|               4894|                       4|                  899.94|\n|               5385|                      10|                  629.86|\n|               5409|                       7|       699.9200000000001|\n|               6721|                       3|                  139.99|\n|               7225|                      11|                  774.86|\n+-------------------+------------------------+------------------------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641488539228,"submitTime":1641488539201,"finishTime":1641488540647,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"3186b5c7-07d5-458f-a9d2-788669e564f5"},{"version":"CommandV1","origId":1575837098435612,"guid":"809c74ee-d8b2-437e-897d-3bdbd52b3290","subtype":"command","commandType":"auto","position":12.0,"command":"order_items_grouped. \\\n    sum('order_item_quantity', 'order_item_subtotal'). \\\n    printSchema()","commandVersion":7,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">root\n |-- order_item_order_id: long (nullable = true)\n |-- sum(order_item_quantity): long (nullable = true)\n |-- sum(order_item_subtotal): double (nullable = true)\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641488627522,"submitTime":1641488627480,"finishTime":1641488627553,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"97edc74d-7ef8-4306-b7d2-7ceb1c031b89"},{"version":"CommandV1","origId":1575837098435613,"guid":"b5b33468-14ee-49e3-97ad-52a487edadac","subtype":"command","commandType":"auto","position":12.125,"command":"order_items_grouped. \\\n    sum('order_item_quantity', 'order_item_subtotal'). \\\n    toDF('order_item_order_id', 'order_quantity', 'order_revenue'). \\\n    printSchema()","commandVersion":6,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">root\n |-- order_item_order_id: long (nullable = true)\n |-- order_quantity: long (nullable = true)\n |-- order_revenue: double (nullable = true)\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641488872272,"submitTime":1641488872232,"finishTime":1641488872310,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"9315102d-e8ee-4a1d-9c31-d798fbdb6277"},{"version":"CommandV1","origId":1575837098435614,"guid":"11d046a2-6cd4-4363-9cb0-1dfbc7769407","subtype":"command","commandType":"auto","position":12.25,"command":"from pyspark.sql.functions import round","commandVersion":7,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641489042828,"submitTime":1641489042803,"finishTime":1641489042854,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"a8d69449-22e8-4fe4-9484-dad100beedb5"},{"version":"CommandV1","origId":1575837098435615,"guid":"9a52bda1-666f-44fc-b3ff-3d98cf785cfe","subtype":"command","commandType":"auto","position":13.5,"command":"# We can specify custom names to derived fields using toDF\n# withColumn can be used to apply functions such as round on aggregated results\norder_items_grouped. \\\n    sum('order_item_quantity', 'order_item_subtotal'). \\\n    toDF('order_item_order_id', 'order_quantity', 'order_revenue'). \\\n    withColumn('order_revenue', round('order_revenue', 2)). \\\n    show()","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+-------------------+--------------+-------------+\n|order_item_order_id|order_quantity|order_revenue|\n+-------------------+--------------+-------------+\n|                 29|             9|      1109.85|\n|                474|            13|       774.82|\n|                964|            11|       739.88|\n|               1677|            14|       649.92|\n|               1806|             8|       789.94|\n|               1950|            12|      1015.87|\n|               2214|             5|       449.96|\n|               2250|            10|       889.94|\n|               2453|             7|       999.93|\n|               2509|             4|       889.94|\n|               2529|             1|        59.99|\n|               2927|             8|       999.91|\n|               3091|             5|       469.93|\n|               3764|             2|        95.98|\n|               4590|            11|       949.83|\n|               4894|             4|       899.94|\n|               5385|            10|       629.86|\n|               5409|             7|       699.92|\n|               6721|             3|       139.99|\n|               7225|            11|       774.86|\n+-------------------+--------------+-------------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641489046778,"submitTime":1641489046756,"finishTime":1641489048096,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"6a569ea3-7182-4279-b077-c15b3c6540f6"},{"version":"CommandV1","origId":1575837098435616,"guid":"ad73ef1e-4797-476d-85f9-83c973872ae1","subtype":"command","commandType":"auto","position":14.5,"command":"","commandVersion":0,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"ea708ed7-4457-4dae-b080-386cc725a4dc"}],"dashboards":[],"guid":"831395b6-f65c-4ac2-ad8f-303088a2d408","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{"pythonIndentUnit":4}}