{"version":"NotebookV1","origId":1575837098435185,"name":"08 Extracting Strings using substring","language":"python","commands":[{"version":"CommandV1","origId":1575837098435186,"guid":"252e3370-a2db-4e71-84fa-5928861ca93e","subtype":"command","commandType":"auto","position":1.0,"command":"%md\n## Extracting Strings using substring\nLet us understand how to extract strings from main string using `substring` function in Pyspark.","commandVersion":1,"state":"finished","results":{"type":"raw","data":"","arguments":{},"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"b02ccdc4-97e1-4ced-9c39-4466dc95b35d"},{"version":"CommandV1","origId":1575837098435187,"guid":"f966cb6e-873f-433c-882c-16037fc6c16a","subtype":"command","commandType":"auto","position":3.0,"command":"%md\n* If we are processing **fixed length columns** then we use `substring` to extract the information.\n* Here are some of the examples for **fixed length columns** and the use cases for which we typically extract information..\n* 9 Digit Social Security Number. We typically extract last 4 digits and provide it to the tele verification applications..\n* 16 Digit Credit Card Number. We typically use first 4 digit number to identify Credit Card Provider and last 4 digits for the purpose of tele verification.\n* Data coming from MainFrames systems are quite often fixed length. We might have to extract the information and store in multiple columns.\n* `substring` function takes 3 arguments, **column**, **position**, **length**. We can also provide position from the end by passing negative value.","commandVersion":1,"state":"finished","results":{"type":"raw","data":"","arguments":{},"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"43f4e549-2f01-4671-8c65-ad5236acd823"},{"version":"CommandV1","origId":1575837098435188,"guid":"00de71bf-e0dc-4160-a5ce-f1b45ace01f9","subtype":"command","commandType":"auto","position":7.0,"command":"%md\n* Here is how we typically take care of getting substring from the main string using Python. We pass index and length to extract the substring.","commandVersion":1,"state":"finished","results":{"type":"raw","data":"","arguments":{},"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"bc8ded03-235d-47aa-b51a-5b5f335bbbc8"},{"version":"CommandV1","origId":1575837098435189,"guid":"7b3eb782-a6be-4cf8-a468-3453a7d823ec","subtype":"command","commandType":"auto","position":8.0,"command":"s = \"Hello World\"","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641159858131,"submitTime":1641159856674,"finishTime":1641159858157,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"2e75c182-7191-45af-947c-ae35929f968d"},{"version":"CommandV1","origId":1575837098435190,"guid":"ce78c6be-638e-44bd-932d-5256939fa014","subtype":"command","commandType":"auto","position":9.0,"command":"# Extracts first 5 characters from the string\ns[:5]","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Out[2]: &#39;Hello&#39;</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641159858165,"submitTime":1641159857404,"finishTime":1641159858184,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"48e96ab4-022f-4531-8859-a7f42de1225c"},{"version":"CommandV1","origId":1575837098435191,"guid":"a5c533af-75fc-4231-acee-826611d58dc5","subtype":"command","commandType":"auto","position":10.0,"command":"# Extracts characters from 2nd to 4th (3 characters). \n# Second argument is length of the string that need to be considered.\ns[1:4]","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Out[3]: &#39;ell&#39;</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641159858191,"submitTime":1641159857722,"finishTime":1641159858212,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"b0264286-f7c4-4dbb-b83b-e43cf08bfa9b"},{"version":"CommandV1","origId":1575837098435192,"guid":"d7447009-04a4-4a35-adca-c768a3777154","subtype":"command","commandType":"auto","position":11.0,"command":"l = [('X', )]","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641159858220,"submitTime":1641159858043,"finishTime":1641159858237,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"4cd324b7-3a10-471f-b9a2-222ced11e8a1"},{"version":"CommandV1","origId":1575837098435193,"guid":"f1c0dad8-2778-499f-a603-bfa04af4d371","subtype":"command","commandType":"auto","position":12.0,"command":"df = spark.createDataFrame(l, \"dummy STRING\")","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"dummy","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641159858426,"submitTime":1641159858408,"finishTime":1641159858766,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"f85de080-adb5-4ef6-bfb2-b1c4ff37d971"},{"version":"CommandV1","origId":1575837098435194,"guid":"77de0c0b-d5e0-4dc9-84e5-7af08708795a","subtype":"command","commandType":"auto","position":13.0,"command":"%md\n* We can use `substring` function to extract substring from main string using Pyspark.","commandVersion":1,"state":"finished","results":{"type":"raw","data":"","arguments":{},"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"52f932b1-f027-4f4e-ba03-f05e74e71c9e"},{"version":"CommandV1","origId":1575837098435195,"guid":"8c06dea8-56bd-423b-84b0-5de0e6408d9d","subtype":"command","commandType":"auto","position":14.0,"command":"from pyspark.sql.functions import substring, lit","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641159858841,"submitTime":1641159858823,"finishTime":1641159858861,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":{"pycharm":{"name":"#%%\n"}},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"45667a7b-5b4c-44fb-b6c6-868c45740195"},{"version":"CommandV1","origId":1575837098435196,"guid":"f5b4a55c-1033-4228-9298-f130fdd6749b","subtype":"command","commandType":"auto","position":15.0,"command":"# Function takes 3 arguments\n# First argument is a column from which we want to extract substring.\n# Second argument is the character from which string is supposed to be extracted.\n# Third argument is number of characters from the first argument.\ndf.select(substring(lit(\"Hello World\"), 7, 5)). \\\n  show()","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+----------------------------+\n|substring(Hello World, 7, 5)|\n+----------------------------+\n|                       World|\n+----------------------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641159859192,"submitTime":1641159859173,"finishTime":1641159859811,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":{"pycharm":{"name":"#%%\n"}},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"765b5b81-8151-42c9-b9ac-d8f96e4f50b0"},{"version":"CommandV1","origId":1575837098435197,"guid":"bf1ba993-5890-4f8f-8a46-71e7cf243af5","subtype":"command","commandType":"auto","position":16.0,"command":"df.select(substring(lit(\"Hello World\"), -5, 5)). \\\n  show()","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+-----------------------------+\n|substring(Hello World, -5, 5)|\n+-----------------------------+\n|                        World|\n+-----------------------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641159859818,"submitTime":1641159859625,"finishTime":1641159859942,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":{"pycharm":{"name":"#%%\n"}},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"d1a9ab0d-2489-4e64-ab57-dde1bf6bf947"},{"version":"CommandV1","origId":1575837098435198,"guid":"0ff22495-25a2-48db-8b1c-c3bc5fa96606","subtype":"command","commandType":"auto","position":17.0,"command":"%md\n### Tasks - substring\n\nLet us perform few tasks to extract information from fixed length strings.\n* Create a list for employees with name, ssn and phone_number.\n* SSN Format **3 2 4** - Fixed Length with 11 characters\n* Phone Number Format - Country Code is variable and remaining phone number have 10 digits:\n * Country Code - one to 3 digits\n * Area Code - 3 digits\n * Phone Number Prefix - 3 digits\n * Phone Number Remaining - 4 digits\n * All the 4 parts are separated by spaces\n* Create a Dataframe with column names name, ssn and phone_number\n* Extract last 4 digits from the phone number.\n* Extract last 4 digits from SSN.","commandVersion":1,"state":"finished","results":{"type":"raw","data":"","arguments":{},"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"2a1b50b5-6fa0-4f74-b129-1ed1a4ff96e9"},{"version":"CommandV1","origId":1575837098435199,"guid":"c88de0f7-48b7-4f52-a418-048bfcc7fa1d","subtype":"command","commandType":"auto","position":18.0,"command":"employees = [(1, \"Scott\", \"Tiger\", 1000.0, \n                      \"united states\", \"+1 123 456 7890\", \"123 45 6789\"\n                     ),\n                     (2, \"Henry\", \"Ford\", 1250.0, \n                      \"India\", \"+91 234 567 8901\", \"456 78 9123\"\n                     ),\n                     (3, \"Nick\", \"Junior\", 750.0, \n                      \"united KINGDOM\", \"+44 111 111 1111\", \"222 33 4444\"\n                     ),\n                     (4, \"Bill\", \"Gomes\", 1500.0, \n                      \"AUSTRALIA\", \"+61 987 654 3210\", \"789 12 6118\"\n                     )\n                ]","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641159861132,"submitTime":1641159861111,"finishTime":1641159861149,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"50cae80a-849c-424d-bf51-2f1de738402d"},{"version":"CommandV1","origId":1575837098435200,"guid":"450698b1-1d0e-4cb6-9805-3a09379fd89d","subtype":"command","commandType":"auto","position":19.0,"command":"employeesDF = spark. \\\n    createDataFrame(employees,\n                    schema=\"\"\"employee_id INT, first_name STRING, \n                    last_name STRING, salary FLOAT, nationality STRING,\n                    phone_number STRING, ssn STRING\"\"\"\n                   )","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"employeesDF","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"employee_id","nullable":true,"type":"integer"},{"metadata":{},"name":"first_name","nullable":true,"type":"string"},{"metadata":{},"name":"last_name","nullable":true,"type":"string"},{"metadata":{},"name":"salary","nullable":true,"type":"float"},{"metadata":{},"name":"nationality","nullable":true,"type":"string"},{"metadata":{},"name":"phone_number","nullable":true,"type":"string"},{"metadata":{},"name":"ssn","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641159862053,"submitTime":1641159862032,"finishTime":1641159862147,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"4ffee5c7-0264-41ea-8068-c319d034654a"},{"version":"CommandV1","origId":1575837098435201,"guid":"d24cc96b-dbd1-47a5-9810-e957621fd781","subtype":"command","commandType":"auto","position":20.0,"command":"employeesDF.show(truncate=False)","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+-----------+----------+---------+------+--------------+----------------+-----------+\n|employee_id|first_name|last_name|salary|nationality   |phone_number    |ssn        |\n+-----------+----------+---------+------+--------------+----------------+-----------+\n|1          |Scott     |Tiger    |1000.0|united states |+1 123 456 7890 |123 45 6789|\n|2          |Henry     |Ford     |1250.0|India         |+91 234 567 8901|456 78 9123|\n|3          |Nick      |Junior   |750.0 |united KINGDOM|+44 111 111 1111|222 33 4444|\n|4          |Bill      |Gomes    |1500.0|AUSTRALIA     |+61 987 654 3210|789 12 6118|\n+-----------+----------+---------+------+--------------+----------------+-----------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641159862900,"submitTime":1641159862882,"finishTime":1641159863100,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"de72682c-32c5-44f6-b102-9b960229637a"},{"version":"CommandV1","origId":1575837098435202,"guid":"84f7695d-de3b-4fdf-a0ce-b7b1a7c7e351","subtype":"command","commandType":"auto","position":21.0,"command":"from pyspark.sql.functions import substring, col","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641159863758,"submitTime":1641159863740,"finishTime":1641159863775,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":{"pycharm":{"name":"#%%\n"}},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"1b8fbf8c-06ed-422c-9c83-0079761ff888"},{"version":"CommandV1","origId":1575837098435203,"guid":"e268bad8-7486-4d71-9276-f7a53dafdc2e","subtype":"command","commandType":"auto","position":22.0,"command":"employeesDF. \\\n    select(\"employee_id\", \"phone_number\", \"ssn\"). \\\n    withColumn(\"phone_last4\", substring(col(\"phone_number\"), -4, 4).cast(\"int\")). \\\n    withColumn(\"ssn_last4\", substring(col(\"ssn\"), 8, 4).cast(\"int\")). \\\n    show()","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+-----------+----------------+-----------+-----------+---------+\n|employee_id|    phone_number|        ssn|phone_last4|ssn_last4|\n+-----------+----------------+-----------+-----------+---------+\n|          1| +1 123 456 7890|123 45 6789|       7890|     6789|\n|          2|+91 234 567 8901|456 78 9123|       8901|     9123|\n|          3|+44 111 111 1111|222 33 4444|       1111|     4444|\n|          4|+61 987 654 3210|789 12 6118|       3210|     6118|\n+-----------+----------------+-----------+-----------+---------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641159864564,"submitTime":1641159864545,"finishTime":1641159864824,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":{"pycharm":{"name":"#%%\n"}},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"a8bd7456-8f64-4eee-9564-7f519c8ee22b"},{"version":"CommandV1","origId":1575837098435204,"guid":"b6a26b99-facc-4c67-bc76-521cb7d652a5","subtype":"command","commandType":"auto","position":23.0,"command":"employeesDF. \\\n    select(\"employee_id\", \"phone_number\", \"ssn\"). \\\n    withColumn(\"phone_last4\", substring(col(\"phone_number\"), -4, 4).cast(\"int\")). \\\n    withColumn(\"ssn_last4\", substring(col(\"ssn\"), 8, 4).cast(\"int\")). \\\n    printSchema()","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">root\n |-- employee_id: integer (nullable = true)\n |-- phone_number: string (nullable = true)\n |-- ssn: string (nullable = true)\n |-- phone_last4: integer (nullable = true)\n |-- ssn_last4: integer (nullable = true)\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641159865172,"submitTime":1641159865153,"finishTime":1641159865257,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"283c4555-c52a-406e-af8d-b4839a416809"},{"version":"CommandV1","origId":1575837098435205,"guid":"7f6ee5b6-af97-4898-81f9-0e91dcff4a6e","subtype":"command","commandType":"auto","position":24.0,"command":"","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"bd2ec718-17cf-4d65-886e-6e06ed38c858"}],"dashboards":[],"guid":"57f22447-9056-46e8-8560-8e292ceef713","globalVars":{},"iPythonMetadata":{"nbformat":4,"IPythonMetadata":{"kernelspec":{"display_name":"Pyspark 2","language":"python","name":"pyspark2"},"language_info":{"mimetype":"text/x-python","name":"python","pygments_lexer":"ipython3","codemirror_mode":{"name":"ipython","version":3},"version":"3.6.12","nbconvert_exporter":"python","file_extension":".py"}}},"inputWidgets":{},"notebookMetadata":{"pythonIndentUnit":4}}