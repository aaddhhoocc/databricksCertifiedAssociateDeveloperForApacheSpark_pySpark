{"version":"NotebookV1","origId":1575837098435271,"name":"02 Predefined Functions","language":"python","commands":[{"version":"CommandV1","origId":1575837098435272,"guid":"25868bbd-9e41-4e6c-b6c6-9e633cc08e54","subtype":"command","commandType":"auto","position":1.0,"command":"%md\n## Pre-defined Functions\n\nWe typically process data in the columns using functions in `pyspark.sql.functions`. Let us understand details about these functions in detail as part of this module.","commandVersion":1,"state":"finished","results":{"type":"raw","data":"","arguments":{},"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"910cf42c-2d77-42c4-8aad-01f0699d5919"},{"version":"CommandV1","origId":1575837098435273,"guid":"1771e605-38ff-48e4-846e-dd439cf033f8","subtype":"command","commandType":"auto","position":3.0,"command":"%md\n* Let us recap about Functions or APIs to process Data Frames.\n * Projection - `select` or `withColumn` or `drop` or `selectExpr`\n * Filtering - `filter` or `where`\n * Grouping data by key and perform aggregations - `groupBy`\n * Sorting data - `sort` or `orderBy` \n* We can pass column names or literals or expressions to all the Data Frame APIs.\n* Expressions include arithmetic operations, transformations using functions from `pyspark.sql.functions`.\n* There are approximately 300 functions under `pyspark.sql.functions`.\n* We will talk about some of the important functions used for String Manipulation, Date Manipulation etc.","commandVersion":1,"state":"finished","results":{"type":"raw","data":"","arguments":{},"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"b44f6106-ddcf-4611-961a-1c6f4b98d86b"},{"version":"CommandV1","origId":1575837098435274,"guid":"ce938271-f050-4dc2-8a8e-188ea557138c","subtype":"command","commandType":"auto","position":7.0,"command":"%md\n* Here are some of the examples of using functions to take care of required transformations.","commandVersion":1,"state":"finished","results":{"type":"raw","data":"","arguments":{},"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"ef37fc64-1f35-488c-90f3-a885f64b027f"},{"version":"CommandV1","origId":1575837098435275,"guid":"cb7eae9a-3d46-47ca-8c3c-fcd769de014c","subtype":"command","commandType":"auto","position":8.0,"command":"# Reading data\n\norders = spark.read.csv(\n    '/public/retail_db/orders',\n    schema='order_id INT, order_date STRING, order_customer_id INT, order_status STRING'\n)","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"orders","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"order_id","nullable":true,"type":"integer"},{"metadata":{},"name":"order_date","nullable":true,"type":"string"},{"metadata":{},"name":"order_customer_id","nullable":true,"type":"integer"},{"metadata":{},"name":"order_status","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641159672577,"submitTime":1641159671199,"finishTime":1641159677321,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"55935851-9b02-4f40-948a-1eb9c8ec3d7f"},{"version":"CommandV1","origId":1575837098435276,"guid":"a9c4a7f9-c8d4-4bf6-aba0-f65c60ba2e8d","subtype":"command","commandType":"auto","position":9.0,"command":"# Importing functions\n\nfrom pyspark.sql.functions import date_format","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641159679114,"submitTime":1641159679094,"finishTime":1641159679133,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"9689b0d9-d096-4245-9432-548c53165c74"},{"version":"CommandV1","origId":1575837098435277,"guid":"04bf524f-6768-4bdf-a94e-e4e7a308f00a","subtype":"command","commandType":"auto","position":10.0,"command":"orders.show()","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+--------+--------------------+-----------------+---------------+\n|order_id|          order_date|order_customer_id|   order_status|\n+--------+--------------------+-----------------+---------------+\n|       1|2013-07-25 00:00:...|            11599|         CLOSED|\n|       2|2013-07-25 00:00:...|              256|PENDING_PAYMENT|\n|       3|2013-07-25 00:00:...|            12111|       COMPLETE|\n|       4|2013-07-25 00:00:...|             8827|         CLOSED|\n|       5|2013-07-25 00:00:...|            11318|       COMPLETE|\n|       6|2013-07-25 00:00:...|             7130|       COMPLETE|\n|       7|2013-07-25 00:00:...|             4530|       COMPLETE|\n|       8|2013-07-25 00:00:...|             2911|     PROCESSING|\n|       9|2013-07-25 00:00:...|             5657|PENDING_PAYMENT|\n|      10|2013-07-25 00:00:...|             5648|PENDING_PAYMENT|\n|      11|2013-07-25 00:00:...|              918| PAYMENT_REVIEW|\n|      12|2013-07-25 00:00:...|             1837|         CLOSED|\n|      13|2013-07-25 00:00:...|             9149|PENDING_PAYMENT|\n|      14|2013-07-25 00:00:...|             9842|     PROCESSING|\n|      15|2013-07-25 00:00:...|             2568|       COMPLETE|\n|      16|2013-07-25 00:00:...|             7276|PENDING_PAYMENT|\n|      17|2013-07-25 00:00:...|             2667|       COMPLETE|\n|      18|2013-07-25 00:00:...|             1205|         CLOSED|\n|      19|2013-07-25 00:00:...|             9488|PENDING_PAYMENT|\n|      20|2013-07-25 00:00:...|             9198|     PROCESSING|\n+--------+--------------------+-----------------+---------------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641159679892,"submitTime":1641159679872,"finishTime":1641159681417,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"a44eb30d-2644-4efd-90f0-6e3f81b49828"},{"version":"CommandV1","origId":1575837098435278,"guid":"67b7a2b3-f5ca-4ef0-9fe5-55933d7e1f43","subtype":"command","commandType":"auto","position":11.0,"command":"orders.printSchema()","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">root\n |-- order_id: integer (nullable = true)\n |-- order_date: string (nullable = true)\n |-- order_customer_id: integer (nullable = true)\n |-- order_status: string (nullable = true)\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641159681424,"submitTime":1641159680836,"finishTime":1641159681443,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"925cdf6d-2e4f-472b-9891-c2a3a212b408"},{"version":"CommandV1","origId":1575837098435279,"guid":"8d7d707b-0108-498f-bdd9-dfa8dcb966e0","subtype":"command","commandType":"auto","position":12.0,"command":"# Function as part of projections\n\norders.select('*', date_format('order_date', 'yyyyMM').alias('order_month')).show()","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+--------+--------------------+-----------------+---------------+-----------+\n|order_id|          order_date|order_customer_id|   order_status|order_month|\n+--------+--------------------+-----------------+---------------+-----------+\n|       1|2013-07-25 00:00:...|            11599|         CLOSED|     201307|\n|       2|2013-07-25 00:00:...|              256|PENDING_PAYMENT|     201307|\n|       3|2013-07-25 00:00:...|            12111|       COMPLETE|     201307|\n|       4|2013-07-25 00:00:...|             8827|         CLOSED|     201307|\n|       5|2013-07-25 00:00:...|            11318|       COMPLETE|     201307|\n|       6|2013-07-25 00:00:...|             7130|       COMPLETE|     201307|\n|       7|2013-07-25 00:00:...|             4530|       COMPLETE|     201307|\n|       8|2013-07-25 00:00:...|             2911|     PROCESSING|     201307|\n|       9|2013-07-25 00:00:...|             5657|PENDING_PAYMENT|     201307|\n|      10|2013-07-25 00:00:...|             5648|PENDING_PAYMENT|     201307|\n|      11|2013-07-25 00:00:...|              918| PAYMENT_REVIEW|     201307|\n|      12|2013-07-25 00:00:...|             1837|         CLOSED|     201307|\n|      13|2013-07-25 00:00:...|             9149|PENDING_PAYMENT|     201307|\n|      14|2013-07-25 00:00:...|             9842|     PROCESSING|     201307|\n|      15|2013-07-25 00:00:...|             2568|       COMPLETE|     201307|\n|      16|2013-07-25 00:00:...|             7276|PENDING_PAYMENT|     201307|\n|      17|2013-07-25 00:00:...|             2667|       COMPLETE|     201307|\n|      18|2013-07-25 00:00:...|             1205|         CLOSED|     201307|\n|      19|2013-07-25 00:00:...|             9488|PENDING_PAYMENT|     201307|\n|      20|2013-07-25 00:00:...|             9198|     PROCESSING|     201307|\n+--------+--------------------+-----------------+---------------+-----------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641159681843,"submitTime":1641159681823,"finishTime":1641159682219,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"80c86c59-8492-4d79-a546-9d3e83605e2a"},{"version":"CommandV1","origId":1575837098435280,"guid":"196a8448-6495-4648-9883-fc3a2e3427bd","subtype":"command","commandType":"auto","position":13.0,"command":"orders.withColumn('order_month', date_format('order_date', 'yyyyMM')).show()","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+--------+--------------------+-----------------+---------------+-----------+\n|order_id|          order_date|order_customer_id|   order_status|order_month|\n+--------+--------------------+-----------------+---------------+-----------+\n|       1|2013-07-25 00:00:...|            11599|         CLOSED|     201307|\n|       2|2013-07-25 00:00:...|              256|PENDING_PAYMENT|     201307|\n|       3|2013-07-25 00:00:...|            12111|       COMPLETE|     201307|\n|       4|2013-07-25 00:00:...|             8827|         CLOSED|     201307|\n|       5|2013-07-25 00:00:...|            11318|       COMPLETE|     201307|\n|       6|2013-07-25 00:00:...|             7130|       COMPLETE|     201307|\n|       7|2013-07-25 00:00:...|             4530|       COMPLETE|     201307|\n|       8|2013-07-25 00:00:...|             2911|     PROCESSING|     201307|\n|       9|2013-07-25 00:00:...|             5657|PENDING_PAYMENT|     201307|\n|      10|2013-07-25 00:00:...|             5648|PENDING_PAYMENT|     201307|\n|      11|2013-07-25 00:00:...|              918| PAYMENT_REVIEW|     201307|\n|      12|2013-07-25 00:00:...|             1837|         CLOSED|     201307|\n|      13|2013-07-25 00:00:...|             9149|PENDING_PAYMENT|     201307|\n|      14|2013-07-25 00:00:...|             9842|     PROCESSING|     201307|\n|      15|2013-07-25 00:00:...|             2568|       COMPLETE|     201307|\n|      16|2013-07-25 00:00:...|             7276|PENDING_PAYMENT|     201307|\n|      17|2013-07-25 00:00:...|             2667|       COMPLETE|     201307|\n|      18|2013-07-25 00:00:...|             1205|         CLOSED|     201307|\n|      19|2013-07-25 00:00:...|             9488|PENDING_PAYMENT|     201307|\n|      20|2013-07-25 00:00:...|             9198|     PROCESSING|     201307|\n+--------+--------------------+-----------------+---------------+-----------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641159683315,"submitTime":1641159683296,"finishTime":1641159683529,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"29f404e7-68c7-4b28-b403-c49dc8482f9b"},{"version":"CommandV1","origId":1575837098435281,"guid":"fae391bb-bb39-4745-b9bf-53ba20ccca21","subtype":"command","commandType":"auto","position":14.0,"command":"# Function as part of where or filter\n\norders. \\\n    filter(date_format('order_date', 'yyyyMM') == 201401). \\\n    show()","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+--------+--------------------+-----------------+---------------+\n|order_id|          order_date|order_customer_id|   order_status|\n+--------+--------------------+-----------------+---------------+\n|   25876|2014-01-01 00:00:...|             3414|PENDING_PAYMENT|\n|   25877|2014-01-01 00:00:...|             5549|PENDING_PAYMENT|\n|   25878|2014-01-01 00:00:...|             9084|        PENDING|\n|   25879|2014-01-01 00:00:...|             5118|        PENDING|\n|   25880|2014-01-01 00:00:...|            10146|       CANCELED|\n|   25881|2014-01-01 00:00:...|             3205|PENDING_PAYMENT|\n|   25882|2014-01-01 00:00:...|             4598|       COMPLETE|\n|   25883|2014-01-01 00:00:...|            11764|        PENDING|\n|   25884|2014-01-01 00:00:...|             7904|PENDING_PAYMENT|\n|   25885|2014-01-01 00:00:...|             7253|        PENDING|\n|   25886|2014-01-01 00:00:...|             8195|     PROCESSING|\n|   25887|2014-01-01 00:00:...|            10062|        PENDING|\n|   25888|2014-01-01 00:00:...|             6735|       COMPLETE|\n|   25889|2014-01-01 00:00:...|            10045|       COMPLETE|\n|   25890|2014-01-01 00:00:...|             2581|        PENDING|\n|   25891|2014-01-01 00:00:...|             3037|         CLOSED|\n|   25892|2014-01-01 00:00:...|             3853|        ON_HOLD|\n|   25893|2014-01-01 00:00:...|             8679|PENDING_PAYMENT|\n|   25894|2014-01-01 00:00:...|             7839|     PROCESSING|\n|   25895|2014-01-01 00:00:...|             1044|       COMPLETE|\n+--------+--------------------+-----------------+---------------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641159684459,"submitTime":1641159684437,"finishTime":1641159685626,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"b8cd948a-71e2-4548-9863-ea58ca4258f5"},{"version":"CommandV1","origId":1575837098435282,"guid":"ed967e07-cc76-4639-aff8-7e3229990a5d","subtype":"command","commandType":"auto","position":15.0,"command":"# Function as part of groupBy\n\norders. \\\n    groupBy(date_format('order_date', 'yyyyMM').alias('order_month')). \\\n    count(). \\\n    show()","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+-----------+-----+\n|order_month|count|\n+-----------+-----+\n|     201401| 5908|\n|     201405| 5467|\n|     201312| 5892|\n|     201310| 5335|\n|     201311| 6381|\n|     201307| 1533|\n|     201407| 4468|\n|     201403| 5778|\n|     201404| 5657|\n|     201402| 5635|\n|     201309| 5841|\n|     201406| 5308|\n|     201308| 5680|\n+-----------+-----+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641159686040,"submitTime":1641159686020,"finishTime":1641159686937,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"6af317c6-9dd4-4765-9391-8a42ecc13ec3"},{"version":"CommandV1","origId":1575837098435283,"guid":"1d239949-19e1-494d-9242-26b019153eaa","subtype":"command","commandType":"auto","position":16.0,"command":"","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"6a15a91e-0b12-4811-aaf0-56ae29e06c5b"}],"dashboards":[],"guid":"c9a0be5f-00cd-4fa2-9497-d5369d3625dc","globalVars":{},"iPythonMetadata":{"nbformat":4,"IPythonMetadata":{"kernelspec":{"display_name":"Pyspark 2","language":"python","name":"pyspark2"},"language_info":{"mimetype":"text/x-python","name":"python","pygments_lexer":"ipython3","codemirror_mode":{"name":"ipython","version":3},"version":"3.6.12","nbconvert_exporter":"python","file_extension":".py"}}},"inputWidgets":{},"notebookMetadata":{"pythonIndentUnit":4}}