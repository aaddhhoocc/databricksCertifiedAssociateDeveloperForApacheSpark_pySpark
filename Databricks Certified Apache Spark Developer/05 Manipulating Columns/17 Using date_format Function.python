{"version":"NotebookV1","origId":1575837098435448,"name":"17 Using date_format Function","language":"python","commands":[{"version":"CommandV1","origId":1575837098435449,"guid":"af109459-ee88-4c59-93dc-9146a49bde66","subtype":"command","commandType":"auto","position":1.0,"command":"%md\n## Using date_format Function\n\nLet us understand how to extract information from dates or times using `date_format` function.","commandVersion":1,"state":"finished","results":{"type":"raw","data":"","arguments":{},"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"c39d9da2-703e-458b-8513-57271bad363b"},{"version":"CommandV1","origId":1575837098435450,"guid":"1eb35e32-4665-4452-95c0-b15e9e24c4f0","subtype":"command","commandType":"auto","position":3.0,"command":"%md\n \n\n* We can use `date_format` to extract the required information in a desired format from standard date or timestamp. Earlier we have explored `to_date` and `to_timestamp` to convert non standard date or timestamp to standard ones respectively.\n* There are also specific functions to extract year, month, day with in a week, a day with in a month, day with in a year etc. These are covered as part of earlier topics in this section or module.","commandVersion":1,"state":"finished","results":{"type":"raw","data":"","arguments":{},"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"eb28ab5c-7ef3-4fbe-8959-d27ed131019e"},{"version":"CommandV1","origId":1575837098435451,"guid":"90988c72-f164-47bc-84be-975288d84eb9","subtype":"command","commandType":"auto","position":7.0,"command":"%md\n### Tasks\n\nLet us perform few tasks to extract the information we need from date or timestamp.\n\n* Create a Dataframe by name datetimesDF with columns date and time.","commandVersion":1,"state":"finished","results":{"type":"raw","data":"","arguments":{},"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"de5264fb-4e92-48ab-be48-f801c8e5acf7"},{"version":"CommandV1","origId":1575837098435452,"guid":"76742498-c7d0-43e0-a67b-ee17c8273aae","subtype":"command","commandType":"auto","position":8.0,"command":"datetimes = [(\"2014-02-28\", \"2014-02-28 10:00:00.123\"),\n                     (\"2016-02-29\", \"2016-02-29 08:08:08.999\"),\n                     (\"2017-10-31\", \"2017-12-31 11:59:59.123\"),\n                     (\"2019-11-30\", \"2019-08-31 00:00:00.000\")\n                ]","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641160177914,"submitTime":1641160165000,"finishTime":1641160177949,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"1d082654-7581-4e13-9755-23d138a96507"},{"version":"CommandV1","origId":1575837098435453,"guid":"2b4bcdc3-e546-456a-9c0d-063ff53bceb0","subtype":"command","commandType":"auto","position":9.0,"command":"datetimesDF = spark.createDataFrame(datetimes, schema=\"date STRING, time STRING\")","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"datetimesDF","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"date","nullable":true,"type":"string"},{"metadata":{},"name":"time","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641160177954,"submitTime":1641160165719,"finishTime":1641160179879,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"535180c7-6095-4de7-b7e3-3ef20a729b20"},{"version":"CommandV1","origId":1575837098435454,"guid":"31e6a4be-a444-4b2d-affa-16e0a83fa7f3","subtype":"command","commandType":"auto","position":10.0,"command":"datetimesDF.show(truncate=False)","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+----------+-----------------------+\n|date      |time                   |\n+----------+-----------------------+\n|2014-02-28|2014-02-28 10:00:00.123|\n|2016-02-29|2016-02-29 08:08:08.999|\n|2017-10-31|2017-12-31 11:59:59.123|\n|2019-11-30|2019-08-31 00:00:00.000|\n+----------+-----------------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641160179885,"submitTime":1641160166098,"finishTime":1641160182211,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":{"pycharm":{"name":"#%%\n"}},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"5a9badb2-56ac-4174-bc12-ff6af4e0e1f9"},{"version":"CommandV1","origId":1575837098435455,"guid":"741293e5-8888-4f4a-b8e9-cc697433a3d9","subtype":"command","commandType":"auto","position":11.0,"command":"from pyspark.sql.functions import date_format","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641160182219,"submitTime":1641160166516,"finishTime":1641160182245,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":{"pycharm":{"name":"#%%\n"}},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"0514d100-f296-42e2-b80f-52f95b2e7d0d"},{"version":"CommandV1","origId":1575837098435456,"guid":"43de4d42-b80f-4240-afd4-89147fd4bfca","subtype":"command","commandType":"auto","position":12.0,"command":"%md\n* Get the year and month from both date and time columns using `yyyyMM` format. Also make sure that the data type is converted to integer.","commandVersion":1,"state":"finished","results":{"type":"raw","data":"","arguments":{},"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"b8b64f07-5baa-47bf-94f0-d123173a1249"},{"version":"CommandV1","origId":1575837098435457,"guid":"ff71a47f-9f05-4076-818c-107007bfdd93","subtype":"command","commandType":"auto","position":13.0,"command":"datetimesDF. \\\n    withColumn(\"date_ym\", date_format(\"date\", \"yyyyMM\")). \\\n    withColumn(\"time_ym\", date_format(\"time\", \"yyyyMM\")). \\\n    show(truncate=False)\n\n# yyyy\n# MM\n# dd\n# DD\n# HH\n# hh\n# mm\n# ss\n# SSS","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+----------+-----------------------+-------+-------+\n|date      |time                   |date_ym|time_ym|\n+----------+-----------------------+-------+-------+\n|2014-02-28|2014-02-28 10:00:00.123|201402 |201402 |\n|2016-02-29|2016-02-29 08:08:08.999|201602 |201602 |\n|2017-10-31|2017-12-31 11:59:59.123|201710 |201712 |\n|2019-11-30|2019-08-31 00:00:00.000|201911 |201908 |\n+----------+-----------------------+-------+-------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641160182256,"submitTime":1641160166815,"finishTime":1641160182690,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":{"pycharm":{"name":"#%%\n"}},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"a2c7963f-d7d2-4b5d-ba50-9fab665dfc0b"},{"version":"CommandV1","origId":1575837098435458,"guid":"e72499e4-cd06-4bfb-afc0-8ff91e6dcdf8","subtype":"command","commandType":"auto","position":14.0,"command":"datetimesDF. \\\n    withColumn(\"date_ym\", date_format(\"date\", \"yyyyMM\")). \\\n    withColumn(\"time_ym\", date_format(\"time\", \"yyyyMM\")). \\\n    printSchema()","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">root\n |-- date: string (nullable = true)\n |-- time: string (nullable = true)\n |-- date_ym: string (nullable = true)\n |-- time_ym: string (nullable = true)\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641160183764,"submitTime":1641160167120,"finishTime":1641160183886,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"3df7d81c-955c-47c9-b2a4-36d754200bfe"},{"version":"CommandV1","origId":1575837098435459,"guid":"6fe9ac96-f141-4e9f-b82d-55d30a135bc6","subtype":"command","commandType":"auto","position":15.0,"command":"datetimesDF. \\\n    withColumn(\"date_ym\", date_format(\"date\", \"yyyyMM\").cast('int')). \\\n    withColumn(\"time_ym\", date_format(\"time\", \"yyyyMM\").cast('int')). \\\n    printSchema()","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">root\n |-- date: string (nullable = true)\n |-- time: string (nullable = true)\n |-- date_ym: integer (nullable = true)\n |-- time_ym: integer (nullable = true)\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641160183901,"submitTime":1641160167439,"finishTime":1641160183971,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"bcbf3462-e6cd-4ed8-a746-90f3433a515e"},{"version":"CommandV1","origId":1575837098435460,"guid":"6f22fcf3-3027-488f-8e0c-66829a03763c","subtype":"command","commandType":"auto","position":16.0,"command":"datetimesDF. \\\n    withColumn(\"date_ym\", date_format(\"date\", \"yyyyMM\").cast('int')). \\\n    withColumn(\"time_ym\", date_format(\"time\", \"yyyyMM\").cast('int')). \\\n    show(truncate=False)","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+----------+-----------------------+-------+-------+\n|date      |time                   |date_ym|time_ym|\n+----------+-----------------------+-------+-------+\n|2014-02-28|2014-02-28 10:00:00.123|201402 |201402 |\n|2016-02-29|2016-02-29 08:08:08.999|201602 |201602 |\n|2017-10-31|2017-12-31 11:59:59.123|201710 |201712 |\n|2019-11-30|2019-08-31 00:00:00.000|201911 |201908 |\n+----------+-----------------------+-------+-------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641160183976,"submitTime":1641160167784,"finishTime":1641160184292,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"9c065342-8f2f-4ecd-b965-9be47958d3fb"},{"version":"CommandV1","origId":1575837098435461,"guid":"61e44c03-a1ff-4d0e-9a63-0ebf8410e35a","subtype":"command","commandType":"auto","position":17.0,"command":"%md\n* Get the information from time in yyyyMMddHHmmss format.","commandVersion":1,"state":"finished","results":{"type":"raw","data":"","arguments":{},"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"0251cd43-ce11-497d-8152-826dbbba4978"},{"version":"CommandV1","origId":1575837098435462,"guid":"542209c9-cf21-4f5e-a283-73c7bdcbe25a","subtype":"command","commandType":"auto","position":18.0,"command":"from pyspark.sql.functions import date_format","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641160184298,"submitTime":1641160168706,"finishTime":1641160184314,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":{"pycharm":{"name":"#%%\n"}},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"a5ad2cd7-0bb6-4836-a2f0-f22994b2a0b4"},{"version":"CommandV1","origId":1575837098435463,"guid":"6bd96ba5-1a27-40c3-afc3-eda899a253a3","subtype":"command","commandType":"auto","position":19.0,"command":"datetimesDF. \\\n    withColumn(\"date_dt\", date_format(\"date\", \"yyyyMMddHHmmss\")). \\\n    withColumn(\"date_ts\", date_format(\"time\", \"yyyyMMddHHmmss\")). \\\n    show(truncate=False)","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+----------+-----------------------+--------------+--------------+\n|date      |time                   |date_dt       |date_ts       |\n+----------+-----------------------+--------------+--------------+\n|2014-02-28|2014-02-28 10:00:00.123|20140228000000|20140228100000|\n|2016-02-29|2016-02-29 08:08:08.999|20160229000000|20160229080808|\n|2017-10-31|2017-12-31 11:59:59.123|20171031000000|20171231115959|\n|2019-11-30|2019-08-31 00:00:00.000|20191130000000|20190831000000|\n+----------+-----------------------+--------------+--------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641160184320,"submitTime":1641160169331,"finishTime":1641160184615,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":{"pycharm":{"name":"#%%\n"}},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"a843ea3b-1552-4e91-9d16-4b20a4c569d0"},{"version":"CommandV1","origId":1575837098435464,"guid":"eadaa433-c181-4d15-ae25-615cfd355f4c","subtype":"command","commandType":"auto","position":20.0,"command":"datetimesDF. \\\n    withColumn(\"date_dt\", date_format(\"date\", \"yyyyMMddHHmmss\").cast('long')). \\\n    withColumn(\"date_ts\", date_format(\"time\", \"yyyyMMddHHmmss\").cast('long')). \\\n    show(truncate=False)","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+----------+-----------------------+--------------+--------------+\n|date      |time                   |date_dt       |date_ts       |\n+----------+-----------------------+--------------+--------------+\n|2014-02-28|2014-02-28 10:00:00.123|20140228000000|20140228100000|\n|2016-02-29|2016-02-29 08:08:08.999|20160229000000|20160229080808|\n|2017-10-31|2017-12-31 11:59:59.123|20171031000000|20171231115959|\n|2019-11-30|2019-08-31 00:00:00.000|20191130000000|20190831000000|\n+----------+-----------------------+--------------+--------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641160184625,"submitTime":1641160170045,"finishTime":1641160185057,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":{"pycharm":{"name":"#%%\n"}},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"b93f55d6-a9a9-4d08-bc95-5df06203b862"},{"version":"CommandV1","origId":1575837098435465,"guid":"33cac995-c660-4dd7-a6c1-96fc1b29d7fb","subtype":"command","commandType":"auto","position":21.0,"command":"%md\n* Get year and day of year using `yyyyDDD` format.","commandVersion":1,"state":"finished","results":{"type":"raw","data":"","arguments":{},"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"a2eb1fcf-ce00-4636-9f2a-5851105bb881"},{"version":"CommandV1","origId":1575837098435466,"guid":"e84aadd5-9102-4685-9baf-263f6c297de2","subtype":"command","commandType":"auto","position":22.0,"command":"datetimesDF. \\\n    withColumn(\"date_yd\", date_format(\"date\", \"yyyyDDD\").cast('int')). \\\n    withColumn(\"time_yd\", date_format(\"time\", \"yyyyDDD\").cast('int')). \\\n    show(truncate=False)","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+----------+-----------------------+-------+-------+\n|date      |time                   |date_yd|time_yd|\n+----------+-----------------------+-------+-------+\n|2014-02-28|2014-02-28 10:00:00.123|2014059|2014059|\n|2016-02-29|2016-02-29 08:08:08.999|2016060|2016060|\n|2017-10-31|2017-12-31 11:59:59.123|2017304|2017365|\n|2019-11-30|2019-08-31 00:00:00.000|2019334|2019243|\n+----------+-----------------------+-------+-------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641160185064,"submitTime":1641160171224,"finishTime":1641160185210,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"c13d2bff-c109-468a-a18a-181df6114c99"},{"version":"CommandV1","origId":1575837098435467,"guid":"bcf2c5f4-295c-48c3-b1bd-c00ae73e5305","subtype":"command","commandType":"auto","position":23.0,"command":"%md\n* Get complete description of the date.","commandVersion":1,"state":"finished","results":{"type":"raw","data":"","arguments":{},"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"e38d30a8-89f5-4110-8394-d9d4e2b2a8ea"},{"version":"CommandV1","origId":1575837098435468,"guid":"e84041d5-3c94-432f-b16a-c37da0a45869","subtype":"command","commandType":"auto","position":24.0,"command":"datetimesDF. \\\n    withColumn(\"date_desc\", date_format(\"date\", \"MMMM d, yyyy\")). \\\n    show(truncate=False)","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+----------+-----------------------+-----------------+\n|date      |time                   |date_desc        |\n+----------+-----------------------+-----------------+\n|2014-02-28|2014-02-28 10:00:00.123|February 28, 2014|\n|2016-02-29|2016-02-29 08:08:08.999|February 29, 2016|\n|2017-10-31|2017-12-31 11:59:59.123|October 31, 2017 |\n|2019-11-30|2019-08-31 00:00:00.000|November 30, 2019|\n+----------+-----------------------+-----------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641160185216,"submitTime":1641160172483,"finishTime":1641160185480,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"d2f20186-a195-4eda-aa1b-190ca8ba86d7"},{"version":"CommandV1","origId":1575837098435469,"guid":"632aa75e-b5ac-4854-843f-c34a82a06d92","subtype":"command","commandType":"auto","position":25.0,"command":"%md\n* Get name of the week day using date.","commandVersion":1,"state":"finished","results":{"type":"raw","data":"","arguments":{},"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"78eca5bc-846a-48ea-87c7-16bcc04387df"},{"version":"CommandV1","origId":1575837098435470,"guid":"caa9e89c-bbcb-4be9-8ae8-2a8b4bf33cba","subtype":"command","commandType":"auto","position":26.0,"command":"datetimesDF. \\\n    withColumn(\"day_name_abbr\", date_format(\"date\", \"EE\")). \\\n    show(truncate=False)","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+----------+-----------------------+-------------+\n|date      |time                   |day_name_abbr|\n+----------+-----------------------+-------------+\n|2014-02-28|2014-02-28 10:00:00.123|Fri          |\n|2016-02-29|2016-02-29 08:08:08.999|Mon          |\n|2017-10-31|2017-12-31 11:59:59.123|Tue          |\n|2019-11-30|2019-08-31 00:00:00.000|Sat          |\n+----------+-----------------------+-------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641160185520,"submitTime":1641160173711,"finishTime":1641160185693,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"0f3f5bd8-3f0b-42f9-b933-f099a3b157eb"},{"version":"CommandV1","origId":1575837098435471,"guid":"d4a63a6c-f91d-44e8-b286-8b142e0ff34e","subtype":"command","commandType":"auto","position":27.0,"command":"datetimesDF. \\\n    withColumn(\"day_name_full\", date_format(\"date\", \"EEEE\")). \\\n    show(truncate=False)","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+----------+-----------------------+-------------+\n|date      |time                   |day_name_full|\n+----------+-----------------------+-------------+\n|2014-02-28|2014-02-28 10:00:00.123|Friday       |\n|2016-02-29|2016-02-29 08:08:08.999|Monday       |\n|2017-10-31|2017-12-31 11:59:59.123|Tuesday      |\n|2019-11-30|2019-08-31 00:00:00.000|Saturday     |\n+----------+-----------------------+-------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641160185703,"submitTime":1641160174487,"finishTime":1641160185904,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"42fa5f5a-d0b3-4b3e-a2be-f7ca7b825b23"},{"version":"CommandV1","origId":1575837098435472,"guid":"ee42e5fe-f68c-4fd6-9f2e-3e2c3f4a0379","subtype":"command","commandType":"auto","position":28.0,"command":"","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"91f249dc-ad1b-4d13-ba1c-3db43715f39b"}],"dashboards":[],"guid":"aadc2dda-27eb-4fe2-bd64-8cf07adfedef","globalVars":{},"iPythonMetadata":{"nbformat":4,"IPythonMetadata":{"kernelspec":{"display_name":"Pyspark 2","language":"python","name":"pyspark2"},"language_info":{"mimetype":"text/x-python","name":"python","pygments_lexer":"ipython3","codemirror_mode":{"name":"ipython","version":3},"version":"3.6.12","nbconvert_exporter":"python","file_extension":".py"}}},"inputWidgets":{},"notebookMetadata":{"pythonIndentUnit":4}}