{"version":"NotebookV1","origId":1575837098435216,"name":"13 Date and Time Arithmetic","language":"python","commands":[{"version":"CommandV1","origId":1575837098435217,"guid":"7a00da80-8ff3-450e-8b2f-b204ebbe9fb1","subtype":"command","commandType":"auto","position":1.0,"command":"%md\n## Date and Time Arithmetic\nLet us perform Date and Time Arithmetic using relevant functions over Spark Data Frames.","commandVersion":1,"state":"finished","results":{"type":"raw","data":"","arguments":{},"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"00859e09-7385-4755-afc5-040f83fb9147"},{"version":"CommandV1","origId":1575837098435218,"guid":"0117a7a1-56ba-4da9-9435-a3bd4e12b671","subtype":"command","commandType":"auto","position":3.0,"command":"%md\n* Adding days to a date or timestamp - `date_add`\n* Subtracting days from a date or timestamp - `date_sub`\n* Getting difference between 2 dates or timestamps - `datediff`\n* Getting the number of months between 2 dates or timestamps - `months_between`\n* Adding months to a date or timestamp - `add_months`\n* Getting next day from a given date - `next_day`\n* All the functions are self explanatory. We can apply these on standard date or timestamp. All the functions return date even when applied on timestamp field.","commandVersion":1,"state":"finished","results":{"type":"raw","data":"","arguments":{},"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"05844583-1b64-4ab5-870c-5939f2742156"},{"version":"CommandV1","origId":1575837098435219,"guid":"aeee66b0-be1c-4d2c-8875-667b044f438e","subtype":"command","commandType":"auto","position":7.0,"command":"%md\n#### Tasks\n\nLet us perform some tasks related to date arithmetic.\n* Get help on each and every function first and understand what all arguments need to be passed.\n* Create a Dataframe by name datetimesDF with columns date and time.","commandVersion":1,"state":"finished","results":{"type":"raw","data":"","arguments":{},"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"ed46b882-aad9-452d-bd5d-3239968dced1"},{"version":"CommandV1","origId":1575837098435220,"guid":"97c3f54b-bf36-4153-9ab2-67bbc785751d","subtype":"command","commandType":"auto","position":8.0,"command":"datetimes = [(\"2014-02-28\", \"2014-02-28 10:00:00.123\"),\n                     (\"2016-02-29\", \"2016-02-29 08:08:08.999\"),\n                     (\"2017-10-31\", \"2017-12-31 11:59:59.123\"),\n                     (\"2019-11-30\", \"2019-08-31 00:00:00.000\")\n                ]","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641160074639,"submitTime":1641160058247,"finishTime":1641160074672,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":{"pycharm":{"name":"#%%\n"}},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"5ce5c540-ba8c-4617-9d05-8552a11768a0"},{"version":"CommandV1","origId":1575837098435221,"guid":"9d08a939-18a1-4d74-9c5a-fcea50b16185","subtype":"command","commandType":"auto","position":9.0,"command":"datetimesDF = spark.createDataFrame(datetimes, schema=\"date STRING, time STRING\")","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"datetimesDF","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"date","nullable":true,"type":"string"},{"metadata":{},"name":"time","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641160074678,"submitTime":1641160059052,"finishTime":1641160076612,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":{"pycharm":{"name":"#%%\n"}},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"bfa5eb4c-b258-4c64-8e02-654a2e1bf9b3"},{"version":"CommandV1","origId":1575837098435222,"guid":"5574f489-91b9-4b04-b921-c234c9f5aaf4","subtype":"command","commandType":"auto","position":10.0,"command":"datetimesDF.show(truncate=False)","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+----------+-----------------------+\n|date      |time                   |\n+----------+-----------------------+\n|2014-02-28|2014-02-28 10:00:00.123|\n|2016-02-29|2016-02-29 08:08:08.999|\n|2017-10-31|2017-12-31 11:59:59.123|\n|2019-11-30|2019-08-31 00:00:00.000|\n+----------+-----------------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641160076618,"submitTime":1641160059348,"finishTime":1641160079054,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":{"pycharm":{"name":"#%%\n"}},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"954ca8ec-c653-4712-a2cc-d1785776ae78"},{"version":"CommandV1","origId":1575837098435223,"guid":"2c16c796-1e8c-48ef-b95f-a5314330a076","subtype":"command","commandType":"auto","position":11.0,"command":"%md\n* Add 10 days to both date and time values.\n* Subtract 10 days from both date and time values.","commandVersion":1,"state":"finished","results":{"type":"raw","data":"","arguments":{},"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"7b67718d-6701-4baf-8558-4917d5576d52"},{"version":"CommandV1","origId":1575837098435224,"guid":"1a0cc9a6-9cf8-4a9d-a487-2af1dd42b2e3","subtype":"command","commandType":"auto","position":12.0,"command":"from pyspark.sql.functions import date_add, date_sub","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641160079063,"submitTime":1641160059828,"finishTime":1641160079086,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":{"pycharm":{"name":"#%%\n"}},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"928c4fe9-d43a-49d1-98c9-a9d09187f849"},{"version":"CommandV1","origId":1575837098435225,"guid":"1dd567dc-f35b-4c87-8806-8619e1166f84","subtype":"command","commandType":"auto","position":13.0,"command":"help(date_add)","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Help on function date_add in module pyspark.sql.functions:\n\ndate_add(start, days)\n    Returns the date that is `days` days after `start`\n    \n    .. versionadded:: 1.5.0\n    \n    Examples\n    --------\n    &gt;&gt;&gt; df = spark.createDataFrame([(&#39;2015-04-08&#39;,)], [&#39;dt&#39;])\n    &gt;&gt;&gt; df.select(date_add(df.dt, 1).alias(&#39;next_date&#39;)).collect()\n    [Row(next_date=datetime.date(2015, 4, 9))]\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641160079092,"submitTime":1641160060115,"finishTime":1641160079115,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"ae7fa9e1-aa80-4819-8bea-fe2d341030a5"},{"version":"CommandV1","origId":1575837098435226,"guid":"10091489-515c-453b-9ebb-f87ee384b56b","subtype":"command","commandType":"auto","position":14.0,"command":"help(date_sub)","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Help on function date_sub in module pyspark.sql.functions:\n\ndate_sub(start, days)\n    Returns the date that is `days` days before `start`\n    \n    .. versionadded:: 1.5.0\n    \n    Examples\n    --------\n    &gt;&gt;&gt; df = spark.createDataFrame([(&#39;2015-04-08&#39;,)], [&#39;dt&#39;])\n    &gt;&gt;&gt; df.select(date_sub(df.dt, 1).alias(&#39;prev_date&#39;)).collect()\n    [Row(prev_date=datetime.date(2015, 4, 7))]\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641160079121,"submitTime":1641160060418,"finishTime":1641160079147,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"703e487d-68ce-438d-9f88-ef07e1d72985"},{"version":"CommandV1","origId":1575837098435227,"guid":"ab143afe-13d9-4219-9808-08cb309a3272","subtype":"command","commandType":"auto","position":15.0,"command":"datetimesDF. \\\n    withColumn(\"date_add_date\", date_add(\"date\", 10)). \\\n    withColumn(\"date_add_time\", date_add(\"time\", 10)). \\\n    withColumn(\"date_sub_date\", date_sub(\"date\", 10)). \\\n    withColumn(\"date_sub_time\", date_sub(\"time\", 10)). \\\n    show()","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+----------+--------------------+-------------+-------------+-------------+-------------+\n|      date|                time|date_add_date|date_add_time|date_sub_date|date_sub_time|\n+----------+--------------------+-------------+-------------+-------------+-------------+\n|2014-02-28|2014-02-28 10:00:...|   2014-03-10|   2014-03-10|   2014-02-18|   2014-02-18|\n|2016-02-29|2016-02-29 08:08:...|   2016-03-10|   2016-03-10|   2016-02-19|   2016-02-19|\n|2017-10-31|2017-12-31 11:59:...|   2017-11-10|   2018-01-10|   2017-10-21|   2017-12-21|\n|2019-11-30|2019-08-31 00:00:...|   2019-12-10|   2019-09-10|   2019-11-20|   2019-08-21|\n+----------+--------------------+-------------+-------------+-------------+-------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641160079152,"submitTime":1641160060733,"finishTime":1641160079638,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":{"pycharm":{"name":"#%%\n"}},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"de3aa7ce-7553-4d16-92cc-c6016d99037e"},{"version":"CommandV1","origId":1575837098435228,"guid":"0931d5ec-c7bc-480b-b8eb-40665e593822","subtype":"command","commandType":"auto","position":16.0,"command":"%md\n* Get the difference between current_date and date values as well as current_timestamp and time values.","commandVersion":1,"state":"finished","results":{"type":"raw","data":"","arguments":{},"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"171e4075-8f88-4449-99f4-a80471b07be8"},{"version":"CommandV1","origId":1575837098435229,"guid":"936526d8-6319-4b93-9bf8-663d59203fd5","subtype":"command","commandType":"auto","position":17.0,"command":"from pyspark.sql.functions import current_date, current_timestamp, datediff","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641160079649,"submitTime":1641160061132,"finishTime":1641160079672,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":{"pycharm":{"name":"#%%\n"}},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"92b8a45b-a2b1-4739-8989-f4158f449bd8"},{"version":"CommandV1","origId":1575837098435230,"guid":"4b08c784-efdd-46c6-8710-0dfd4d1f376c","subtype":"command","commandType":"auto","position":18.0,"command":"datetimesDF. \\\n    withColumn(\"datediff_date\", datediff(current_date(), \"date\")). \\\n    withColumn(\"datediff_time\", datediff(current_timestamp(), \"time\")). \\\n    show()","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+----------+--------------------+-------------+-------------+\n|      date|                time|datediff_date|datediff_time|\n+----------+--------------------+-------------+-------------+\n|2014-02-28|2014-02-28 10:00:...|         2865|         2865|\n|2016-02-29|2016-02-29 08:08:...|         2134|         2134|\n|2017-10-31|2017-12-31 11:59:...|         1524|         1463|\n|2019-11-30|2019-08-31 00:00:...|          764|          855|\n+----------+--------------------+-------------+-------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641160079677,"submitTime":1641160061465,"finishTime":1641160079983,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":{"pycharm":{"name":"#%%\n"}},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"60d23832-bd9e-4fa8-ab6f-15ad25becbf2"},{"version":"CommandV1","origId":1575837098435231,"guid":"fb4184e9-282d-44d3-8c6f-11190f1fe930","subtype":"command","commandType":"auto","position":19.0,"command":"%md\n* Get the number of months between current_date and date values as well as current_timestamp and time values.\n* Add 3 months to both date values as well as time values.","commandVersion":1,"state":"finished","results":{"type":"raw","data":"","arguments":{},"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"55b21f07-7e54-4eee-aa9e-7ce7e964c207"},{"version":"CommandV1","origId":1575837098435232,"guid":"7ca0c082-b5c0-4331-9a4c-c31f1143feea","subtype":"command","commandType":"auto","position":20.0,"command":"from pyspark.sql.functions import months_between, add_months, round","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641160079994,"submitTime":1641160061890,"finishTime":1641160080009,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":{"pycharm":{"name":"#%%\n"}},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"6d43730c-a779-4697-86b5-8c3821b401e4"},{"version":"CommandV1","origId":1575837098435233,"guid":"e5fb8bfa-a46c-47c3-8ee1-791edc9ee3fb","subtype":"command","commandType":"auto","position":21.0,"command":"datetimesDF. \\\n    withColumn(\"months_between_date\", round(months_between(current_date(), \"date\"), 2)). \\\n    withColumn(\"months_between_time\", round(months_between(current_timestamp(), \"time\"), 2)). \\\n    withColumn(\"add_months_date\", add_months(\"date\", 3)). \\\n    withColumn(\"add_months_time\", add_months(\"time\", 3)). \\\n    show(truncate=False)","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+----------+-----------------------+-------------------+-------------------+---------------+---------------+\n|date      |time                   |months_between_date|months_between_time|add_months_date|add_months_time|\n+----------+-----------------------+-------------------+-------------------+---------------+---------------+\n|2014-02-28|2014-02-28 10:00:00.123|94.16              |94.18              |2014-05-28     |2014-05-28     |\n|2016-02-29|2016-02-29 08:08:08.999|70.13              |70.15              |2016-05-29     |2016-05-29     |\n|2017-10-31|2017-12-31 11:59:59.123|50.06              |48.08              |2018-01-31     |2018-03-31     |\n|2019-11-30|2019-08-31 00:00:00.000|25.1               |28.09              |2020-02-29     |2019-11-30     |\n+----------+-----------------------+-------------------+-------------------+---------------+---------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641160080016,"submitTime":1641160062227,"finishTime":1641160080605,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":{"pycharm":{"name":"#%%\n"}},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"ab851b7a-11b3-45d8-96a7-05d4e111aec6"},{"version":"CommandV1","origId":1575837098435234,"guid":"0bb82fb0-a481-4faa-b108-2ebddfe04efc","subtype":"command","commandType":"auto","position":22.0,"command":"","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"fd30000d-60ad-4b5d-8d67-ed23793f05fe"}],"dashboards":[],"guid":"23f8a7ac-7229-4b13-b67f-9a1e50eac99a","globalVars":{},"iPythonMetadata":{"nbformat":4,"IPythonMetadata":{"kernelspec":{"display_name":"Pyspark 2","language":"python","name":"pyspark2"},"language_info":{"mimetype":"text/x-python","name":"python","pygments_lexer":"ipython3","codemirror_mode":{"name":"ipython","version":3},"version":"3.6.12","nbconvert_exporter":"python","file_extension":".py"}}},"inputWidgets":{},"notebookMetadata":{"pythonIndentUnit":4}}