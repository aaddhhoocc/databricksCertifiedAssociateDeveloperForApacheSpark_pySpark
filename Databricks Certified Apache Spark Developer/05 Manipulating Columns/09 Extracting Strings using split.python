{"version":"NotebookV1","origId":1575837098435235,"name":"09 Extracting Strings using split","language":"python","commands":[{"version":"CommandV1","origId":1575837098435236,"guid":"5088771d-7b42-455b-962a-999d095ca6db","subtype":"command","commandType":"auto","position":1.0,"command":"%md\n## Extracting Strings using split\nLet us understand how to extract substrings from main string using `split` function.","commandVersion":1,"state":"finished","results":{"type":"raw","data":"","arguments":{},"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"0410e99f-dabb-47cf-a383-aca12cb2a022"},{"version":"CommandV1","origId":1575837098435237,"guid":"89bbaef8-ac9b-4f36-82c9-3f6a13b04c61","subtype":"command","commandType":"auto","position":3.0,"command":"%md\n* If we are processing **variable length columns** with **delimiter** then we use `split` to extract the information.\n* Here are some of the examples for **variable length columns** and the use cases for which we typically extract information.\n* Address where we store House Number, Street Name, City, State and Zip Code comma separated. We might want to extract City and State for demographics reports.\n* `split` takes 2 arguments, **column** and **delimiter**.\n* `split` convert each string into array and we can access the elements using index.\n* We can also use `explode` in conjunction with `split` to explode the list or array into records in Data Frame. It can be used in cases such as word count, phone count etc. ","commandVersion":1,"state":"finished","results":{"type":"raw","data":"","arguments":{},"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"9c11d52b-cc94-477b-ad23-36493bcc0294"},{"version":"CommandV1","origId":1575837098435238,"guid":"3459084a-def8-4500-983f-7bf4db38c549","subtype":"command","commandType":"auto","position":7.0,"command":"l = [('X', )]","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641159890854,"submitTime":1641159889426,"finishTime":1641159890885,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"c68611d4-5e34-45fb-b2bf-bd6ce1a590df"},{"version":"CommandV1","origId":1575837098435239,"guid":"450c619c-86ec-4ecd-9767-5cb0666044ac","subtype":"command","commandType":"auto","position":8.0,"command":"df = spark.createDataFrame(l, \"dummy STRING\")","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"dummy","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641159890891,"submitTime":1641159889974,"finishTime":1641159891204,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"51d73cbd-fab0-46b2-8d68-778ae222a0e6"},{"version":"CommandV1","origId":1575837098435240,"guid":"2faac572-781b-4a18-b40d-416df5b98fb7","subtype":"command","commandType":"auto","position":9.0,"command":"from pyspark.sql.functions import split, explode, lit","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641159891210,"submitTime":1641159890536,"finishTime":1641159891225,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":{"pycharm":{"name":"#%%\n"}},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"1695d445-5069-4605-b37a-fd5edfc9d297"},{"version":"CommandV1","origId":1575837098435241,"guid":"9ba52ef7-035a-40bb-a533-8c92079e61e0","subtype":"command","commandType":"auto","position":10.0,"command":"df.select(split(lit(\"Hello World, how are you\"), \" \")). \\\n    show(truncate=False)","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+--------------------------------------+\n|split(Hello World, how are you,  , -1)|\n+--------------------------------------+\n|[Hello, World,, how, are, you]        |\n+--------------------------------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641159891231,"submitTime":1641159891092,"finishTime":1641159891906,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":{"pycharm":{"name":"#%%\n"}},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"a104f738-8770-4262-9ffc-38e319dbc3ab"},{"version":"CommandV1","origId":1575837098435242,"guid":"c788b895-34ae-4405-9795-318eb8e4f4df","subtype":"command","commandType":"auto","position":11.0,"command":"df.select(split(lit(\"Hello World, how are you\"), \" \")[2]). \\\n    show(truncate=False)","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+-----------------------------------------+\n|split(Hello World, how are you,  , -1)[2]|\n+-----------------------------------------+\n|how                                      |\n+-----------------------------------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641159891919,"submitTime":1641159891532,"finishTime":1641159892110,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":{"pycharm":{"name":"#%%\n"}},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"bd18ef74-5b28-45b2-b1b1-3a7d9cdb3b29"},{"version":"CommandV1","origId":1575837098435243,"guid":"999041cf-00bf-47e1-af41-986d906088eb","subtype":"command","commandType":"auto","position":12.0,"command":"df.select(explode(split(lit(\"Hello World, how are you\"), \" \")).alias('word')). \\\n    show(truncate=False)","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+------+\n|word  |\n+------+\n|Hello |\n|World,|\n|how   |\n|are   |\n|you   |\n+------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641159892291,"submitTime":1641159892273,"finishTime":1641159892515,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"24444a25-3783-4304-8455-300f38b519a4"},{"version":"CommandV1","origId":1575837098435244,"guid":"03fc9179-0e08-4b6e-9254-456df5f2852c","subtype":"command","commandType":"auto","position":13.0,"command":"%md\n* Most of the problems can be solved either by using `substring` or `split`.","commandVersion":1,"state":"finished","results":{"type":"raw","data":"","arguments":{},"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"389f5d0a-383b-4f90-99a0-5b4b3b46d3b5"},{"version":"CommandV1","origId":1575837098435245,"guid":"f43280e4-eede-477e-8cd4-71eea88b5b2a","subtype":"command","commandType":"auto","position":14.0,"command":"%md\n### Tasks - split\nLet us perform few tasks to extract information from fixed length strings as well as delimited variable length strings.\n* Create a list for employees with name, ssn and phone_numbers.\n* SSN Format **3 2 4** - Fixed Length with 11 characters\n* Phone Number Format - Country Code is variable and remaining phone number have 10 digits. One can have multiple phone numbers where they are separated by `,`:\n * Country Code - one to 3 digits\n * Area Code - 3 digits\n * Phone Number Prefix - 3 digits\n * Phone Number Remaining - 4 digits\n * All the 4 parts are separated by spaces\n* Create a Dataframe with column names name, ssn and phone_number\n* Extract area code and last 4 digits from the phone number.\n* Extract last 4 digits from SSN.","commandVersion":1,"state":"finished","results":{"type":"raw","data":"","arguments":{},"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"b08ab55b-96a5-48f1-8f10-6f77531e25d8"},{"version":"CommandV1","origId":1575837098435246,"guid":"ba8bc8bc-c183-4d56-812b-0f2403fb8c3d","subtype":"command","commandType":"auto","position":15.0,"command":"employees = [(1, \"Scott\", \"Tiger\", 1000.0, \n                      \"united states\", \"+1 123 456 7890,+1 234 567 8901\", \"123 45 6789\"\n                     ),\n                     (2, \"Henry\", \"Ford\", 1250.0, \n                      \"India\", \"+91 234 567 8901\", \"456 78 9123\"\n                     ),\n                     (3, \"Nick\", \"Junior\", 750.0, \n                      \"united KINGDOM\", \"+44 111 111 1111,+44 222 222 2222\", \"222 33 4444\"\n                     ),\n                     (4, \"Bill\", \"Gomes\", 1500.0, \n                      \"AUSTRALIA\", \"+61 987 654 3210,+61 876 543 2109\", \"789 12 6118\"\n                     )\n                ]","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641159894629,"submitTime":1641159894610,"finishTime":1641159894649,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"032e7399-dea8-48c3-aeca-cc81822e2c35"},{"version":"CommandV1","origId":1575837098435247,"guid":"e9b10942-078d-45e5-bd2c-0c1d58590b10","subtype":"command","commandType":"auto","position":16.0,"command":"employeesDF = spark. \\\n    createDataFrame(employees,\n                    schema=\"\"\"employee_id INT, first_name STRING, \n                    last_name STRING, salary FLOAT, nationality STRING,\n                    phone_numbers STRING, ssn STRING\"\"\"\n                   )","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"employeesDF","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"employee_id","nullable":true,"type":"integer"},{"metadata":{},"name":"first_name","nullable":true,"type":"string"},{"metadata":{},"name":"last_name","nullable":true,"type":"string"},{"metadata":{},"name":"salary","nullable":true,"type":"float"},{"metadata":{},"name":"nationality","nullable":true,"type":"string"},{"metadata":{},"name":"phone_numbers","nullable":true,"type":"string"},{"metadata":{},"name":"ssn","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641159895350,"submitTime":1641159895330,"finishTime":1641159895440,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"48f8bacb-272d-4914-830b-052e766c5223"},{"version":"CommandV1","origId":1575837098435248,"guid":"4aed9c8c-b4af-417a-80d4-d081874ba1bd","subtype":"command","commandType":"auto","position":17.0,"command":"employeesDF. \\\n    select('employee_id', 'phone_numbers'). \\\n    show(truncate=False)","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+-----------+---------------------------------+\n|employee_id|phone_numbers                    |\n+-----------+---------------------------------+\n|1          |+1 123 456 7890,+1 234 567 8901  |\n|2          |+91 234 567 8901                 |\n|3          |+44 111 111 1111,+44 222 222 2222|\n|4          |+61 987 654 3210,+61 876 543 2109|\n+-----------+---------------------------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641159896248,"submitTime":1641159896230,"finishTime":1641159896430,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"72886f49-31e6-45db-826f-2f2826832aae"},{"version":"CommandV1","origId":1575837098435249,"guid":"b5faed8a-62ea-40fc-bb88-f794fcea1c48","subtype":"command","commandType":"auto","position":18.0,"command":"from pyspark.sql.functions import split, explode","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641159897126,"submitTime":1641159897107,"finishTime":1641159897143,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":{"pycharm":{"name":"#%%\n"}},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"905f7d84-a42f-4000-906b-a5b5403b1236"},{"version":"CommandV1","origId":1575837098435250,"guid":"06448267-2edf-4fbb-ae11-8ee87c465fd7","subtype":"command","commandType":"auto","position":19.0,"command":"employeesDF = employeesDF. \\\n    select('employee_id', 'phone_numbers', 'ssn'). \\\n    withColumn('phone_number', explode(split('phone_numbers', ',')))","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"employeesDF","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"employee_id","nullable":true,"type":"integer"},{"metadata":{},"name":"phone_numbers","nullable":true,"type":"string"},{"metadata":{},"name":"ssn","nullable":true,"type":"string"},{"metadata":{},"name":"phone_number","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641159898127,"submitTime":1641159898109,"finishTime":1641159898183,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":{"pycharm":{"name":"#%%\n"}},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"5b1662dd-5051-45d0-974b-ff179206e350"},{"version":"CommandV1","origId":1575837098435251,"guid":"3b9cc555-23ce-4cb8-b5aa-9731d9d23b17","subtype":"command","commandType":"auto","position":20.0,"command":"employeesDF.show(truncate=False)","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+-----------+---------------------------------+-----------+----------------+\n|employee_id|phone_numbers                    |ssn        |phone_number    |\n+-----------+---------------------------------+-----------+----------------+\n|1          |+1 123 456 7890,+1 234 567 8901  |123 45 6789|+1 123 456 7890 |\n|1          |+1 123 456 7890,+1 234 567 8901  |123 45 6789|+1 234 567 8901 |\n|2          |+91 234 567 8901                 |456 78 9123|+91 234 567 8901|\n|3          |+44 111 111 1111,+44 222 222 2222|222 33 4444|+44 111 111 1111|\n|3          |+44 111 111 1111,+44 222 222 2222|222 33 4444|+44 222 222 2222|\n|4          |+61 987 654 3210,+61 876 543 2109|789 12 6118|+61 987 654 3210|\n|4          |+61 987 654 3210,+61 876 543 2109|789 12 6118|+61 876 543 2109|\n+-----------+---------------------------------+-----------+----------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641159899400,"submitTime":1641159899380,"finishTime":1641159899628,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"48bc1fc4-7821-41de-84b1-6ce42f2698ca"},{"version":"CommandV1","origId":1575837098435252,"guid":"a31344dd-f0ad-4e71-a6e2-57342a2f1ad2","subtype":"command","commandType":"auto","position":21.0,"command":"employeesDF. \\\n    select(\"employee_id\", \"phone_number\", \"ssn\"). \\\n    withColumn(\"area_code\", split(\"phone_number\", \" \")[1].cast(\"int\")). \\\n    withColumn(\"phone_last4\", split(\"phone_number\", \" \")[3].cast(\"int\")). \\\n    withColumn(\"ssn_last4\", split(\"ssn\", \" \")[2].cast(\"int\")). \\\n    show()","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+-----------+----------------+-----------+---------+-----------+---------+\n|employee_id|    phone_number|        ssn|area_code|phone_last4|ssn_last4|\n+-----------+----------------+-----------+---------+-----------+---------+\n|          1| +1 123 456 7890|123 45 6789|      123|       7890|     6789|\n|          1| +1 234 567 8901|123 45 6789|      234|       8901|     6789|\n|          2|+91 234 567 8901|456 78 9123|      234|       8901|     9123|\n|          3|+44 111 111 1111|222 33 4444|      111|       1111|     4444|\n|          3|+44 222 222 2222|222 33 4444|      222|       2222|     4444|\n|          4|+61 987 654 3210|789 12 6118|      987|       3210|     6118|\n|          4|+61 876 543 2109|789 12 6118|      876|       2109|     6118|\n+-----------+----------------+-----------+---------+-----------+---------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641159900384,"submitTime":1641159900365,"finishTime":1641159900903,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"06329261-c618-4722-bdf1-a54322f6a88c"},{"version":"CommandV1","origId":1575837098435253,"guid":"68a717e1-1a9b-4f66-b6ae-c6797df5879c","subtype":"command","commandType":"auto","position":22.0,"command":"%md\n* Getting Phone Count","commandVersion":1,"state":"finished","results":{"type":"raw","data":"","arguments":{},"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"d21a4414-c582-41e3-80f4-e3a62eda605a"},{"version":"CommandV1","origId":1575837098435254,"guid":"d15eb9e8-d8bd-4c4d-8435-97c34daf1854","subtype":"command","commandType":"auto","position":23.0,"command":"employeesDF.show(truncate=False)","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+-----------+---------------------------------+-----------+----------------+\n|employee_id|phone_numbers                    |ssn        |phone_number    |\n+-----------+---------------------------------+-----------+----------------+\n|1          |+1 123 456 7890,+1 234 567 8901  |123 45 6789|+1 123 456 7890 |\n|1          |+1 123 456 7890,+1 234 567 8901  |123 45 6789|+1 234 567 8901 |\n|2          |+91 234 567 8901                 |456 78 9123|+91 234 567 8901|\n|3          |+44 111 111 1111,+44 222 222 2222|222 33 4444|+44 111 111 1111|\n|3          |+44 111 111 1111,+44 222 222 2222|222 33 4444|+44 222 222 2222|\n|4          |+61 987 654 3210,+61 876 543 2109|789 12 6118|+61 987 654 3210|\n|4          |+61 987 654 3210,+61 876 543 2109|789 12 6118|+61 876 543 2109|\n+-----------+---------------------------------+-----------+----------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641159902753,"submitTime":1641159902734,"finishTime":1641159902958,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"6097e1a9-c37d-41ad-8872-38b5241e610f"},{"version":"CommandV1","origId":1575837098435255,"guid":"82349892-a4b3-4a38-b625-b3513839cc9f","subtype":"command","commandType":"auto","position":24.0,"command":"employeesDF. \\\n    groupBy('employee_id'). \\\n    count(). \\\n    show()","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+-----------+-----+\n|employee_id|count|\n+-----------+-----+\n|          1|    2|\n|          2|    1|\n|          3|    2|\n|          4|    2|\n+-----------+-----+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641159904227,"submitTime":1641159904206,"finishTime":1641159904914,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"b585bd5e-c51e-401e-a19e-02ef91ed3b27"},{"version":"CommandV1","origId":1575837098435256,"guid":"f9057ca8-e304-453a-8f73-ff476081c1ea","subtype":"command","commandType":"auto","position":25.0,"command":"","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":[],"yColumns":[],"pivotColumns":[],"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"59c01eb5-153a-4fd8-a198-a514ec465c52"}],"dashboards":[],"guid":"35c72349-cef4-439a-a885-9b4ab4a9e8c3","globalVars":{},"iPythonMetadata":{"nbformat":4,"IPythonMetadata":{"kernelspec":{"display_name":"Pyspark 2","language":"python","name":"pyspark2"},"language_info":{"mimetype":"text/x-python","name":"python","pygments_lexer":"ipython3","codemirror_mode":{"name":"ipython","version":3},"version":"3.6.12","nbconvert_exporter":"python","file_extension":".py"}}},"inputWidgets":{},"notebookMetadata":{"pythonIndentUnit":4}}