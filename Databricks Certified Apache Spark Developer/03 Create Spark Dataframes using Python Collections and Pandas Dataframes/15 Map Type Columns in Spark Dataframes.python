{"version":"NotebookV1","origId":1575837098435835,"name":"15 Map Type Columns in Spark Dataframes","language":"python","commands":[{"version":"CommandV1","origId":1575837098435836,"guid":"71a076a9-b69d-4157-9701-1ab34d74e148","subtype":"command","commandType":"auto","position":1.0,"command":"import datetime\nusers = [\n    {\n        \"id\": 1,\n        \"first_name\": \"Corrie\",\n        \"last_name\": \"Van den Oord\",\n        \"email\": \"cvandenoord0@etsy.com\",\n        \"phone_numbers\": {\"mobile\": \"+1 234 567 8901\", \"home\": \"+1 234 567 8911\"},\n        \"is_customer\": True,\n        \"amount_paid\": 1000.55,\n        \"customer_from\": datetime.date(2021, 1, 15),\n        \"last_updated_ts\": datetime.datetime(2021, 2, 10, 1, 15, 0)\n    },\n    {\n        \"id\": 2,\n        \"first_name\": \"Nikolaus\",\n        \"last_name\": \"Brewitt\",\n        \"email\": \"nbrewitt1@dailymail.co.uk\",\n        \"phone_numbers\": {\"mobile\": \"+1 234 567 8923\", \"home\": \"+1 234 567 8934\"},\n        \"is_customer\": True,\n        \"amount_paid\": 900.0,\n        \"customer_from\": datetime.date(2021, 2, 14),\n        \"last_updated_ts\": datetime.datetime(2021, 2, 18, 3, 33, 0)\n    },\n    {\n        \"id\": 3,\n        \"first_name\": \"Orelie\",\n        \"last_name\": \"Penney\",\n        \"email\": \"openney2@vistaprint.com\",\n        \"phone_numbers\": {\"mobile\": \"+1 714 512 9752\", \"home\": \"+1 714 512 6601\"},\n        \"is_customer\": True,\n        \"amount_paid\": 850.55,\n        \"customer_from\": datetime.date(2021, 1, 21),\n        \"last_updated_ts\": datetime.datetime(2021, 3, 15, 15, 16, 55)\n    },\n    {\n        \"id\": 4,\n        \"first_name\": \"Ashby\",\n        \"last_name\": \"Maddocks\",\n        \"email\": \"amaddocks3@home.pl\",\n        \"phone_numbers\": None,\n        \"is_customer\": False,\n        \"amount_paid\": None,\n        \"customer_from\": None,\n        \"last_updated_ts\": datetime.datetime(2021, 4, 10, 17, 45, 30)\n    },\n    {\n        \"id\": 5,\n        \"first_name\": \"Kurt\",\n        \"last_name\": \"Rome\",\n        \"email\": \"krome4@shutterfly.com\",\n        \"phone_numbers\": {\"mobile\": \"+1 817 934 7142\"},\n        \"is_customer\": False,\n        \"amount_paid\": None,\n        \"customer_from\": None,\n        \"last_updated_ts\": datetime.datetime(2021, 4, 2, 0, 55, 18)\n    }\n]","commandVersion":372,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641228035279,"submitTime":1641228035253,"finishTime":1641228035308,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"14b6a601-2c96-46ed-a857-cb5a9a477a4a"},{"version":"CommandV1","origId":1575837098435837,"guid":"c4479acb-a84c-4de6-85d2-7ec81d556239","subtype":"command","commandType":"auto","position":1.125,"command":"from pyspark.sql import Row","commandVersion":5,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641228035794,"submitTime":1641228035771,"finishTime":1641228035814,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"104ef160-8e2f-4472-a38b-b79d1f2e7cf8"},{"version":"CommandV1","origId":1575837098435838,"guid":"baa1f091-2bd2-4b6e-86ab-b4e6bb63dd33","subtype":"command","commandType":"auto","position":1.25,"command":"users_df = spark.createDataFrame([Row(**user) for user in users])","commandVersion":24,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"users_df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"id","nullable":true,"type":"long"},{"metadata":{},"name":"first_name","nullable":true,"type":"string"},{"metadata":{},"name":"last_name","nullable":true,"type":"string"},{"metadata":{},"name":"email","nullable":true,"type":"string"},{"metadata":{},"name":"phone_numbers","nullable":true,"type":{"keyType":"string","type":"map","valueContainsNull":true,"valueType":"string"}},{"metadata":{},"name":"is_customer","nullable":true,"type":"boolean"},{"metadata":{},"name":"amount_paid","nullable":true,"type":"double"},{"metadata":{},"name":"customer_from","nullable":true,"type":"date"},{"metadata":{},"name":"last_updated_ts","nullable":true,"type":"timestamp"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641228036398,"submitTime":1641228036375,"finishTime":1641228036676,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"5e82d7d9-94a3-4ec6-a038-6f87e0ef1ea4"},{"version":"CommandV1","origId":1575837098435839,"guid":"ae57e910-a4b2-4037-b001-7540d61358ec","subtype":"command","commandType":"auto","position":4.25,"command":"users_df.printSchema()","commandVersion":3,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">root\n |-- id: long (nullable = true)\n |-- first_name: string (nullable = true)\n |-- last_name: string (nullable = true)\n |-- email: string (nullable = true)\n |-- phone_numbers: map (nullable = true)\n |    |-- key: string\n |    |-- value: string (valueContainsNull = true)\n |-- is_customer: boolean (nullable = true)\n |-- amount_paid: double (nullable = true)\n |-- customer_from: date (nullable = true)\n |-- last_updated_ts: timestamp (nullable = true)\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641228036903,"submitTime":1641228036877,"finishTime":1641228036923,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"fcff524d-53d4-478f-bc95-0575c23ce874"},{"version":"CommandV1","origId":1575837098435840,"guid":"abc457fc-eda2-4294-9a55-48bb34c8cd1b","subtype":"command","commandType":"auto","position":5.25,"command":"users_df.show()","commandVersion":3,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+---+----------+------------+--------------------+--------------------+-----------+-----------+-------------+-------------------+\n| id|first_name|   last_name|               email|       phone_numbers|is_customer|amount_paid|customer_from|    last_updated_ts|\n+---+----------+------------+--------------------+--------------------+-----------+-----------+-------------+-------------------+\n|  1|    Corrie|Van den Oord|cvandenoord0@etsy...|{mobile -&gt; +1 234...|       true|    1000.55|   2021-01-15|2021-02-10 01:15:00|\n|  2|  Nikolaus|     Brewitt|nbrewitt1@dailyma...|{mobile -&gt; +1 234...|       true|      900.0|   2021-02-14|2021-02-18 03:33:00|\n|  3|    Orelie|      Penney|openney2@vistapri...|{mobile -&gt; +1 714...|       true|     850.55|   2021-01-21|2021-03-15 15:16:55|\n|  4|     Ashby|    Maddocks|  amaddocks3@home.pl|                null|      false|       null|         null|2021-04-10 17:45:30|\n|  5|      Kurt|        Rome|krome4@shutterfly...|{mobile -&gt; +1 817...|      false|       null|         null|2021-04-02 00:55:18|\n+---+----------+------------+--------------------+--------------------+-----------+-----------+-------------+-------------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641228037399,"submitTime":1641228037375,"finishTime":1641228037926,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"448b5ea5-82ea-4824-8038-2149d7bd65c6"},{"version":"CommandV1","origId":1575837098435841,"guid":"07ec6ab4-9b04-4a06-9fa6-73a7eeaa413f","subtype":"command","commandType":"auto","position":5.75,"command":"users_df.select('id', 'phone_numbers').show(truncate=False)","commandVersion":11,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+---+----------------------------------------------------+\n|id |phone_numbers                                       |\n+---+----------------------------------------------------+\n|1  |{mobile -&gt; +1 234 567 8901, home -&gt; +1 234 567 8911}|\n|2  |{mobile -&gt; +1 234 567 8923, home -&gt; +1 234 567 8934}|\n|3  |{mobile -&gt; +1 714 512 9752, home -&gt; +1 714 512 6601}|\n|4  |null                                                |\n|5  |{mobile -&gt; +1 817 934 7142}                         |\n+---+----------------------------------------------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641228038438,"submitTime":1641228038414,"finishTime":1641228038673,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"9704dac6-f1c7-41d6-81f9-33812c76ff8d"},{"version":"CommandV1","origId":1575837098435842,"guid":"2eb5d544-5d42-4fd3-9d97-1ae1796b5e9e","subtype":"command","commandType":"auto","position":6.25,"command":"users_df.columns","commandVersion":4,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Out[7]: [&#39;id&#39;,\n &#39;first_name&#39;,\n &#39;last_name&#39;,\n &#39;email&#39;,\n &#39;phone_numbers&#39;,\n &#39;is_customer&#39;,\n &#39;amount_paid&#39;,\n &#39;customer_from&#39;,\n &#39;last_updated_ts&#39;]</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641228047905,"submitTime":1641228047882,"finishTime":1641228047925,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"df73dd08-7a26-4d5b-9999-bb8026d0e0bc"},{"version":"CommandV1","origId":1575837098435843,"guid":"9455fdf9-1edf-4bf0-ad0f-acf780c73a58","subtype":"command","commandType":"auto","position":7.25,"command":"users_df.dtypes","commandVersion":3,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Out[8]: [(&#39;id&#39;, &#39;bigint&#39;),\n (&#39;first_name&#39;, &#39;string&#39;),\n (&#39;last_name&#39;, &#39;string&#39;),\n (&#39;email&#39;, &#39;string&#39;),\n (&#39;phone_numbers&#39;, &#39;map&lt;string,string&gt;&#39;),\n (&#39;is_customer&#39;, &#39;boolean&#39;),\n (&#39;amount_paid&#39;, &#39;double&#39;),\n (&#39;customer_from&#39;, &#39;date&#39;),\n (&#39;last_updated_ts&#39;, &#39;timestamp&#39;)]</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641228048448,"submitTime":1641228048423,"finishTime":1641228048467,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"6a62712c-a94f-4f33-b4e9-7fb65b74cc45"},{"version":"CommandV1","origId":1575837098435844,"guid":"a9d7f69e-fe64-4e72-b96f-fa4faa230cfb","subtype":"command","commandType":"auto","position":9.25,"command":"from pyspark.sql.functions import col","commandVersion":7,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641228058261,"submitTime":1641228058224,"finishTime":1641228058277,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"cd2969de-115e-4c31-9e6c-23532b6f91c9"},{"version":"CommandV1","origId":1575837098435845,"guid":"abe9c4de-fea6-49a6-8d97-c7318aa622c2","subtype":"command","commandType":"auto","position":11.25,"command":"users_df.select('id', col('phone_numbers')['mobile']).show()","commandVersion":24,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+---+---------------------+\n| id|phone_numbers[mobile]|\n+---+---------------------+\n|  1|      +1 234 567 8901|\n|  2|      +1 234 567 8923|\n|  3|      +1 714 512 9752|\n|  4|                 null|\n|  5|      +1 817 934 7142|\n+---+---------------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641228058885,"submitTime":1641228058862,"finishTime":1641228059260,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"fffab673-ff8c-4d11-8978-63eca0fb54e1"},{"version":"CommandV1","origId":1575837098435846,"guid":"63f09c84-e504-4605-b473-018eddff9701","subtype":"command","commandType":"auto","position":11.5,"command":"users_df.select('id', col('phone_numbers')['mobile'].alias('mobile')).show()","commandVersion":4,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+---+---------------+\n| id|         mobile|\n+---+---------------+\n|  1|+1 234 567 8901|\n|  2|+1 234 567 8923|\n|  3|+1 714 512 9752|\n|  4|           null|\n|  5|+1 817 934 7142|\n+---+---------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641228176963,"submitTime":1641228176914,"finishTime":1641228177139,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"bba58593-1ed6-4bd6-9724-14a41edfa80f"},{"version":"CommandV1","origId":1575837098435847,"guid":"70ac2e36-a4c1-4169-968e-d393710a639f","subtype":"command","commandType":"auto","position":11.625,"command":"users_df. \\\n    select('id', col('phone_numbers')['mobile'].alias('mobile'), col('phone_numbers')['home'].alias('home')). \\\n    show()","commandVersion":7,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+---+---------------+---------------+\n| id|         mobile|           home|\n+---+---------------+---------------+\n|  1|+1 234 567 8901|+1 234 567 8911|\n|  2|+1 234 567 8923|+1 234 567 8934|\n|  3|+1 714 512 9752|+1 714 512 6601|\n|  4|           null|           null|\n|  5|+1 817 934 7142|           null|\n+---+---------------+---------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641228219728,"submitTime":1641228219704,"finishTime":1641228220133,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"9a6811d1-51a4-4309-be92-42b3d28b0f65"},{"version":"CommandV1","origId":1575837098435848,"guid":"dec2b6ec-41aa-4573-bd1e-1a272060b0ae","subtype":"command","commandType":"auto","position":11.75,"command":"from pyspark.sql.functions import explode","commandVersion":5,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641228398557,"submitTime":1641228398516,"finishTime":1641228398573,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"83f4d537-2c94-4de3-9aef-bbc49b3fc797"},{"version":"CommandV1","origId":1575837098435849,"guid":"725d3846-d83a-43e6-9021-ac2cefa640c4","subtype":"command","commandType":"auto","position":12.0,"command":"users_df.select('id', explode('phone_numbers')).show()","commandVersion":12,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+---+------+---------------+\n| id|   key|          value|\n+---+------+---------------+\n|  1|mobile|+1 234 567 8901|\n|  1|  home|+1 234 567 8911|\n|  2|mobile|+1 234 567 8923|\n|  2|  home|+1 234 567 8934|\n|  3|mobile|+1 714 512 9752|\n|  3|  home|+1 714 512 6601|\n|  5|mobile|+1 817 934 7142|\n+---+------+---------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641228400071,"submitTime":1641228400046,"finishTime":1641228400323,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"60fd183f-2e61-41db-a545-5de75fccc67c"},{"version":"CommandV1","origId":1575837098435850,"guid":"d3c5057a-2da5-42f6-af0e-f2d97aa173b6","subtype":"command","commandType":"auto","position":12.125,"command":"from pyspark.sql.functions import explode_outer","commandVersion":3,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641228459873,"submitTime":1641228459843,"finishTime":1641228459889,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"77ce2f46-80a8-4b70-b232-74bc4eb5013e"},{"version":"CommandV1","origId":1575837098435851,"guid":"9cef0a88-3fb3-4adf-b85a-a9bcd523074e","subtype":"command","commandType":"auto","position":12.1875,"command":"users_df.select('id', explode_outer('phone_numbers')).show()","commandVersion":2,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+---+------+---------------+\n| id|   key|          value|\n+---+------+---------------+\n|  1|mobile|+1 234 567 8901|\n|  1|  home|+1 234 567 8911|\n|  2|mobile|+1 234 567 8923|\n|  2|  home|+1 234 567 8934|\n|  3|mobile|+1 714 512 9752|\n|  3|  home|+1 714 512 6601|\n|  4|  null|           null|\n|  5|mobile|+1 817 934 7142|\n+---+------+---------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641228470472,"submitTime":1641228470446,"finishTime":1641228470783,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"96ac79c2-1128-4d6f-a143-888c843bcb63"},{"version":"CommandV1","origId":1575837098435852,"guid":"f50f9481-e216-49c0-80c4-bffb9732a077","subtype":"command","commandType":"auto","position":12.25,"command":"users_df.select('*', explode('phone_numbers')). \\\n    withColumnRenamed('key', 'phone_type'). \\\n    withColumnRenamed('value', 'phone_number'). \\\n    drop('phone_numbers'). \\\n    show()","commandVersion":67,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+---+----------+------------+--------------------+-----------+-----------+-------------+-------------------+----------+---------------+\n| id|first_name|   last_name|               email|is_customer|amount_paid|customer_from|    last_updated_ts|phone_type|   phone_number|\n+---+----------+------------+--------------------+-----------+-----------+-------------+-------------------+----------+---------------+\n|  1|    Corrie|Van den Oord|cvandenoord0@etsy...|       true|    1000.55|   2021-01-15|2021-02-10 01:15:00|    mobile|+1 234 567 8901|\n|  1|    Corrie|Van den Oord|cvandenoord0@etsy...|       true|    1000.55|   2021-01-15|2021-02-10 01:15:00|      home|+1 234 567 8911|\n|  2|  Nikolaus|     Brewitt|nbrewitt1@dailyma...|       true|      900.0|   2021-02-14|2021-02-18 03:33:00|    mobile|+1 234 567 8923|\n|  2|  Nikolaus|     Brewitt|nbrewitt1@dailyma...|       true|      900.0|   2021-02-14|2021-02-18 03:33:00|      home|+1 234 567 8934|\n|  3|    Orelie|      Penney|openney2@vistapri...|       true|     850.55|   2021-01-21|2021-03-15 15:16:55|    mobile|+1 714 512 9752|\n|  3|    Orelie|      Penney|openney2@vistapri...|       true|     850.55|   2021-01-21|2021-03-15 15:16:55|      home|+1 714 512 6601|\n|  5|      Kurt|        Rome|krome4@shutterfly...|      false|       null|         null|2021-04-02 00:55:18|    mobile|+1 817 934 7142|\n+---+----------+------------+--------------------+-----------+-----------+-------------+-------------------+----------+---------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641228666618,"submitTime":1641228666569,"finishTime":1641228666932,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"d2f863c8-6cee-4e90-ad2a-8a863bab8812"},{"version":"CommandV1","origId":1575837098435853,"guid":"36f57432-633b-4ed6-9138-ce0d53b1105f","subtype":"command","commandType":"auto","position":14.25,"command":"","commandVersion":0,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"22c60582-f1d2-4f22-8133-5ff5c2b4b730"}],"dashboards":[],"guid":"c99599c9-eb59-4c1d-a9cc-891673e5167f","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{"pythonIndentUnit":4}}