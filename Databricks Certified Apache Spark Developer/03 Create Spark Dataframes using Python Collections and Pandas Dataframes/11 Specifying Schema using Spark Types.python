{"version":"NotebookV1","origId":1575837098435826,"name":"11 Specifying Schema using Spark Types","language":"python","commands":[{"version":"CommandV1","origId":1575837098435827,"guid":"68aa9f1b-f96b-472a-b1d3-9e998434794a","subtype":"command","commandType":"auto","position":1.0,"command":"import datetime\nusers = [(1,\n  'Corrie',\n  'Van den Oord',\n  'cvandenoord0@etsy.com',\n  True,\n  1000.55,\n  datetime.date(2021, 1, 15),\n  datetime.datetime(2021, 2, 10, 1, 15)),\n (2,\n  'Nikolaus',\n  'Brewitt',\n  'nbrewitt1@dailymail.co.uk',\n  True,\n  900.0,\n  datetime.date(2021, 2, 14),\n  datetime.datetime(2021, 2, 18, 3, 33)),\n (3,\n  'Orelie',\n  'Penney',\n  'openney2@vistaprint.com',\n  True,\n  850.55,\n  datetime.date(2021, 1, 21),\n  datetime.datetime(2021, 3, 15, 15, 16, 55)),\n (4,\n  'Ashby',\n  'Maddocks',\n  'amaddocks3@home.pl',\n  False,\n  None,\n  None,\n  datetime.datetime(2021, 4, 10, 17, 45, 30)),\n (5,\n  'Kurt',\n  'Rome',\n  'krome4@shutterfly.com',\n  False,\n  None,\n  None,\n  datetime.datetime(2021, 4, 2, 0, 55, 18))]","commandVersion":284,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641139185788,"submitTime":1641139183607,"finishTime":1641139185833,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"14b6a601-2c96-46ed-a857-cb5a9a477a4a"},{"version":"CommandV1","origId":1575837098435828,"guid":"c682804d-0a68-4540-b6f5-932239557a0a","subtype":"command","commandType":"auto","position":1.5,"command":"from pyspark.sql.types import *","commandVersion":8,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641139185844,"submitTime":1641139183959,"finishTime":1641139185876,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"bf5f40ac-5f3d-43f9-9172-a9a324772482"},{"version":"CommandV1","origId":1575837098435829,"guid":"73629079-cab6-41f4-bb8c-715aea81f26f","subtype":"command","commandType":"auto","position":1.75,"command":"users_schema = StructType([\n    StructField('id', IntegerType()),\n    StructField('first_name', StringType()),\n    StructField('last_name', StringType()),\n    StructField('email', StringType()),\n    StructField('is_customer', BooleanType()),\n    StructField('amount_paid', FloatType()),\n    StructField('customer_from', DateType()),\n    StructField('last_updated_ts', TimestampType())\n])","commandVersion":55,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641139185889,"submitTime":1641139184286,"finishTime":1641139185917,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"c976ffdc-5e11-45ff-8d28-ed2989debcdb"},{"version":"CommandV1","origId":1575837098435830,"guid":"ffd1b1f4-0798-40e9-b9fe-1f6c11609807","subtype":"command","commandType":"auto","position":1.875,"command":"type(users_schema)","commandVersion":4,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Out[4]: pyspark.sql.types.StructType</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641139185928,"submitTime":1641139184581,"finishTime":1641139185957,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"ff4d814b-146d-46d1-b0b6-04c13e979e2c"},{"version":"CommandV1","origId":1575837098435831,"guid":"6ed34d7b-6465-4048-8f78-3de6e3c955a7","subtype":"command","commandType":"auto","position":2.0,"command":"spark.createDataFrame(users, schema=users_schema)","commandVersion":9,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Out[5]: DataFrame[id: int, first_name: string, last_name: string, email: string, is_customer: boolean, amount_paid: float, customer_from: date, last_updated_ts: timestamp]</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641139185965,"submitTime":1641139184883,"finishTime":1641139186364,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"9551596f-89ab-4c2a-b5a7-dc5653074a49"},{"version":"CommandV1","origId":1575837098435832,"guid":"a7fb299f-b206-41c6-8fae-e49a1fa34705","subtype":"command","commandType":"auto","position":3.0,"command":"spark.createDataFrame(users, schema=users_schema).show()","commandVersion":2,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+---+----------+------------+--------------------+-----------+-----------+-------------+-------------------+\n| id|first_name|   last_name|               email|is_customer|amount_paid|customer_from|    last_updated_ts|\n+---+----------+------------+--------------------+-----------+-----------+-------------+-------------------+\n|  1|    Corrie|Van den Oord|cvandenoord0@etsy...|       true|    1000.55|   2021-01-15|2021-02-10 01:15:00|\n|  2|  Nikolaus|     Brewitt|nbrewitt1@dailyma...|       true|      900.0|   2021-02-14|2021-02-18 03:33:00|\n|  3|    Orelie|      Penney|openney2@vistapri...|       true|     850.55|   2021-01-21|2021-03-15 15:16:55|\n|  4|     Ashby|    Maddocks|  amaddocks3@home.pl|      false|       null|         null|2021-04-10 17:45:30|\n|  5|      Kurt|        Rome|krome4@shutterfly...|      false|       null|         null|2021-04-02 00:55:18|\n+---+----------+------------+--------------------+-----------+-----------+-------------+-------------------+\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641139186388,"submitTime":1641139186235,"finishTime":1641139190452,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"a9c36b6d-82fb-4420-bc4f-f543623ca8b1"},{"version":"CommandV1","origId":1575837098435833,"guid":"cf7897a2-6b6e-4d31-9e1d-7e720040f34d","subtype":"command","commandType":"auto","position":3.5,"command":"spark.createDataFrame(users, schema=users_schema).rdd.collect()","commandVersion":4,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Out[8]: [Row(id=1, first_name=&#39;Corrie&#39;, last_name=&#39;Van den Oord&#39;, email=&#39;cvandenoord0@etsy.com&#39;, is_customer=True, amount_paid=1000.5499877929688, customer_from=datetime.date(2021, 1, 15), last_updated_ts=datetime.datetime(2021, 2, 10, 1, 15)),\n Row(id=2, first_name=&#39;Nikolaus&#39;, last_name=&#39;Brewitt&#39;, email=&#39;nbrewitt1@dailymail.co.uk&#39;, is_customer=True, amount_paid=900.0, customer_from=datetime.date(2021, 2, 14), last_updated_ts=datetime.datetime(2021, 2, 18, 3, 33)),\n Row(id=3, first_name=&#39;Orelie&#39;, last_name=&#39;Penney&#39;, email=&#39;openney2@vistaprint.com&#39;, is_customer=True, amount_paid=850.5499877929688, customer_from=datetime.date(2021, 1, 21), last_updated_ts=datetime.datetime(2021, 3, 15, 15, 16, 55)),\n Row(id=4, first_name=&#39;Ashby&#39;, last_name=&#39;Maddocks&#39;, email=&#39;amaddocks3@home.pl&#39;, is_customer=False, amount_paid=None, customer_from=None, last_updated_ts=datetime.datetime(2021, 4, 10, 17, 45, 30)),\n Row(id=5, first_name=&#39;Kurt&#39;, last_name=&#39;Rome&#39;, email=&#39;krome4@shutterfly.com&#39;, is_customer=False, amount_paid=None, customer_from=None, last_updated_ts=datetime.datetime(2021, 4, 2, 0, 55, 18))]</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641139210531,"submitTime":1641139210579,"finishTime":1641139211189,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"22c5dc89-d5a5-442d-9317-f86f6669fb8d"},{"version":"CommandV1","origId":1575837098435834,"guid":"78faa6ab-1ce3-4516-87a7-da2fb3975c2d","subtype":"command","commandType":"auto","position":4.0,"command":"","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"73969996-d1e0-48e3-b69c-94e721939ad1"}],"dashboards":[],"guid":"2c28c280-c70d-42b6-b150-e1e77c913cd5","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{"pythonIndentUnit":4}}