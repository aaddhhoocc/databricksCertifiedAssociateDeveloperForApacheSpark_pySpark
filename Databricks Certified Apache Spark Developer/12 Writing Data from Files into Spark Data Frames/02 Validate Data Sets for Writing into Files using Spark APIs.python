{"version":"NotebookV1","origId":1575837098434423,"name":"02 Validate Data Sets for Writing into Files using Spark APIs","language":"python","commands":[{"version":"CommandV1","origId":1575837098434424,"guid":"3d72f491-10b5-447a-9ed5-b63bb468a2ef","subtype":"command","commandType":"auto","position":0.5,"command":"%fs ls /public/retail_db","commandVersion":2,"state":"finished","results":{"type":"table","data":[["dbfs:/public/retail_db/categories/","categories/",0],["dbfs:/public/retail_db/customers/","customers/",0],["dbfs:/public/retail_db/departments/","departments/",0],["dbfs:/public/retail_db/order_items/","order_items/",0],["dbfs:/public/retail_db/orders/","orders/",0],["dbfs:/public/retail_db/products/","products/",0]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"path","type":"\"string\"","metadata":"{}"},{"name":"name","type":"\"string\"","metadata":"{}"},{"name":"size","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641520525572,"submitTime":1641520525384,"finishTime":1641520528969,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"519","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"498893d2-4a5d-4f50-a564-55d9ab3d8574"},{"version":"CommandV1","origId":1575837098434425,"guid":"c30e7a83-3f88-4f0a-986f-0942f54d3e52","subtype":"command","commandType":"auto","position":0.625,"command":"%fs ls /public/retail_db/orders","commandVersion":3,"state":"finished","results":{"type":"table","data":[["dbfs:/public/retail_db/orders/part-00000","part-00000",2999944]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"path","type":"\"string\"","metadata":"{}"},{"name":"name","type":"\"string\"","metadata":"{}"},{"name":"size","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641520528974,"submitTime":1641520525390,"finishTime":1641520529180,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"544","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"2e1d63db-a684-464a-914c-b4cf4a7bdb82"},{"version":"CommandV1","origId":1575837098434426,"guid":"76d3d897-00bd-4671-8ab0-773a32068762","subtype":"command","commandType":"auto","position":0.75,"command":"orders = spark. \\\n    read. \\\n    csv('/public/retail_db/orders', inferSchema=True). \\\n    toDF('order_id', 'order_date', 'order_customer_id', 'order_status')","commandVersion":25,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"orders","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"order_id","nullable":true,"type":"integer"},{"metadata":{},"name":"order_date","nullable":true,"type":"string"},{"metadata":{},"name":"order_customer_id","nullable":true,"type":"integer"},{"metadata":{},"name":"order_status","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641520529184,"submitTime":1641520525394,"finishTime":1641520529934,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"8cb4fa56-8a7b-44fd-97f4-f9c57bd5fcba"},{"version":"CommandV1","origId":1575837098434427,"guid":"80f60ce6-6468-44ea-a483-6d120848b7d4","subtype":"command","commandType":"auto","position":0.8125,"command":"orders.inputFiles()","commandVersion":7,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Out[2]: [&#39;dbfs:/public/retail_db/orders/part-00000&#39;]</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641520529939,"submitTime":1641520525399,"finishTime":1641520529958,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"87ab6c66-ce7d-449f-801a-97bce346267a"},{"version":"CommandV1","origId":1575837098434428,"guid":"a2538e80-8945-4cdd-9083-45859355adbb","subtype":"command","commandType":"auto","position":0.875,"command":"orders.dtypes","commandVersion":6,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Out[3]: [(&#39;order_id&#39;, &#39;int&#39;),\n (&#39;order_date&#39;, &#39;string&#39;),\n (&#39;order_customer_id&#39;, &#39;int&#39;),\n (&#39;order_status&#39;, &#39;string&#39;)]</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641520529961,"submitTime":1641520525404,"finishTime":1641520529972,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"32f8c461-6740-4aee-b1d5-978bade7be56"},{"version":"CommandV1","origId":1575837098434429,"guid":"68c40cc2-19d8-442c-9c5d-1caa8b29515b","subtype":"command","commandType":"auto","position":0.9375,"command":"orders.show()","commandVersion":3,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+--------+--------------------+-----------------+---------------+\n|order_id|          order_date|order_customer_id|   order_status|\n+--------+--------------------+-----------------+---------------+\n|       1|2013-07-25 00:00:...|            11599|         CLOSED|\n|       2|2013-07-25 00:00:...|              256|PENDING_PAYMENT|\n|       3|2013-07-25 00:00:...|            12111|       COMPLETE|\n|       4|2013-07-25 00:00:...|             8827|         CLOSED|\n|       5|2013-07-25 00:00:...|            11318|       COMPLETE|\n|       6|2013-07-25 00:00:...|             7130|       COMPLETE|\n|       7|2013-07-25 00:00:...|             4530|       COMPLETE|\n|       8|2013-07-25 00:00:...|             2911|     PROCESSING|\n|       9|2013-07-25 00:00:...|             5657|PENDING_PAYMENT|\n|      10|2013-07-25 00:00:...|             5648|PENDING_PAYMENT|\n|      11|2013-07-25 00:00:...|              918| PAYMENT_REVIEW|\n|      12|2013-07-25 00:00:...|             1837|         CLOSED|\n|      13|2013-07-25 00:00:...|             9149|PENDING_PAYMENT|\n|      14|2013-07-25 00:00:...|             9842|     PROCESSING|\n|      15|2013-07-25 00:00:...|             2568|       COMPLETE|\n|      16|2013-07-25 00:00:...|             7276|PENDING_PAYMENT|\n|      17|2013-07-25 00:00:...|             2667|       COMPLETE|\n|      18|2013-07-25 00:00:...|             1205|         CLOSED|\n|      19|2013-07-25 00:00:...|             9488|PENDING_PAYMENT|\n|      20|2013-07-25 00:00:...|             9198|     PROCESSING|\n+--------+--------------------+-----------------+---------------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641520529975,"submitTime":1641520525408,"finishTime":1641520530180,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"3ccbcbe1-cd58-473d-ac80-ad14e2bf1ab9"},{"version":"CommandV1","origId":1575837098434430,"guid":"ad73681e-f3df-4491-99a5-bc54b304abbc","subtype":"command","commandType":"auto","position":1.0,"command":"%fs ls /public/retail_db_json","commandVersion":8,"state":"finished","results":{"type":"table","data":[["dbfs:/public/retail_db_json/.git/",".git/",0],["dbfs:/public/retail_db_json/categories/","categories/",0],["dbfs:/public/retail_db_json/create_db_tables_pg.sql","create_db_tables_pg.sql",1748],["dbfs:/public/retail_db_json/customers/","customers/",0],["dbfs:/public/retail_db_json/departments/","departments/",0],["dbfs:/public/retail_db_json/order_items/","order_items/",0],["dbfs:/public/retail_db_json/orders/","orders/",0],["dbfs:/public/retail_db_json/products/","products/",0]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"path","type":"\"string\"","metadata":"{}"},{"name":"name","type":"\"string\"","metadata":"{}"},{"name":"size","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641520530184,"submitTime":1641520525413,"finishTime":1641520530425,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"684","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"4346c82f-dde6-47d2-bfeb-c1c0d70b32a3"},{"version":"CommandV1","origId":1575837098434431,"guid":"48398ef9-b79e-4a0b-93ea-8b3df5ccb4ee","subtype":"command","commandType":"auto","position":2.0,"command":"orders = spark.read.json('/public/retail_db_json/orders')","commandVersion":11,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"orders","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"order_customer_id","nullable":true,"type":"long"},{"metadata":{},"name":"order_date","nullable":true,"type":"string"},{"metadata":{},"name":"order_id","nullable":true,"type":"long"},{"metadata":{},"name":"order_status","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641520530429,"submitTime":1641520525417,"finishTime":1641520531048,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"f6e20ee2-1686-4329-b494-49b026d3fa2a"},{"version":"CommandV1","origId":1575837098434432,"guid":"cbf04d41-7abd-4ada-8916-419e2b631878","subtype":"command","commandType":"auto","position":2.5,"command":"orders.inputFiles()","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Out[6]: [&#39;dbfs:/public/retail_db_json/orders/part-r-00000-990f5773-9005-49ba-b670-631286032674&#39;]</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641520531053,"submitTime":1641520525422,"finishTime":1641520531069,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"35313108-c33f-4815-9639-9f9190660bc2"},{"version":"CommandV1","origId":1575837098434433,"guid":"0baae7d9-329b-4434-bbd7-4d9d6230ade5","subtype":"command","commandType":"auto","position":3.0,"command":"orders.show()","commandVersion":3,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+-----------------+--------------------+--------+---------------+\n|order_customer_id|          order_date|order_id|   order_status|\n+-----------------+--------------------+--------+---------------+\n|            11599|2013-07-25 00:00:...|       1|         CLOSED|\n|              256|2013-07-25 00:00:...|       2|PENDING_PAYMENT|\n|            12111|2013-07-25 00:00:...|       3|       COMPLETE|\n|             8827|2013-07-25 00:00:...|       4|         CLOSED|\n|            11318|2013-07-25 00:00:...|       5|       COMPLETE|\n|             7130|2013-07-25 00:00:...|       6|       COMPLETE|\n|             4530|2013-07-25 00:00:...|       7|       COMPLETE|\n|             2911|2013-07-25 00:00:...|       8|     PROCESSING|\n|             5657|2013-07-25 00:00:...|       9|PENDING_PAYMENT|\n|             5648|2013-07-25 00:00:...|      10|PENDING_PAYMENT|\n|              918|2013-07-25 00:00:...|      11| PAYMENT_REVIEW|\n|             1837|2013-07-25 00:00:...|      12|         CLOSED|\n|             9149|2013-07-25 00:00:...|      13|PENDING_PAYMENT|\n|             9842|2013-07-25 00:00:...|      14|     PROCESSING|\n|             2568|2013-07-25 00:00:...|      15|       COMPLETE|\n|             7276|2013-07-25 00:00:...|      16|PENDING_PAYMENT|\n|             2667|2013-07-25 00:00:...|      17|       COMPLETE|\n|             1205|2013-07-25 00:00:...|      18|         CLOSED|\n|             9488|2013-07-25 00:00:...|      19|PENDING_PAYMENT|\n|             9198|2013-07-25 00:00:...|      20|     PROCESSING|\n+-----------------+--------------------+--------+---------------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641520531073,"submitTime":1641520525427,"finishTime":1641520531311,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"c61c04e4-2229-47b8-be8e-7461a6bcee83"},{"version":"CommandV1","origId":1575837098434434,"guid":"49c92712-0500-407f-9e2a-e2b008f842b8","subtype":"command","commandType":"auto","position":4.0,"command":"orders.dtypes","commandVersion":4,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Out[8]: [(&#39;order_customer_id&#39;, &#39;bigint&#39;),\n (&#39;order_date&#39;, &#39;string&#39;),\n (&#39;order_id&#39;, &#39;bigint&#39;),\n (&#39;order_status&#39;, &#39;string&#39;)]</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641520531316,"submitTime":1641520525432,"finishTime":1641520531330,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"ec5a5d84-2922-4c45-9c8a-3913a7230f58"},{"version":"CommandV1","origId":1575837098434435,"guid":"81a8194a-8245-4ec1-bb0e-0cd10f89cc61","subtype":"command","commandType":"auto","position":5.0,"command":"order_items = spark.read.json('/public/retail_db_json/order_items')","commandVersion":14,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"order_items","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"order_item_id","nullable":true,"type":"long"},{"metadata":{},"name":"order_item_order_id","nullable":true,"type":"long"},{"metadata":{},"name":"order_item_product_id","nullable":true,"type":"long"},{"metadata":{},"name":"order_item_product_price","nullable":true,"type":"double"},{"metadata":{},"name":"order_item_quantity","nullable":true,"type":"long"},{"metadata":{},"name":"order_item_subtotal","nullable":true,"type":"double"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641520531334,"submitTime":1641520525437,"finishTime":1641520532097,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"e7d784fb-e44a-4104-beb8-6606c3549fcd"},{"version":"CommandV1","origId":1575837098434436,"guid":"6e71ac8a-ef51-4ca7-ab1d-270447e0146c","subtype":"command","commandType":"auto","position":5.5,"command":"order_items.inputFiles()","commandVersion":2,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Out[10]: [&#39;dbfs:/public/retail_db_json/order_items/part-r-00000-6b83977e-3f20-404b-9b5f-29376ab1419e&#39;]</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641520532103,"submitTime":1641520525441,"finishTime":1641520532118,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"09fb5db2-fba4-4bac-a82c-ee328a523da9"},{"version":"CommandV1","origId":1575837098434437,"guid":"40d8252c-27b6-4375-8a9f-124e7062cbf5","subtype":"command","commandType":"auto","position":6.0,"command":"order_items.show()","commandVersion":4,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+-------------+-------------------+---------------------+------------------------+-------------------+-------------------+\n|order_item_id|order_item_order_id|order_item_product_id|order_item_product_price|order_item_quantity|order_item_subtotal|\n+-------------+-------------------+---------------------+------------------------+-------------------+-------------------+\n|            1|                  1|                  957|                  299.98|                  1|             299.98|\n|            2|                  2|                 1073|                  199.99|                  1|             199.99|\n|            3|                  2|                  502|                    50.0|                  5|              250.0|\n|            4|                  2|                  403|                  129.99|                  1|             129.99|\n|            5|                  4|                  897|                   24.99|                  2|              49.98|\n|            6|                  4|                  365|                   59.99|                  5|             299.95|\n|            7|                  4|                  502|                    50.0|                  3|              150.0|\n|            8|                  4|                 1014|                   49.98|                  4|             199.92|\n|            9|                  5|                  957|                  299.98|                  1|             299.98|\n|           10|                  5|                  365|                   59.99|                  5|             299.95|\n|           11|                  5|                 1014|                   49.98|                  2|              99.96|\n|           12|                  5|                  957|                  299.98|                  1|             299.98|\n|           13|                  5|                  403|                  129.99|                  1|             129.99|\n|           14|                  7|                 1073|                  199.99|                  1|             199.99|\n|           15|                  7|                  957|                  299.98|                  1|             299.98|\n|           16|                  7|                  926|                   15.99|                  5|              79.95|\n|           17|                  8|                  365|                   59.99|                  3|             179.97|\n|           18|                  8|                  365|                   59.99|                  5|             299.95|\n|           19|                  8|                 1014|                   49.98|                  4|             199.92|\n|           20|                  8|                  502|                    50.0|                  1|               50.0|\n+-------------+-------------------+---------------------+------------------------+-------------------+-------------------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641520532121,"submitTime":1641520525446,"finishTime":1641520532362,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"9ff6112b-eb24-4722-87ad-f153669ff292"},{"version":"CommandV1","origId":1575837098434438,"guid":"aac62ea5-9614-4541-8571-5b0d2a49f370","subtype":"command","commandType":"auto","position":7.0,"command":"order_items.dtypes","commandVersion":5,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Out[12]: [(&#39;order_item_id&#39;, &#39;bigint&#39;),\n (&#39;order_item_order_id&#39;, &#39;bigint&#39;),\n (&#39;order_item_product_id&#39;, &#39;bigint&#39;),\n (&#39;order_item_product_price&#39;, &#39;double&#39;),\n (&#39;order_item_quantity&#39;, &#39;bigint&#39;),\n (&#39;order_item_subtotal&#39;, &#39;double&#39;)]</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641520532367,"submitTime":1641520525450,"finishTime":1641520532389,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"b12126cc-1268-4b6a-a317-75a28b844a50"},{"version":"CommandV1","origId":1575837098434439,"guid":"d96e56fd-8d7f-4a27-b00a-7ad94a1d71ef","subtype":"command","commandType":"auto","position":9.25,"command":"import getpass\nusername = getpass.getuser()","commandVersion":8,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641520532394,"submitTime":1641520525454,"finishTime":1641520532406,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"d12b29d2-9eee-4f05-99c1-a8b7c96a3d59"},{"version":"CommandV1","origId":1575837098434440,"guid":"ff788fea-1705-4fa5-9cfb-b746ae4b0579","subtype":"command","commandType":"auto","position":11.5,"command":"dbutils.fs.ls(f'/user/{username}/retail_db_parquet/orders')","commandVersion":9,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Out[14]: [FileInfo(path=&#39;dbfs:/user/root/retail_db_parquet/orders/_committed_2813264261469267571&#39;, name=&#39;_committed_2813264261469267571&#39;, size=223),\n FileInfo(path=&#39;dbfs:/user/root/retail_db_parquet/orders/_committed_3739854076266658903&#39;, name=&#39;_committed_3739854076266658903&#39;, size=123),\n FileInfo(path=&#39;dbfs:/user/root/retail_db_parquet/orders/_committed_7198418882314090348&#39;, name=&#39;_committed_7198418882314090348&#39;, size=232),\n FileInfo(path=&#39;dbfs:/user/root/retail_db_parquet/orders/_committed_7958689718562853532&#39;, name=&#39;_committed_7958689718562853532&#39;, size=222),\n FileInfo(path=&#39;dbfs:/user/root/retail_db_parquet/orders/_committed_vacuum4032435399200819253&#39;, name=&#39;_committed_vacuum4032435399200819253&#39;, size=96),\n FileInfo(path=&#39;dbfs:/user/root/retail_db_parquet/orders/_started_2813264261469267571&#39;, name=&#39;_started_2813264261469267571&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/retail_db_parquet/orders/_started_7958689718562853532&#39;, name=&#39;_started_7958689718562853532&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/retail_db_parquet/orders/part-00000-tid-2813264261469267571-eecb8f31-4c90-4763-89c5-6e2d7f0fafb1-168-1-c000.snappy.parquet&#39;, name=&#39;part-00000-tid-2813264261469267571-eecb8f31-4c90-4763-89c5-6e2d7f0fafb1-168-1-c000.snappy.parquet&#39;, size=489203)]</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641520532409,"submitTime":1641520525459,"finishTime":1641520532452,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"dd252eda-6ea1-4160-bb86-b521b0b612fe"},{"version":"CommandV1","origId":1575837098434441,"guid":"9419de99-d3d8-44cb-8b1e-0f41528bfc44","subtype":"command","commandType":"auto","position":12.0,"command":"df_parquet = spark.read.parquet(f'/user/{username}/retail_db_parquet/orders')","commandVersion":24,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"df_parquet","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"order_customer_id","nullable":true,"type":"long"},{"metadata":{},"name":"order_date","nullable":true,"type":"string"},{"metadata":{},"name":"order_id","nullable":true,"type":"long"},{"metadata":{},"name":"order_status","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641520532456,"submitTime":1641520525464,"finishTime":1641520532686,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"3de04e3f-34e3-4e83-a88e-4101fd804f1d"},{"version":"CommandV1","origId":1575837098434442,"guid":"efad9520-d016-4ac3-ac73-4013746f8ce0","subtype":"command","commandType":"auto","position":13.0,"command":"df_parquet.inputFiles()","commandVersion":10,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Out[16]: [&#39;dbfs:/user/root/retail_db_parquet/orders/part-00000-tid-2813264261469267571-eecb8f31-4c90-4763-89c5-6e2d7f0fafb1-168-1-c000.snappy.parquet&#39;]</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641520532690,"submitTime":1641520525471,"finishTime":1641520532712,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"7fd806f7-dcb7-47f1-9c76-756eae1cbfd2"},{"version":"CommandV1","origId":1575837098434443,"guid":"7e4163b3-7dc2-4dba-a51e-9b06dc85f936","subtype":"command","commandType":"auto","position":14.0,"command":"df_parquet.show()","commandVersion":2,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+-----------------+--------------------+--------+---------------+\n|order_customer_id|          order_date|order_id|   order_status|\n+-----------------+--------------------+--------+---------------+\n|            11599|2013-07-25 00:00:...|       1|         CLOSED|\n|              256|2013-07-25 00:00:...|       2|PENDING_PAYMENT|\n|            12111|2013-07-25 00:00:...|       3|       COMPLETE|\n|             8827|2013-07-25 00:00:...|       4|         CLOSED|\n|            11318|2013-07-25 00:00:...|       5|       COMPLETE|\n|             7130|2013-07-25 00:00:...|       6|       COMPLETE|\n|             4530|2013-07-25 00:00:...|       7|       COMPLETE|\n|             2911|2013-07-25 00:00:...|       8|     PROCESSING|\n|             5657|2013-07-25 00:00:...|       9|PENDING_PAYMENT|\n|             5648|2013-07-25 00:00:...|      10|PENDING_PAYMENT|\n|              918|2013-07-25 00:00:...|      11| PAYMENT_REVIEW|\n|             1837|2013-07-25 00:00:...|      12|         CLOSED|\n|             9149|2013-07-25 00:00:...|      13|PENDING_PAYMENT|\n|             9842|2013-07-25 00:00:...|      14|     PROCESSING|\n|             2568|2013-07-25 00:00:...|      15|       COMPLETE|\n|             7276|2013-07-25 00:00:...|      16|PENDING_PAYMENT|\n|             2667|2013-07-25 00:00:...|      17|       COMPLETE|\n|             1205|2013-07-25 00:00:...|      18|         CLOSED|\n|             9488|2013-07-25 00:00:...|      19|PENDING_PAYMENT|\n|             9198|2013-07-25 00:00:...|      20|     PROCESSING|\n+-----------------+--------------------+--------+---------------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641520532715,"submitTime":1641520525475,"finishTime":1641520532882,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"1c82459b-8908-4d63-ba8b-e7819920f0b3"},{"version":"CommandV1","origId":1575837098434444,"guid":"33ee2d7e-ab45-4b01-9e72-22ff8d04ad44","subtype":"command","commandType":"auto","position":15.0,"command":"dbutils.fs.ls(f'/user/{username}/retail_db_pipe/orders')","commandVersion":17,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Out[18]: [FileInfo(path=&#39;dbfs:/user/root/retail_db_pipe/orders/_committed_1132925174692068341&#39;, name=&#39;_committed_1132925174692068341&#39;, size=205),\n FileInfo(path=&#39;dbfs:/user/root/retail_db_pipe/orders/_committed_1234588906270869920&#39;, name=&#39;_committed_1234588906270869920&#39;, size=202),\n FileInfo(path=&#39;dbfs:/user/root/retail_db_pipe/orders/_committed_3648176934209418439&#39;, name=&#39;_committed_3648176934209418439&#39;, size=203),\n FileInfo(path=&#39;dbfs:/user/root/retail_db_pipe/orders/_committed_3739906471235457527&#39;, name=&#39;_committed_3739906471235457527&#39;, size=200),\n FileInfo(path=&#39;dbfs:/user/root/retail_db_pipe/orders/_committed_4737620600354584991&#39;, name=&#39;_committed_4737620600354584991&#39;, size=201),\n FileInfo(path=&#39;dbfs:/user/root/retail_db_pipe/orders/_committed_4947663999967497501&#39;, name=&#39;_committed_4947663999967497501&#39;, size=202),\n FileInfo(path=&#39;dbfs:/user/root/retail_db_pipe/orders/_committed_6648225221865780240&#39;, name=&#39;_committed_6648225221865780240&#39;, size=211),\n FileInfo(path=&#39;dbfs:/user/root/retail_db_pipe/orders/_committed_8357199947666107777&#39;, name=&#39;_committed_8357199947666107777&#39;, size=201),\n FileInfo(path=&#39;dbfs:/user/root/retail_db_pipe/orders/_committed_8757027839909558345&#39;, name=&#39;_committed_8757027839909558345&#39;, size=202),\n FileInfo(path=&#39;dbfs:/user/root/retail_db_pipe/orders/_started_3648176934209418439&#39;, name=&#39;_started_3648176934209418439&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/retail_db_pipe/orders/part-00000-tid-3648176934209418439-0793934d-d4b2-4dbb-a518-7ed299cdcded-100-1-c000.csv&#39;, name=&#39;part-00000-tid-3648176934209418439-0793934d-d4b2-4dbb-a518-7ed299cdcded-100-1-c000.csv&#39;, size=2999944)]</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641520532886,"submitTime":1641520525479,"finishTime":1641520532920,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"63d74406-cd12-4570-8908-fca128fe0ff8"},{"version":"CommandV1","origId":1575837098434445,"guid":"e25bd616-9512-444a-986d-89113442a887","subtype":"command","commandType":"auto","position":16.0,"command":"spark.read.csv(f'/user/{username}/retail_db_pipe/orders', sep='|')","commandVersion":5,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Out[19]: DataFrame[_c0: string, _c1: string, _c2: string, _c3: string]</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641520532924,"submitTime":1641520525484,"finishTime":1641520533572,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"4a89c553-2f24-4240-9453-c25ecfcb119b"}],"dashboards":[],"guid":"c17b9c2c-760c-4ac2-b336-61ce75ffe898","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{"pythonIndentUnit":4}}