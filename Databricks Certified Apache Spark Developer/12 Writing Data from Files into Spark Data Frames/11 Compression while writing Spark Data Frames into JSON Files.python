{"version":"NotebookV1","origId":1575837098434384,"name":"11 Compression while writing Spark Data Frames into JSON Files","language":"python","commands":[{"version":"CommandV1","origId":1575837098434385,"guid":"8b0c65bc-0180-471b-9213-57da8db47b55","subtype":"command","commandType":"auto","position":1.0,"command":"courses = [{'course_id': 1,\n  'course_name': '2020 Complete Python Bootcamp: From Zero to Hero in Python',\n  'suitable_for': 'Beginner',\n  'enrollment': 1100093,\n  'stars': 4.6,\n  'number_of_ratings': 318066},\n {'course_id': 4,\n  'course_name': 'Angular - The Complete Guide (2020 Edition)',\n  'suitable_for': 'Intermediate',\n  'enrollment': 422557,\n  'stars': 4.6,\n  'number_of_ratings': 129984},\n {'course_id': 12,\n  'course_name': 'Automate the Boring Stuff with Python Programming',\n  'suitable_for': 'Advanced',\n  'enrollment': 692617,\n  'stars': 4.6,\n  'number_of_ratings': 70508},\n {'course_id': 10,\n  'course_name': 'Complete C# Unity Game Developer 2D',\n  'suitable_for': 'Advanced',\n  'enrollment': 364934,\n  'stars': 4.6,\n  'number_of_ratings': 78989},\n {'course_id': 5,\n  'course_name': 'Java Programming Masterclass for Software Developers',\n  'suitable_for': 'Advanced',\n  'enrollment': 502572,\n  'stars': 4.6,\n  'number_of_ratings': 123798},\n {'course_id': 15,\n  'course_name': 'Learn Python Programming Masterclass',\n  'suitable_for': 'Advanced',\n  'enrollment': 240790,\n  'stars': 4.5,\n  'number_of_ratings': 58677},\n {'course_id': 3,\n  'course_name': 'Machine Learning A-Zâ„¢: Hands-On Python & R In Data Science',\n  'suitable_for': 'Intermediate',\n  'enrollment': 692812,\n  'stars': 4.5,\n  'number_of_ratings': 132228},\n {'course_id': 14,\n  'course_name': 'Modern React with Redux [2020 Update]',\n  'suitable_for': 'Intermediate',\n  'enrollment': 203214,\n  'stars': 4.7,\n  'number_of_ratings': 60835},\n {'course_id': 8,\n  'course_name': 'Python for Data Science and Machine Learning Bootcamp',\n  'suitable_for': 'Intermediate',\n  'enrollment': 387789,\n  'stars': 4.6,\n  'number_of_ratings': 87403},\n {'course_id': 6,\n  'course_name': 'React - The Complete Guide (incl Hooks, React Router, Redux)',\n  'suitable_for': 'Intermediate',\n  'enrollment': 304670,\n  'stars': 4.6,\n  'number_of_ratings': 90964},\n {'course_id': 18,\n  'course_name': 'Selenium WebDriver with Java -Basics to Advanced+Frameworks',\n  'suitable_for': 'Advanced',\n  'enrollment': 148562,\n  'stars': 4.6,\n  'number_of_ratings': 49947},\n {'course_id': 21,\n  'course_name': 'Spring & Hibernate for Beginners (includes Spring Boot)',\n  'suitable_for': 'Advanced',\n  'enrollment': 177053,\n  'stars': 4.6,\n  'number_of_ratings': 45329},\n {'course_id': 7,\n  'course_name': 'The Complete 2020 Web Development Bootcamp',\n  'suitable_for': 'Beginner',\n  'enrollment': 270656,\n  'stars': 4.7,\n  'number_of_ratings': 88098},\n {'course_id': 9,\n  'course_name': 'The Complete JavaScript Course 2020: Build Real Projects!',\n  'suitable_for': 'Intermediate',\n  'enrollment': 347979,\n  'stars': 4.6,\n  'number_of_ratings': 83521},\n {'course_id': 16,\n  'course_name': 'The Complete Node.js Developer Course (3rd Edition)',\n  'suitable_for': 'Advanced',\n  'enrollment': 202922,\n  'stars': 4.7,\n  'number_of_ratings': 50885},\n {'course_id': 13,\n  'course_name': 'The Complete Web Developer Course 2.0',\n  'suitable_for': 'Intermediate',\n  'enrollment': 273598,\n  'stars': 4.5,\n  'number_of_ratings': 63175},\n {'course_id': 11,\n  'course_name': 'The Data Science Course 2020: Complete Data Science Bootcamp',\n  'suitable_for': 'Beginner',\n  'enrollment': 325047,\n  'stars': 4.5,\n  'number_of_ratings': 76907},\n {'course_id': 20,\n  'course_name': 'The Ultimate MySQL Bootcamp: Go from SQL Beginner to Expert',\n  'suitable_for': 'Beginner',\n  'enrollment': 203366,\n  'stars': 4.6,\n  'number_of_ratings': 45382},\n {'course_id': 2,\n  'course_name': 'The Web Developer Bootcamp',\n  'suitable_for': 'Beginner',\n  'enrollment': 596726,\n  'stars': 4.6,\n  'number_of_ratings': 182997},\n {'course_id': 19,\n  'course_name': 'Unreal Engine C++ Developer: Learn C++ and Make Video Games',\n  'suitable_for': 'Advanced',\n  'enrollment': 229005,\n  'stars': 4.5,\n  'number_of_ratings': 45860},\n {'course_id': 17,\n  'course_name': 'iOS 13 & Swift 5 - The Complete iOS App Development Bootcamp',\n  'suitable_for': 'Advanced',\n  'enrollment': 179598,\n  'stars': 4.8,\n  'number_of_ratings': 49972}]\n\nfrom pyspark.sql import Row\ncourses_df = spark.createDataFrame([Row(**course) for course in courses])","commandVersion":5,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"courses_df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"course_id","nullable":true,"type":"long"},{"metadata":{},"name":"course_name","nullable":true,"type":"string"},{"metadata":{},"name":"suitable_for","nullable":true,"type":"string"},{"metadata":{},"name":"enrollment","nullable":true,"type":"long"},{"metadata":{},"name":"stars","nullable":true,"type":"double"},{"metadata":{},"name":"number_of_ratings","nullable":true,"type":"long"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641591144701,"submitTime":1641591142791,"finishTime":1641591145027,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"c2ed4710-0c33-49dd-b14f-e49b1496084f"},{"version":"CommandV1","origId":1575837098434386,"guid":"7196bddd-0fe1-4b23-ad0b-4512ddbec3cb","subtype":"command","commandType":"auto","position":3.5,"command":"import getpass\nusername = getpass.getuser()","commandVersion":11,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641591148748,"submitTime":1641591148715,"finishTime":1641591148769,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"5f8b2f2d-7ed9-4a7d-b254-580158aa26b1"},{"version":"CommandV1","origId":1575837098434387,"guid":"fef5a082-e679-4433-8129-6dbc85010b24","subtype":"command","commandType":"auto","position":4.75,"command":"dbutils.fs.ls(f'/user/{username}/courses')","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Out[3]: [FileInfo(path=&#39;dbfs:/user/root/courses/_SUCCESS&#39;, name=&#39;_SUCCESS&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/courses/_committed_1401693074137768294&#39;, name=&#39;_committed_1401693074137768294&#39;, size=210),\n FileInfo(path=&#39;dbfs:/user/root/courses/_committed_8810363432491527750&#39;, name=&#39;_committed_8810363432491527750&#39;, size=112),\n FileInfo(path=&#39;dbfs:/user/root/courses/_started_1401693074137768294&#39;, name=&#39;_started_1401693074137768294&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/courses/_started_8810363432491527750&#39;, name=&#39;_started_8810363432491527750&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/courses/part-00000-tid-1401693074137768294-fec32ea6-7c6a-4b1b-9d6c-a096acde6d07-4-1-c000.json&#39;, name=&#39;part-00000-tid-1401693074137768294-fec32ea6-7c6a-4b1b-9d6c-a096acde6d07-4-1-c000.json&#39;, size=3551)]</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641591174820,"submitTime":1641591174788,"finishTime":1641591174927,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"247de7c3-df6a-4c77-b1ee-7c8c90b81d90"},{"version":"CommandV1","origId":1575837098434388,"guid":"eb8eeec6-ff74-4530-8396-32d2fe4641d5","subtype":"command","commandType":"auto","position":6.0,"command":"courses_df. \\\n    coalesce(1). \\\n    write. \\\n    json(\n        f'/user/{username}/courses', \n        mode='overwrite',\n        compression='gzip'\n    )","commandVersion":10,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641591191448,"submitTime":1641591191414,"finishTime":1641591193687,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"3e6384dc-007f-448e-9233-8093b37344fb"},{"version":"CommandV1","origId":1575837098434389,"guid":"12f590d9-880d-4f06-b9cd-7b88ceab4391","subtype":"command","commandType":"auto","position":7.0,"command":"dbutils.fs.ls(f'/user/{username}/courses')","commandVersion":7,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Out[5]: [FileInfo(path=&#39;dbfs:/user/root/courses/_SUCCESS&#39;, name=&#39;_SUCCESS&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/courses/_committed_1401693074137768294&#39;, name=&#39;_committed_1401693074137768294&#39;, size=210),\n FileInfo(path=&#39;dbfs:/user/root/courses/_committed_3556593558344817871&#39;, name=&#39;_committed_3556593558344817871&#39;, size=202),\n FileInfo(path=&#39;dbfs:/user/root/courses/_committed_8810363432491527750&#39;, name=&#39;_committed_8810363432491527750&#39;, size=112),\n FileInfo(path=&#39;dbfs:/user/root/courses/_started_1401693074137768294&#39;, name=&#39;_started_1401693074137768294&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/courses/_started_3556593558344817871&#39;, name=&#39;_started_3556593558344817871&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/courses/_started_8810363432491527750&#39;, name=&#39;_started_8810363432491527750&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/courses/part-00000-tid-3556593558344817871-0e224457-667c-488d-a944-1f1f31c37d34-8-1-c000.json.gz&#39;, name=&#39;part-00000-tid-3556593558344817871-0e224457-667c-488d-a944-1f1f31c37d34-8-1-c000.json.gz&#39;, size=991)]</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641591200521,"submitTime":1641591200490,"finishTime":1641591200612,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"e28b21ac-140e-4c0a-862c-f7da14a614bf"},{"version":"CommandV1","origId":1575837098434390,"guid":"132ad991-f711-4afd-bb7b-0ad97164a653","subtype":"command","commandType":"auto","position":8.0,"command":"spark.read.json(f'/user/{username}/courses').show()","commandVersion":5,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+---------+--------------------+----------+-----------------+-----+------------+\n|course_id|         course_name|enrollment|number_of_ratings|stars|suitable_for|\n+---------+--------------------+----------+-----------------+-----+------------+\n|        1|2020 Complete Pyt...|   1100093|           318066|  4.6|    Beginner|\n|        4|Angular - The Com...|    422557|           129984|  4.6|Intermediate|\n|       12|Automate the Bori...|    692617|            70508|  4.6|    Advanced|\n|       10|Complete C# Unity...|    364934|            78989|  4.6|    Advanced|\n|        5|Java Programming ...|    502572|           123798|  4.6|    Advanced|\n|       15|Learn Python Prog...|    240790|            58677|  4.5|    Advanced|\n|        3|Machine Learning ...|    692812|           132228|  4.5|Intermediate|\n|       14|Modern React with...|    203214|            60835|  4.7|Intermediate|\n|        8|Python for Data S...|    387789|            87403|  4.6|Intermediate|\n|        6|React - The Compl...|    304670|            90964|  4.6|Intermediate|\n|       18|Selenium WebDrive...|    148562|            49947|  4.6|    Advanced|\n|       21|Spring &amp; Hibernat...|    177053|            45329|  4.6|    Advanced|\n|        7|The Complete 2020...|    270656|            88098|  4.7|    Beginner|\n|        9|The Complete Java...|    347979|            83521|  4.6|Intermediate|\n|       16|The Complete Node...|    202922|            50885|  4.7|    Advanced|\n|       13|The Complete Web ...|    273598|            63175|  4.5|Intermediate|\n|       11|The Data Science ...|    325047|            76907|  4.5|    Beginner|\n|       20|The Ultimate MySQ...|    203366|            45382|  4.6|    Beginner|\n|        2|The Web Developer...|    596726|           182997|  4.6|    Beginner|\n|       19|Unreal Engine C++...|    229005|            45860|  4.5|    Advanced|\n+---------+--------------------+----------+-----------------+-----+------------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641591235702,"submitTime":1641591235666,"finishTime":1641591236590,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"267aefd0-b0c3-4a4a-a3ec-2e9c3107a8a9"},{"version":"CommandV1","origId":1575837098434391,"guid":"f5fca464-d133-4eea-967d-c32b1092c3f5","subtype":"command","commandType":"auto","position":9.0,"command":"help(courses_df.write.json)","commandVersion":8,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Help on method json in module pyspark.sql.readwriter:\n\njson(path, mode=None, compression=None, dateFormat=None, timestampFormat=None, lineSep=None, encoding=None, ignoreNullFields=None) method of pyspark.sql.readwriter.DataFrameWriter instance\n    Saves the content of the :class:`DataFrame` in JSON format\n    (`JSON Lines text format or newline-delimited JSON &lt;http://jsonlines.org/&gt;`_) at the\n    specified path.\n    \n    .. versionadded:: 1.4.0\n    \n    Parameters\n    ----------\n    path : str\n        the path in any Hadoop supported file system\n    mode : str, optional\n        specifies the behavior of the save operation when data already exists.\n    \n        * ``append``: Append contents of this :class:`DataFrame` to existing data.\n        * ``overwrite``: Overwrite existing data.\n        * ``ignore``: Silently ignore this operation if data already exists.\n        * ``error`` or ``errorifexists`` (default case): Throw an exception if data already                 exists.\n    compression : str, optional\n        compression codec to use when saving to file. This can be one of the\n        known case-insensitive shorten names (none, bzip2, gzip, lz4,\n        snappy and deflate).\n    dateFormat : str, optional\n        sets the string that indicates a date format. Custom date formats\n        follow the formats at\n        `datetime pattern &lt;https://spark.apache.org/docs/latest/sql-ref-datetime-pattern.html&gt;`_.  # noqa\n        This applies to date type. If None is set, it uses the\n        default value, ``yyyy-MM-dd``.\n    timestampFormat : str, optional\n        sets the string that indicates a timestamp format.\n        Custom date formats follow the formats at\n        `datetime pattern &lt;https://spark.apache.org/docs/latest/sql-ref-datetime-pattern.html&gt;`_.  # noqa\n        This applies to timestamp type. If None is set, it uses the\n        default value, ``yyyy-MM-dd&#39;T&#39;HH:mm:ss[.SSS][XXX]``.\n    encoding : str, optional\n        specifies encoding (charset) of saved json files. If None is set,\n        the default UTF-8 charset will be used.\n    lineSep : str, optional\n        defines the line separator that should be used for writing. If None is\n        set, it uses the default value, ``\\n``.\n    ignoreNullFields : str or bool, optional\n        Whether to ignore null fields when generating JSON objects.\n        If None is set, it uses the default value, ``true``.\n    \n    Examples\n    --------\n    &gt;&gt;&gt; df.write.json(os.path.join(tempfile.mkdtemp(), &#39;data&#39;))\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641591338747,"submitTime":1641591338698,"finishTime":1641591338794,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"4d1034d4-0eab-4326-a39a-9be4192e3c55"},{"version":"CommandV1","origId":1575837098434392,"guid":"9b574077-8336-4cb8-8412-435c4749e20b","subtype":"command","commandType":"auto","position":10.0,"command":"courses_df. \\\n    coalesce(1). \\\n    write. \\\n    format('json'). \\\n    save(\n        f'/user/{username}/courses', \n        mode='overwrite',\n        compression='snappy'\n    )","commandVersion":9,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641591482342,"submitTime":1641591482304,"finishTime":1641591483359,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"d93ef21e-da0a-4faa-8de3-eaa09180a3d9"},{"version":"CommandV1","origId":1575837098434393,"guid":"f0686f62-092b-40d6-96c7-bd0098f30d9b","subtype":"command","commandType":"auto","position":11.0,"command":"dbutils.fs.ls(f'/user/{username}/courses')","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Out[10]: [FileInfo(path=&#39;dbfs:/user/root/courses/_SUCCESS&#39;, name=&#39;_SUCCESS&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/courses/_committed_1401693074137768294&#39;, name=&#39;_committed_1401693074137768294&#39;, size=210),\n FileInfo(path=&#39;dbfs:/user/root/courses/_committed_1462528897332948522&#39;, name=&#39;_committed_1462528897332948522&#39;, size=211),\n FileInfo(path=&#39;dbfs:/user/root/courses/_committed_3556593558344817871&#39;, name=&#39;_committed_3556593558344817871&#39;, size=202),\n FileInfo(path=&#39;dbfs:/user/root/courses/_committed_7847800293687686318&#39;, name=&#39;_committed_7847800293687686318&#39;, size=206),\n FileInfo(path=&#39;dbfs:/user/root/courses/_committed_8810363432491527750&#39;, name=&#39;_committed_8810363432491527750&#39;, size=112),\n FileInfo(path=&#39;dbfs:/user/root/courses/_started_1401693074137768294&#39;, name=&#39;_started_1401693074137768294&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/courses/_started_1462528897332948522&#39;, name=&#39;_started_1462528897332948522&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/courses/_started_3556593558344817871&#39;, name=&#39;_started_3556593558344817871&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/courses/_started_7847800293687686318&#39;, name=&#39;_started_7847800293687686318&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/courses/_started_8810363432491527750&#39;, name=&#39;_started_8810363432491527750&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/courses/part-00000-tid-1462528897332948522-1f4bab56-4c6a-43f4-8c15-0678b6b14fe9-12-1-c000.json.snappy&#39;, name=&#39;part-00000-tid-1462528897332948522-1f4bab56-4c6a-43f4-8c15-0678b6b14fe9-12-1-c000.json.snappy&#39;, size=1389)]</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641591502804,"submitTime":1641591502769,"finishTime":1641591502922,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"b2ae83be-66a7-4392-981d-7a8285600656"},{"version":"CommandV1","origId":1575837098434394,"guid":"68a106c2-65b6-4d23-b900-6a920a629db3","subtype":"command","commandType":"auto","position":12.0,"command":"spark.read.json(f'/user/{username}/courses').show()","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+---------+--------------------+----------+-----------------+-----+------------+\n|course_id|         course_name|enrollment|number_of_ratings|stars|suitable_for|\n+---------+--------------------+----------+-----------------+-----+------------+\n|        1|2020 Complete Pyt...|   1100093|           318066|  4.6|    Beginner|\n|        4|Angular - The Com...|    422557|           129984|  4.6|Intermediate|\n|       12|Automate the Bori...|    692617|            70508|  4.6|    Advanced|\n|       10|Complete C# Unity...|    364934|            78989|  4.6|    Advanced|\n|        5|Java Programming ...|    502572|           123798|  4.6|    Advanced|\n|       15|Learn Python Prog...|    240790|            58677|  4.5|    Advanced|\n|        3|Machine Learning ...|    692812|           132228|  4.5|Intermediate|\n|       14|Modern React with...|    203214|            60835|  4.7|Intermediate|\n|        8|Python for Data S...|    387789|            87403|  4.6|Intermediate|\n|        6|React - The Compl...|    304670|            90964|  4.6|Intermediate|\n|       18|Selenium WebDrive...|    148562|            49947|  4.6|    Advanced|\n|       21|Spring &amp; Hibernat...|    177053|            45329|  4.6|    Advanced|\n|        7|The Complete 2020...|    270656|            88098|  4.7|    Beginner|\n|        9|The Complete Java...|    347979|            83521|  4.6|Intermediate|\n|       16|The Complete Node...|    202922|            50885|  4.7|    Advanced|\n|       13|The Complete Web ...|    273598|            63175|  4.5|Intermediate|\n|       11|The Data Science ...|    325047|            76907|  4.5|    Beginner|\n|       20|The Ultimate MySQ...|    203366|            45382|  4.6|    Beginner|\n|        2|The Web Developer...|    596726|           182997|  4.6|    Beginner|\n|       19|Unreal Engine C++...|    229005|            45860|  4.5|    Advanced|\n+---------+--------------------+----------+-----------------+-----+------------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641591534118,"submitTime":1641591534085,"finishTime":1641591535260,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"c7fbb5af-77db-4afd-8995-01d6261acbd2"},{"version":"CommandV1","origId":1575837098434395,"guid":"45bc286b-a635-4ae7-8f45-5667bf065641","subtype":"command","commandType":"auto","position":13.0,"command":"","commandVersion":0,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"0a933b45-1a81-4706-96f5-edc2e760e98a"}],"dashboards":[],"guid":"3d379b8d-1a6c-4b76-9d06-9880ce2dd60b","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{"pythonIndentUnit":4}}