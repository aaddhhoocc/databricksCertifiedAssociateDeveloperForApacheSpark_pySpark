{"version":"NotebookV1","origId":1575837098434303,"name":"05 Writing Spark Data Frames into CSV files","language":"python","commands":[{"version":"CommandV1","origId":1575837098434304,"guid":"5374e3f0-27db-4e8a-aad1-9de8a6598ba0","subtype":"command","commandType":"auto","position":1.0,"command":"%md\n\n* We can write the data from Spark Data Frame into CSV files using multiple approaches.\n* Approach 1: `df.write.csv('path_to_folder')`\n* Approach 2: `df.write.format('csv').save('path_to_folder')`\n* The column names from the schema can be added as header to each of the files by saying `header=True`.\n* We can also write the data into files using characters other than comma as delimiters or separators.\n* We can also compress the data while writing into files using csv.","commandVersion":163,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"bb0df909-df4b-4584-adcd-74459f6864f9"},{"version":"CommandV1","origId":1575837098434305,"guid":"c86f03ef-eae4-4f70-97eb-fc7e34d6c4b8","subtype":"command","commandType":"auto","position":1.5,"command":"courses = [{'course_id': 1,\n  'course_name': '2020 Complete Python Bootcamp: From Zero to Hero in Python',\n  'suitable_for': 'Beginner',\n  'enrollment': 1100093,\n  'stars': 4.6,\n  'number_of_ratings': 318066},\n {'course_id': 4,\n  'course_name': 'Angular - The Complete Guide (2020 Edition)',\n  'suitable_for': 'Intermediate',\n  'enrollment': 422557,\n  'stars': 4.6,\n  'number_of_ratings': 129984},\n {'course_id': 12,\n  'course_name': 'Automate the Boring Stuff with Python Programming',\n  'suitable_for': 'Advanced',\n  'enrollment': 692617,\n  'stars': 4.6,\n  'number_of_ratings': 70508},\n {'course_id': 10,\n  'course_name': 'Complete C# Unity Game Developer 2D',\n  'suitable_for': 'Advanced',\n  'enrollment': 364934,\n  'stars': 4.6,\n  'number_of_ratings': 78989},\n {'course_id': 5,\n  'course_name': 'Java Programming Masterclass for Software Developers',\n  'suitable_for': 'Advanced',\n  'enrollment': 502572,\n  'stars': 4.6,\n  'number_of_ratings': 123798},\n {'course_id': 15,\n  'course_name': 'Learn Python Programming Masterclass',\n  'suitable_for': 'Advanced',\n  'enrollment': 240790,\n  'stars': 4.5,\n  'number_of_ratings': 58677},\n {'course_id': 3,\n  'course_name': 'Machine Learning A-Z™: Hands-On Python & R In Data Science',\n  'suitable_for': 'Intermediate',\n  'enrollment': 692812,\n  'stars': 4.5,\n  'number_of_ratings': 132228},\n {'course_id': 14,\n  'course_name': 'Modern React with Redux [2020 Update]',\n  'suitable_for': 'Intermediate',\n  'enrollment': 203214,\n  'stars': 4.7,\n  'number_of_ratings': 60835},\n {'course_id': 8,\n  'course_name': 'Python for Data Science and Machine Learning Bootcamp',\n  'suitable_for': 'Intermediate',\n  'enrollment': 387789,\n  'stars': 4.6,\n  'number_of_ratings': 87403},\n {'course_id': 6,\n  'course_name': 'React - The Complete Guide (incl Hooks, React Router, Redux)',\n  'suitable_for': 'Intermediate',\n  'enrollment': 304670,\n  'stars': 4.6,\n  'number_of_ratings': 90964},\n {'course_id': 18,\n  'course_name': 'Selenium WebDriver with Java -Basics to Advanced+Frameworks',\n  'suitable_for': 'Advanced',\n  'enrollment': 148562,\n  'stars': 4.6,\n  'number_of_ratings': 49947},\n {'course_id': 21,\n  'course_name': 'Spring & Hibernate for Beginners (includes Spring Boot)',\n  'suitable_for': 'Advanced',\n  'enrollment': 177053,\n  'stars': 4.6,\n  'number_of_ratings': 45329},\n {'course_id': 7,\n  'course_name': 'The Complete 2020 Web Development Bootcamp',\n  'suitable_for': 'Beginner',\n  'enrollment': 270656,\n  'stars': 4.7,\n  'number_of_ratings': 88098},\n {'course_id': 9,\n  'course_name': 'The Complete JavaScript Course 2020: Build Real Projects!',\n  'suitable_for': 'Intermediate',\n  'enrollment': 347979,\n  'stars': 4.6,\n  'number_of_ratings': 83521},\n {'course_id': 16,\n  'course_name': 'The Complete Node.js Developer Course (3rd Edition)',\n  'suitable_for': 'Advanced',\n  'enrollment': 202922,\n  'stars': 4.7,\n  'number_of_ratings': 50885},\n {'course_id': 13,\n  'course_name': 'The Complete Web Developer Course 2.0',\n  'suitable_for': 'Intermediate',\n  'enrollment': 273598,\n  'stars': 4.5,\n  'number_of_ratings': 63175},\n {'course_id': 11,\n  'course_name': 'The Data Science Course 2020: Complete Data Science Bootcamp',\n  'suitable_for': 'Beginner',\n  'enrollment': 325047,\n  'stars': 4.5,\n  'number_of_ratings': 76907},\n {'course_id': 20,\n  'course_name': 'The Ultimate MySQL Bootcamp: Go from SQL Beginner to Expert',\n  'suitable_for': 'Beginner',\n  'enrollment': 203366,\n  'stars': 4.6,\n  'number_of_ratings': 45382},\n {'course_id': 2,\n  'course_name': 'The Web Developer Bootcamp',\n  'suitable_for': 'Beginner',\n  'enrollment': 596726,\n  'stars': 4.6,\n  'number_of_ratings': 182997},\n {'course_id': 19,\n  'course_name': 'Unreal Engine C++ Developer: Learn C++ and Make Video Games',\n  'suitable_for': 'Advanced',\n  'enrollment': 229005,\n  'stars': 4.5,\n  'number_of_ratings': 45860},\n {'course_id': 17,\n  'course_name': 'iOS 13 & Swift 5 - The Complete iOS App Development Bootcamp',\n  'suitable_for': 'Advanced',\n  'enrollment': 179598,\n  'stars': 4.8,\n  'number_of_ratings': 49972}]","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641583210529,"submitTime":1641583210495,"finishTime":1641583210572,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"6a7e02a5-71b6-47e5-8a5d-3f08efe91686"},{"version":"CommandV1","origId":1575837098434306,"guid":"886f315c-cab8-496f-b2c2-d9d0ca26e6aa","subtype":"command","commandType":"auto","position":1.75,"command":"from pyspark.sql import Row","commandVersion":6,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641583211203,"submitTime":1641583211165,"finishTime":1641583211233,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"0f3ea465-9d0c-4bff-90d9-2680e7a26440"},{"version":"CommandV1","origId":1575837098434307,"guid":"09ba905d-8a5f-4ec1-b7ed-c3ca8f24d807","subtype":"command","commandType":"auto","position":1.875,"command":"courses_df = spark.createDataFrame([Row(**course) for course in courses])","commandVersion":17,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"courses_df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"course_id","nullable":true,"type":"long"},{"metadata":{},"name":"course_name","nullable":true,"type":"string"},{"metadata":{},"name":"suitable_for","nullable":true,"type":"string"},{"metadata":{},"name":"enrollment","nullable":true,"type":"long"},{"metadata":{},"name":"stars","nullable":true,"type":"double"},{"metadata":{},"name":"number_of_ratings","nullable":true,"type":"long"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641583211649,"submitTime":1641583211617,"finishTime":1641583211979,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"dcb2c0f2-579f-4140-97f3-d77a611b34d8"},{"version":"CommandV1","origId":1575837098434308,"guid":"e2a99f54-a81a-4250-8a6a-95536b9a6875","subtype":"command","commandType":"auto","position":1.90625,"command":"courses_df.show()","commandVersion":3,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+---------+--------------------+------------+----------+-----+-----------------+\n|course_id|         course_name|suitable_for|enrollment|stars|number_of_ratings|\n+---------+--------------------+------------+----------+-----+-----------------+\n|        1|2020 Complete Pyt...|    Beginner|   1100093|  4.6|           318066|\n|        4|Angular - The Com...|Intermediate|    422557|  4.6|           129984|\n|       12|Automate the Bori...|    Advanced|    692617|  4.6|            70508|\n|       10|Complete C# Unity...|    Advanced|    364934|  4.6|            78989|\n|        5|Java Programming ...|    Advanced|    502572|  4.6|           123798|\n|       15|Learn Python Prog...|    Advanced|    240790|  4.5|            58677|\n|        3|Machine Learning ...|Intermediate|    692812|  4.5|           132228|\n|       14|Modern React with...|Intermediate|    203214|  4.7|            60835|\n|        8|Python for Data S...|Intermediate|    387789|  4.6|            87403|\n|        6|React - The Compl...|Intermediate|    304670|  4.6|            90964|\n|       18|Selenium WebDrive...|    Advanced|    148562|  4.6|            49947|\n|       21|Spring &amp; Hibernat...|    Advanced|    177053|  4.6|            45329|\n|        7|The Complete 2020...|    Beginner|    270656|  4.7|            88098|\n|        9|The Complete Java...|Intermediate|    347979|  4.6|            83521|\n|       16|The Complete Node...|    Advanced|    202922|  4.7|            50885|\n|       13|The Complete Web ...|Intermediate|    273598|  4.5|            63175|\n|       11|The Data Science ...|    Beginner|    325047|  4.5|            76907|\n|       20|The Ultimate MySQ...|    Beginner|    203366|  4.6|            45382|\n|        2|The Web Developer...|    Beginner|    596726|  4.6|           182997|\n|       19|Unreal Engine C++...|    Advanced|    229005|  4.5|            45860|\n+---------+--------------------+------------+----------+-----+-----------------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641583212065,"submitTime":1641583212031,"finishTime":1641583212702,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"2d6d9556-9f63-423e-a646-148a503f2c1b"},{"version":"CommandV1","origId":1575837098434309,"guid":"0ed446b7-06b6-4314-9491-cf522d173db1","subtype":"command","commandType":"auto","position":1.921875,"command":"courses_df.dtypes","commandVersion":2,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Out[5]: [(&#39;course_id&#39;, &#39;bigint&#39;),\n (&#39;course_name&#39;, &#39;string&#39;),\n (&#39;suitable_for&#39;, &#39;string&#39;),\n (&#39;enrollment&#39;, &#39;bigint&#39;),\n (&#39;stars&#39;, &#39;double&#39;),\n (&#39;number_of_ratings&#39;, &#39;bigint&#39;)]</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641583212716,"submitTime":1641583212387,"finishTime":1641583212755,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"4e5962eb-692b-4500-a33d-e6e93048930b"},{"version":"CommandV1","origId":1575837098434310,"guid":"3c2445e7-1b8e-4a89-b1b0-7bd84237c38e","subtype":"command","commandType":"auto","position":1.9375,"command":"import getpass\nusername = getpass.getuser()","commandVersion":11,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641583212765,"submitTime":1641583212721,"finishTime":1641583212791,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"4dbd4757-8c77-4db8-adea-f8234c0ad45c"},{"version":"CommandV1","origId":1575837098434311,"guid":"213d587e-8aaf-4ad8-8a9e-320144766787","subtype":"command","commandType":"auto","position":1.96875,"command":"dbutils.fs.ls(f'/user/{username}/courses')","commandVersion":14,"state":"error","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":"java.io.FileNotFoundException: File /8609438901739746/user/root/courses does not exist.","errorTraceType":"html","error":"<div class=\"ansiout\"><span class=\"ansi-red-fg\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg\">ExecutionError</span>                            Traceback (most recent call last)\n<span class=\"ansi-green-fg\">&lt;command-2296519903437970&gt;</span> in <span class=\"ansi-cyan-fg\">&lt;module&gt;</span>\n<span class=\"ansi-green-fg\">----&gt; 1</span><span class=\"ansi-red-fg\"> </span>dbutils<span class=\"ansi-blue-fg\">.</span>fs<span class=\"ansi-blue-fg\">.</span>ls<span class=\"ansi-blue-fg\">(</span><span class=\"ansi-blue-fg\">f&#39;/user/{username}/courses&#39;</span><span class=\"ansi-blue-fg\">)</span>\n\n<span class=\"ansi-green-fg\">/databricks/python_shell/dbruntime/dbutils.py</span> in <span class=\"ansi-cyan-fg\">f_with_exception_handling</span><span class=\"ansi-blue-fg\">(*args, **kwargs)</span>\n<span class=\"ansi-green-intense-fg ansi-bold\">    317</span>                     exc<span class=\"ansi-blue-fg\">.</span>__context__ <span class=\"ansi-blue-fg\">=</span> <span class=\"ansi-green-fg\">None</span>\n<span class=\"ansi-green-intense-fg ansi-bold\">    318</span>                     exc<span class=\"ansi-blue-fg\">.</span>__cause__ <span class=\"ansi-blue-fg\">=</span> <span class=\"ansi-green-fg\">None</span>\n<span class=\"ansi-green-fg\">--&gt; 319</span><span class=\"ansi-red-fg\">                     </span><span class=\"ansi-green-fg\">raise</span> exc\n<span class=\"ansi-green-intense-fg ansi-bold\">    320</span> \n<span class=\"ansi-green-intense-fg ansi-bold\">    321</span>             <span class=\"ansi-green-fg\">return</span> f_with_exception_handling\n\n<span class=\"ansi-red-fg\">ExecutionError</span>: An error occurred while calling z:com.databricks.backend.daemon.dbutils.FSUtils.ls.\n: java.io.FileNotFoundException: File /8609438901739746/user/root/courses does not exist.\n\tat shaded.databricks.org.apache.hadoop.fs.azure.NativeAzureFileSystem.listStatus(NativeAzureFileSystem.java:2468)\n\tat com.databricks.backend.daemon.data.client.DBFSV2.$anonfun$listStatus$2(DatabricksFileSystemV2.scala:95)\n\tat com.databricks.s3a.S3AExceptionUtils$.convertAWSExceptionToJavaIOException(DatabricksStreamUtils.scala:66)\n\tat com.databricks.backend.daemon.data.client.DBFSV2.$anonfun$listStatus$1(DatabricksFileSystemV2.scala:92)\n\tat com.databricks.logging.UsageLogging.$anonfun$recordOperation$1(UsageLogging.scala:395)\n\tat com.databricks.logging.UsageLogging.executeThunkAndCaptureResultTags$1(UsageLogging.scala:484)\n\tat com.databricks.logging.UsageLogging.$anonfun$recordOperationWithResultTags$4(UsageLogging.scala:504)\n\tat com.databricks.logging.UsageLogging.$anonfun$withAttributionContext$1(UsageLogging.scala:266)\n\tat scala.util.DynamicVariable.withValue(DynamicVariable.scala:62)\n\tat com.databricks.logging.UsageLogging.withAttributionContext(UsageLogging.scala:261)\n\tat com.databricks.logging.UsageLogging.withAttributionContext$(UsageLogging.scala:258)\n\tat com.databricks.backend.daemon.data.client.DatabricksFileSystemV2.withAttributionContext(DatabricksFileSystemV2.scala:510)\n\tat com.databricks.logging.UsageLogging.withAttributionTags(UsageLogging.scala:305)\n\tat com.databricks.logging.UsageLogging.withAttributionTags$(UsageLogging.scala:297)\n\tat com.databricks.backend.daemon.data.client.DatabricksFileSystemV2.withAttributionTags(DatabricksFileSystemV2.scala:510)\n\tat com.databricks.logging.UsageLogging.recordOperationWithResultTags(UsageLogging.scala:479)\n\tat com.databricks.logging.UsageLogging.recordOperationWithResultTags$(UsageLogging.scala:404)\n\tat com.databricks.backend.daemon.data.client.DatabricksFileSystemV2.recordOperationWithResultTags(DatabricksFileSystemV2.scala:510)\n\tat com.databricks.logging.UsageLogging.recordOperation(UsageLogging.scala:395)\n\tat com.databricks.logging.UsageLogging.recordOperation$(UsageLogging.scala:367)\n\tat com.databricks.backend.daemon.data.client.DatabricksFileSystemV2.recordOperation(DatabricksFileSystemV2.scala:510)\n\tat com.databricks.backend.daemon.data.client.DBFSV2.listStatus(DatabricksFileSystemV2.scala:92)\n\tat com.databricks.backend.daemon.data.client.DatabricksFileSystem.listStatus(DatabricksFileSystem.scala:150)\n\tat com.databricks.backend.daemon.dbutils.FSUtils$.$anonfun$ls$1(DBUtilsCore.scala:154)\n\tat com.databricks.backend.daemon.dbutils.FSUtils$.withFsSafetyCheck(DBUtilsCore.scala:91)\n\tat com.databricks.backend.daemon.dbutils.FSUtils$.ls(DBUtilsCore.scala:153)\n\tat com.databricks.backend.daemon.dbutils.FSUtils.ls(DBUtilsCore.scala)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\n\tat py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:380)\n\tat py4j.Gateway.invoke(Gateway.java:295)\n\tat py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\n\tat py4j.commands.CallCommand.execute(CallCommand.java:79)\n\tat py4j.GatewayConnection.run(GatewayConnection.java:251)\n\tat java.lang.Thread.run(Thread.java:748)\n</div>","workflows":[],"startTime":1641583218450,"submitTime":1641583218450,"finishTime":1641583218743,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"a03bc1b2-ed18-4788-a706-486bd394a61f"},{"version":"CommandV1","origId":1575837098434312,"guid":"818705bb-db99-4335-b7f5-c5b0b5d1de3e","subtype":"command","commandType":"auto","position":1.984375,"command":"dbutils.fs.rm(f'/user/{username}/courses', recurse=True)","commandVersion":7,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Out[8]: True</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641583213687,"submitTime":1641583213656,"finishTime":1641583213844,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"7ccd63c4-02f7-464d-911b-ad94d2fbc1fd"},{"version":"CommandV1","origId":1575837098434313,"guid":"2a80951c-9845-4745-b6e4-9da88195e998","subtype":"command","commandType":"auto","position":2.0,"command":"# Default behavior\n# It will delimit the data using comma as separator\ncourses_df.write.csv(f'/user/{username}/courses')","commandVersion":68,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641583227766,"submitTime":1641583227734,"finishTime":1641583228884,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"d4520988-7f01-4f70-af96-67495a062c15"},{"version":"CommandV1","origId":1575837098434314,"guid":"2b3a3bdb-1e25-4cbb-b52c-5c3ad0a86ba6","subtype":"command","commandType":"auto","position":3.0,"command":"# Default number of files will be determined implicitly based on several factors\ndbutils.fs.ls(f'/user/{username}/courses')","commandVersion":23,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Out[11]: [FileInfo(path=&#39;dbfs:/user/root/courses/_SUCCESS&#39;, name=&#39;_SUCCESS&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/courses/_committed_4613771478078031870&#39;, name=&#39;_committed_4613771478078031870&#39;, size=376),\n FileInfo(path=&#39;dbfs:/user/root/courses/_started_4613771478078031870&#39;, name=&#39;_started_4613771478078031870&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/courses/part-00000-tid-4613771478078031870-213065bf-1784-41c2-a3cb-a28ae598f71f-12-1-c000.csv&#39;, name=&#39;part-00000-tid-4613771478078031870-213065bf-1784-41c2-a3cb-a28ae598f71f-12-1-c000.csv&#39;, size=392),\n FileInfo(path=&#39;dbfs:/user/root/courses/part-00001-tid-4613771478078031870-213065bf-1784-41c2-a3cb-a28ae598f71f-13-1-c000.csv&#39;, name=&#39;part-00001-tid-4613771478078031870-213065bf-1784-41c2-a3cb-a28ae598f71f-13-1-c000.csv&#39;, size=412),\n FileInfo(path=&#39;dbfs:/user/root/courses/part-00002-tid-4613771478078031870-213065bf-1784-41c2-a3cb-a28ae598f71f-14-1-c000.csv&#39;, name=&#39;part-00002-tid-4613771478078031870-213065bf-1784-41c2-a3cb-a28ae598f71f-14-1-c000.csv&#39;, size=416),\n FileInfo(path=&#39;dbfs:/user/root/courses/part-00003-tid-4613771478078031870-213065bf-1784-41c2-a3cb-a28ae598f71f-15-1-c000.csv&#39;, name=&#39;part-00003-tid-4613771478078031870-213065bf-1784-41c2-a3cb-a28ae598f71f-15-1-c000.csv&#39;, size=485)]</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641583238564,"submitTime":1641583238532,"finishTime":1641583238640,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"7783562f-dba8-441b-ab8c-8f2314ad9abb"},{"version":"CommandV1","origId":1575837098434315,"guid":"466ef256-fc94-4cd9-a4f4-99cfe7c3c684","subtype":"command","commandType":"auto","position":3.5,"command":"dbutils.fs.rm(f'/user/{username}/courses', recurse=True)","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Out[14]: True</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641583798235,"submitTime":1641583798189,"finishTime":1641583798461,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"1aa41574-41b1-4083-a22e-255eb73f5642"},{"version":"CommandV1","origId":1575837098434316,"guid":"b7165f85-d826-43a1-a834-48b5e285d466","subtype":"command","commandType":"auto","position":4.0,"command":"courses_df.write.format('csv').save(f'/user/{username}/courses')","commandVersion":6,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641583804252,"submitTime":1641583804215,"finishTime":1641583805519,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"153fc77e-044a-4e8c-a085-3f203dffb356"},{"version":"CommandV1","origId":1575837098434317,"guid":"f547b695-a567-4b29-a245-ed0177ab3f4a","subtype":"command","commandType":"auto","position":4.5,"command":"dbutils.fs.ls(f'/user/{username}/courses')","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Out[16]: [FileInfo(path=&#39;dbfs:/user/root/courses/_SUCCESS&#39;, name=&#39;_SUCCESS&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/courses/_committed_4106485049593253071&#39;, name=&#39;_committed_4106485049593253071&#39;, size=376),\n FileInfo(path=&#39;dbfs:/user/root/courses/_started_4106485049593253071&#39;, name=&#39;_started_4106485049593253071&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/courses/part-00000-tid-4106485049593253071-10a5479c-293d-4881-8350-ca418c7d2222-20-1-c000.csv&#39;, name=&#39;part-00000-tid-4106485049593253071-10a5479c-293d-4881-8350-ca418c7d2222-20-1-c000.csv&#39;, size=392),\n FileInfo(path=&#39;dbfs:/user/root/courses/part-00001-tid-4106485049593253071-10a5479c-293d-4881-8350-ca418c7d2222-21-1-c000.csv&#39;, name=&#39;part-00001-tid-4106485049593253071-10a5479c-293d-4881-8350-ca418c7d2222-21-1-c000.csv&#39;, size=412),\n FileInfo(path=&#39;dbfs:/user/root/courses/part-00002-tid-4106485049593253071-10a5479c-293d-4881-8350-ca418c7d2222-22-1-c000.csv&#39;, name=&#39;part-00002-tid-4106485049593253071-10a5479c-293d-4881-8350-ca418c7d2222-22-1-c000.csv&#39;, size=416),\n FileInfo(path=&#39;dbfs:/user/root/courses/part-00003-tid-4106485049593253071-10a5479c-293d-4881-8350-ca418c7d2222-23-1-c000.csv&#39;, name=&#39;part-00003-tid-4106485049593253071-10a5479c-293d-4881-8350-ca418c7d2222-23-1-c000.csv&#39;, size=485)]</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641583819259,"submitTime":1641583819233,"finishTime":1641583819343,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"e6bcf2a2-e7c4-466b-b014-cd9840fd1ea1"},{"version":"CommandV1","origId":1575837098434318,"guid":"a8bd3313-b7e4-4104-8e97-4e4bf18cb3a3","subtype":"command","commandType":"auto","position":5.0,"command":"# Using spark.read.text we can read the raw data as single column dataframe\n# We can confirm the default delimiter as comma by looking at the data\nspark.read.text(f'/user/{username}/courses').show(truncate=False)","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+----------------------------------------------------------------------------------------------+\n|value                                                                                         |\n+----------------------------------------------------------------------------------------------+\n|13,The Complete Web Developer Course 2.0,Intermediate,273598,4.5,63175                        |\n|11,The Data Science Course 2020: Complete Data Science Bootcamp,Beginner,325047,4.5,76907     |\n|20,The Ultimate MySQL Bootcamp: Go from SQL Beginner to Expert,Beginner,203366,4.6,45382      |\n|2,The Web Developer Bootcamp,Beginner,596726,4.6,182997                                       |\n|19,Unreal Engine C++ Developer: Learn C++ and Make Video Games,Advanced,229005,4.5,45860      |\n|17,iOS 13 &amp; Swift 5 - The Complete iOS App Development Bootcamp,Advanced,179598,4.8,49972     |\n|18,Selenium WebDriver with Java -Basics to Advanced+Frameworks,Advanced,148562,4.6,49947      |\n|21,Spring &amp; Hibernate for Beginners (includes Spring Boot),Advanced,177053,4.6,45329          |\n|7,The Complete 2020 Web Development Bootcamp,Beginner,270656,4.7,88098                        |\n|9,The Complete JavaScript Course 2020: Build Real Projects!,Intermediate,347979,4.6,83521     |\n|16,The Complete Node.js Developer Course (3rd Edition),Advanced,202922,4.7,50885              |\n|15,Learn Python Programming Masterclass,Advanced,240790,4.5,58677                             |\n|3,Machine Learning A-Z™: Hands-On Python &amp; R In Data Science,Intermediate,692812,4.5,132228   |\n|14,Modern React with Redux [2020 Update],Intermediate,203214,4.7,60835                        |\n|8,Python for Data Science and Machine Learning Bootcamp,Intermediate,387789,4.6,87403         |\n|6,&#34;React - The Complete Guide (incl Hooks, React Router, Redux)&#34;,Intermediate,304670,4.6,90964|\n|1,2020 Complete Python Bootcamp: From Zero to Hero in Python,Beginner,1100093,4.6,318066      |\n|4,Angular - The Complete Guide (2020 Edition),Intermediate,422557,4.6,129984                  |\n|12,Automate the Boring Stuff with Python Programming,Advanced,692617,4.6,70508                |\n|10,Complete C# Unity Game Developer 2D,Advanced,364934,4.6,78989                              |\n+----------------------------------------------------------------------------------------------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641583857563,"submitTime":1641583857532,"finishTime":1641583858092,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"37701bc2-c587-4ba2-8019-0cac5e8fcc17"},{"version":"CommandV1","origId":1575837098434319,"guid":"cd154bac-048c-4301-b1ab-f30d9b33244a","subtype":"command","commandType":"auto","position":6.0,"command":"","commandVersion":0,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"e5076366-a653-454f-9bec-2b0176400bd0"}],"dashboards":[],"guid":"6e561fd5-2132-4996-8f7f-6329dca6c25a","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{"pythonIndentUnit":4}}