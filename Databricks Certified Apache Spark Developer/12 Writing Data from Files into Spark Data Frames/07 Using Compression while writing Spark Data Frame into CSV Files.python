{"version":"NotebookV1","origId":1575837098434409,"name":"07 Using Compression while writing Spark Data Frame into CSV Files","language":"python","commands":[{"version":"CommandV1","origId":1575837098434410,"guid":"29dd0b44-c6b8-4cc5-8d8e-6612ea0e0c5f","subtype":"command","commandType":"auto","position":4.0,"command":"courses = [{'course_id': 1,\n  'course_name': '2020 Complete Python Bootcamp: From Zero to Hero in Python',\n  'suitable_for': 'Beginner',\n  'enrollment': 1100093,\n  'stars': 4.6,\n  'number_of_ratings': 318066},\n {'course_id': 4,\n  'course_name': 'Angular - The Complete Guide (2020 Edition)',\n  'suitable_for': 'Intermediate',\n  'enrollment': 422557,\n  'stars': 4.6,\n  'number_of_ratings': 129984},\n {'course_id': 12,\n  'course_name': 'Automate the Boring Stuff with Python Programming',\n  'suitable_for': 'Advanced',\n  'enrollment': 692617,\n  'stars': 4.6,\n  'number_of_ratings': 70508},\n {'course_id': 10,\n  'course_name': 'Complete C# Unity Game Developer 2D',\n  'suitable_for': 'Advanced',\n  'enrollment': 364934,\n  'stars': 4.6,\n  'number_of_ratings': 78989},\n {'course_id': 5,\n  'course_name': 'Java Programming Masterclass for Software Developers',\n  'suitable_for': 'Advanced',\n  'enrollment': 502572,\n  'stars': 4.6,\n  'number_of_ratings': 123798},\n {'course_id': 15,\n  'course_name': 'Learn Python Programming Masterclass',\n  'suitable_for': 'Advanced',\n  'enrollment': 240790,\n  'stars': 4.5,\n  'number_of_ratings': 58677},\n {'course_id': 3,\n  'course_name': 'Machine Learning A-Zâ„¢: Hands-On Python & R In Data Science',\n  'suitable_for': 'Intermediate',\n  'enrollment': 692812,\n  'stars': 4.5,\n  'number_of_ratings': 132228},\n {'course_id': 14,\n  'course_name': 'Modern React with Redux [2020 Update]',\n  'suitable_for': 'Intermediate',\n  'enrollment': 203214,\n  'stars': 4.7,\n  'number_of_ratings': 60835},\n {'course_id': 8,\n  'course_name': 'Python for Data Science and Machine Learning Bootcamp',\n  'suitable_for': 'Intermediate',\n  'enrollment': 387789,\n  'stars': 4.6,\n  'number_of_ratings': 87403},\n {'course_id': 6,\n  'course_name': 'React - The Complete Guide (incl Hooks, React Router, Redux)',\n  'suitable_for': 'Intermediate',\n  'enrollment': 304670,\n  'stars': 4.6,\n  'number_of_ratings': 90964},\n {'course_id': 18,\n  'course_name': 'Selenium WebDriver with Java -Basics to Advanced+Frameworks',\n  'suitable_for': 'Advanced',\n  'enrollment': 148562,\n  'stars': 4.6,\n  'number_of_ratings': 49947},\n {'course_id': 21,\n  'course_name': 'Spring & Hibernate for Beginners (includes Spring Boot)',\n  'suitable_for': 'Advanced',\n  'enrollment': 177053,\n  'stars': 4.6,\n  'number_of_ratings': 45329},\n {'course_id': 7,\n  'course_name': 'The Complete 2020 Web Development Bootcamp',\n  'suitable_for': 'Beginner',\n  'enrollment': 270656,\n  'stars': 4.7,\n  'number_of_ratings': 88098},\n {'course_id': 9,\n  'course_name': 'The Complete JavaScript Course 2020: Build Real Projects!',\n  'suitable_for': 'Intermediate',\n  'enrollment': 347979,\n  'stars': 4.6,\n  'number_of_ratings': 83521},\n {'course_id': 16,\n  'course_name': 'The Complete Node.js Developer Course (3rd Edition)',\n  'suitable_for': 'Advanced',\n  'enrollment': 202922,\n  'stars': 4.7,\n  'number_of_ratings': 50885},\n {'course_id': 13,\n  'course_name': 'The Complete Web Developer Course 2.0',\n  'suitable_for': 'Intermediate',\n  'enrollment': 273598,\n  'stars': 4.5,\n  'number_of_ratings': 63175},\n {'course_id': 11,\n  'course_name': 'The Data Science Course 2020: Complete Data Science Bootcamp',\n  'suitable_for': 'Beginner',\n  'enrollment': 325047,\n  'stars': 4.5,\n  'number_of_ratings': 76907},\n {'course_id': 20,\n  'course_name': 'The Ultimate MySQL Bootcamp: Go from SQL Beginner to Expert',\n  'suitable_for': 'Beginner',\n  'enrollment': 203366,\n  'stars': 4.6,\n  'number_of_ratings': 45382},\n {'course_id': 2,\n  'course_name': 'The Web Developer Bootcamp',\n  'suitable_for': 'Beginner',\n  'enrollment': 596726,\n  'stars': 4.6,\n  'number_of_ratings': 182997},\n {'course_id': 19,\n  'course_name': 'Unreal Engine C++ Developer: Learn C++ and Make Video Games',\n  'suitable_for': 'Advanced',\n  'enrollment': 229005,\n  'stars': 4.5,\n  'number_of_ratings': 45860},\n {'course_id': 17,\n  'course_name': 'iOS 13 & Swift 5 - The Complete iOS App Development Bootcamp',\n  'suitable_for': 'Advanced',\n  'enrollment': 179598,\n  'stars': 4.8,\n  'number_of_ratings': 49972}]\n\nfrom pyspark.sql import Row\ncourses_df = spark.createDataFrame([Row(**course) for course in courses])","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"courses_df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"course_id","nullable":true,"type":"long"},{"metadata":{},"name":"course_name","nullable":true,"type":"string"},{"metadata":{},"name":"suitable_for","nullable":true,"type":"string"},{"metadata":{},"name":"enrollment","nullable":true,"type":"long"},{"metadata":{},"name":"stars","nullable":true,"type":"double"},{"metadata":{},"name":"number_of_ratings","nullable":true,"type":"long"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641584712966,"submitTime":1641584712900,"finishTime":1641584713287,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"4fb416a5-2b12-4c26-85c5-4a368b6dc208"},{"version":"CommandV1","origId":1575837098434411,"guid":"b09aacbe-bd30-4f8b-9412-99878447c8ef","subtype":"command","commandType":"auto","position":5.0,"command":"import getpass\nusername = getpass.getuser()","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641584721272,"submitTime":1641584721244,"finishTime":1641584721315,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"9548cd26-10f7-42c1-8dcb-3f80c8d18d2e"},{"version":"CommandV1","origId":1575837098434412,"guid":"501fc690-d9a3-4714-9975-7080aef85255","subtype":"command","commandType":"auto","position":5.25,"command":"dbutils.fs.rm(f'/user/{username}/courses', recurse=True)","commandVersion":5,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Out[3]: True</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641584729654,"submitTime":1641584729628,"finishTime":1641584730010,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"4edeb10b-5107-4643-9c63-e02799d996e6"},{"version":"CommandV1","origId":1575837098434413,"guid":"9ecb5f9b-9ebd-4693-8f85-c281cb605418","subtype":"command","commandType":"auto","position":5.5,"command":"courses_df. \\\n    coalesce(1). \\\n    write. \\\n    csv(\n        f'/user/{username}/courses', \n        mode='overwrite', \n        header=True\n    )","commandVersion":2,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641584740276,"submitTime":1641584740256,"finishTime":1641584741396,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"f5c25c5d-df9a-46aa-8a8e-33f9e54aefe9"},{"version":"CommandV1","origId":1575837098434414,"guid":"4c013fbf-e892-4ad8-a721-d827482bf050","subtype":"command","commandType":"auto","position":5.75,"command":"dbutils.fs.ls(f'/user/{username}/courses')","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Out[5]: [FileInfo(path=&#39;dbfs:/user/root/courses/_SUCCESS&#39;, name=&#39;_SUCCESS&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/courses/_committed_270357566066082347&#39;, name=&#39;_committed_270357566066082347&#39;, size=111),\n FileInfo(path=&#39;dbfs:/user/root/courses/_started_270357566066082347&#39;, name=&#39;_started_270357566066082347&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/courses/part-00000-tid-270357566066082347-7eba28f8-28f6-4408-8de3-74340acaddb6-46-1-c000.csv&#39;, name=&#39;part-00000-tid-270357566066082347-7eba28f8-28f6-4408-8de3-74340acaddb6-46-1-c000.csv&#39;, size=1775)]</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641584748702,"submitTime":1641584748680,"finishTime":1641584748771,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"94888ffc-6f81-4014-b6bc-8a4cf9714168"},{"version":"CommandV1","origId":1575837098434415,"guid":"77a33eaa-c4f5-4cea-af9b-e6bdfa9b45a6","subtype":"command","commandType":"auto","position":6.0,"command":"help(courses_df.write.csv)","commandVersion":5,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Help on method csv in module pyspark.sql.readwriter:\n\ncsv(path, mode=None, compression=None, sep=None, quote=None, escape=None, header=None, nullValue=None, escapeQuotes=None, quoteAll=None, dateFormat=None, timestampFormat=None, ignoreLeadingWhiteSpace=None, ignoreTrailingWhiteSpace=None, charToEscapeQuoteEscaping=None, encoding=None, emptyValue=None, lineSep=None) method of pyspark.sql.readwriter.DataFrameWriter instance\n    Saves the content of the :class:`DataFrame` in CSV format at the specified path.\n    \n    .. versionadded:: 2.0.0\n    \n    Parameters\n    ----------\n    path : str\n        the path in any Hadoop supported file system\n    mode : str, optional\n        specifies the behavior of the save operation when data already exists.\n    \n        * ``append``: Append contents of this :class:`DataFrame` to existing data.\n        * ``overwrite``: Overwrite existing data.\n        * ``ignore``: Silently ignore this operation if data already exists.\n        * ``error`` or ``errorifexists`` (default case): Throw an exception if data already \\\n            exists.\n    \n    compression : str, optional\n        compression codec to use when saving to file. This can be one of the\n        known case-insensitive shorten names (none, bzip2, gzip, lz4,\n        snappy and deflate).\n    sep : str, optional\n        sets a separator (one or more characters) for each field and value. If None is\n        set, it uses the default value, ``,``.\n    quote : str, optional\n        sets a single character used for escaping quoted values where the\n        separator can be part of the value. If None is set, it uses the default\n        value, ``&#34;``. If an empty string is set, it uses ``u0000`` (null character).\n    escape : str, optional\n        sets a single character used for escaping quotes inside an already\n        quoted value. If None is set, it uses the default value, ``\\``\n    escapeQuotes : str or bool, optional\n        a flag indicating whether values containing quotes should always\n        be enclosed in quotes. If None is set, it uses the default value\n        ``true``, escaping all values containing a quote character.\n    quoteAll : str or bool, optional\n        a flag indicating whether all values should always be enclosed in\n        quotes. If None is set, it uses the default value ``false``,\n        only escaping values containing a quote character.\n    header : str or bool, optional\n        writes the names of columns as the first line. If None is set, it uses\n        the default value, ``false``.\n    nullValue : str, optional\n        sets the string representation of a null value. If None is set, it uses\n        the default value, empty string.\n    dateFormat : str, optional\n        sets the string that indicates a date format. Custom date formats follow\n        the formats at\n        `datetime pattern &lt;https://spark.apache.org/docs/latest/sql-ref-datetime-pattern.html&gt;`_.  # noqa\n        This applies to date type. If None is set, it uses the\n        default value, ``yyyy-MM-dd``.\n    timestampFormat : str, optional\n        sets the string that indicates a timestamp format.\n        Custom date formats follow the formats at\n        `datetime pattern &lt;https://spark.apache.org/docs/latest/sql-ref-datetime-pattern.html&gt;`_.  # noqa\n        This applies to timestamp type. If None is set, it uses the\n        default value, ``yyyy-MM-dd&#39;T&#39;HH:mm:ss[.SSS][XXX]``.\n    ignoreLeadingWhiteSpace : str or bool, optional\n        a flag indicating whether or not leading whitespaces from\n        values being written should be skipped. If None is set, it\n        uses the default value, ``true``.\n    ignoreTrailingWhiteSpace : str or bool, optional\n        a flag indicating whether or not trailing whitespaces from\n        values being written should be skipped. If None is set, it\n        uses the default value, ``true``.\n    charToEscapeQuoteEscaping : str, optional\n        sets a single character used for escaping the escape for\n        the quote character. If None is set, the default value is\n        escape character when escape and quote characters are\n        different, ``\\0`` otherwise..\n    encoding : str, optional\n        sets the encoding (charset) of saved csv files. If None is set,\n        the default UTF-8 charset will be used.\n    emptyValue : str, optional\n        sets the string representation of an empty value. If None is set, it uses\n        the default value, ``&#34;&#34;``.\n    lineSep : str, optional\n        defines the line separator that should be used for writing. If None is\n        set, it uses the default value, ``\\\\n``. Maximum length is 1 character.\n    \n    Examples\n    --------\n    &gt;&gt;&gt; df.write.csv(os.path.join(tempfile.mkdtemp(), &#39;data&#39;))\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641584765845,"submitTime":1641584765823,"finishTime":1641584765869,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"d94a5a2b-efb8-4273-af23-45703aee12ba"},{"version":"CommandV1","origId":1575837098434416,"guid":"cc1ebd2d-305b-42bf-9efb-98205d2bbf19","subtype":"command","commandType":"auto","position":7.0,"command":"courses_df. \\\n    coalesce(1). \\\n    write. \\\n    csv(\n        f'/user/{username}/courses', \n        mode='overwrite', \n        compression='gzip',\n        header=True\n    )","commandVersion":11,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641584943155,"submitTime":1641584943115,"finishTime":1641584945084,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"bd368a3a-527d-4a40-8494-63b7698ad937"},{"version":"CommandV1","origId":1575837098434417,"guid":"244ecd53-c3d6-4ede-a133-a5533513c660","subtype":"command","commandType":"auto","position":7.25,"command":"dbutils.fs.ls(f'/user/{username}/courses')","commandVersion":8,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Out[8]: [FileInfo(path=&#39;dbfs:/user/root/courses/_SUCCESS&#39;, name=&#39;_SUCCESS&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/courses/_committed_270357566066082347&#39;, name=&#39;_committed_270357566066082347&#39;, size=111),\n FileInfo(path=&#39;dbfs:/user/root/courses/_committed_3612338193378723237&#39;, name=&#39;_committed_3612338193378723237&#39;, size=212),\n FileInfo(path=&#39;dbfs:/user/root/courses/_started_270357566066082347&#39;, name=&#39;_started_270357566066082347&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/courses/_started_3612338193378723237&#39;, name=&#39;_started_3612338193378723237&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/courses/part-00000-tid-3612338193378723237-60ec2218-868a-4deb-8e9e-099396fd7c56-47-1-c000.csv.gz&#39;, name=&#39;part-00000-tid-3612338193378723237-60ec2218-868a-4deb-8e9e-099396fd7c56-47-1-c000.csv.gz&#39;, size=896)]</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641584954681,"submitTime":1641584954662,"finishTime":1641584954738,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"13d2214e-f7f8-4866-aa21-036662cd0726"},{"version":"CommandV1","origId":1575837098434418,"guid":"85277fd3-2363-425b-a73b-22bd7d1d1e75","subtype":"command","commandType":"auto","position":7.5,"command":"spark.read.csv(f'/user/{username}/courses', header=True).show()","commandVersion":9,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+---------+--------------------+------------+----------+-----+-----------------+\n|course_id|         course_name|suitable_for|enrollment|stars|number_of_ratings|\n+---------+--------------------+------------+----------+-----+-----------------+\n|        1|2020 Complete Pyt...|    Beginner|   1100093|  4.6|           318066|\n|        4|Angular - The Com...|Intermediate|    422557|  4.6|           129984|\n|       12|Automate the Bori...|    Advanced|    692617|  4.6|            70508|\n|       10|Complete C# Unity...|    Advanced|    364934|  4.6|            78989|\n|        5|Java Programming ...|    Advanced|    502572|  4.6|           123798|\n|       15|Learn Python Prog...|    Advanced|    240790|  4.5|            58677|\n|        3|Machine Learning ...|Intermediate|    692812|  4.5|           132228|\n|       14|Modern React with...|Intermediate|    203214|  4.7|            60835|\n|        8|Python for Data S...|Intermediate|    387789|  4.6|            87403|\n|        6|React - The Compl...|Intermediate|    304670|  4.6|            90964|\n|       18|Selenium WebDrive...|    Advanced|    148562|  4.6|            49947|\n|       21|Spring &amp; Hibernat...|    Advanced|    177053|  4.6|            45329|\n|        7|The Complete 2020...|    Beginner|    270656|  4.7|            88098|\n|        9|The Complete Java...|Intermediate|    347979|  4.6|            83521|\n|       16|The Complete Node...|    Advanced|    202922|  4.7|            50885|\n|       13|The Complete Web ...|Intermediate|    273598|  4.5|            63175|\n|       11|The Data Science ...|    Beginner|    325047|  4.5|            76907|\n|       20|The Ultimate MySQ...|    Beginner|    203366|  4.6|            45382|\n|        2|The Web Developer...|    Beginner|    596726|  4.6|           182997|\n|       19|Unreal Engine C++...|    Advanced|    229005|  4.5|            45860|\n+---------+--------------------+------------+----------+-----+-----------------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641585089729,"submitTime":1641585089690,"finishTime":1641585090857,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"3673a2a6-34f6-466d-80a9-f4e950011ef3"},{"version":"CommandV1","origId":1575837098434419,"guid":"d05de5a0-a9a0-40bb-8714-e38519ccd290","subtype":"command","commandType":"auto","position":9.0,"command":"courses_df. \\\n    coalesce(1). \\\n    write. \\\n    format('csv'). \\\n    save(\n        f'/user/{username}/courses', \n        mode='overwrite', \n        compression='snappy',\n        header=True\n    )","commandVersion":3,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641585107431,"submitTime":1641585107409,"finishTime":1641585129475,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"1461b979-d5d0-4530-8dd5-6010ba5a61cc"},{"version":"CommandV1","origId":1575837098434420,"guid":"7d5563b8-422e-4cab-9ffb-debfc7320ec7","subtype":"command","commandType":"auto","position":10.0,"command":"dbutils.fs.ls(f'/user/{username}/courses')","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Out[11]: [FileInfo(path=&#39;dbfs:/user/root/courses/_SUCCESS&#39;, name=&#39;_SUCCESS&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/courses/_committed_270357566066082347&#39;, name=&#39;_committed_270357566066082347&#39;, size=111),\n FileInfo(path=&#39;dbfs:/user/root/courses/_committed_3612338193378723237&#39;, name=&#39;_committed_3612338193378723237&#39;, size=212),\n FileInfo(path=&#39;dbfs:/user/root/courses/_committed_3995056409387264638&#39;, name=&#39;_committed_3995056409387264638&#39;, size=209),\n FileInfo(path=&#39;dbfs:/user/root/courses/_started_270357566066082347&#39;, name=&#39;_started_270357566066082347&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/courses/_started_3612338193378723237&#39;, name=&#39;_started_3612338193378723237&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/courses/_started_3995056409387264638&#39;, name=&#39;_started_3995056409387264638&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/courses/part-00000-tid-3995056409387264638-27d4dfb2-565b-4e26-9644-95a79fd5c901-50-1-c000.csv.snappy&#39;, name=&#39;part-00000-tid-3995056409387264638-27d4dfb2-565b-4e26-9644-95a79fd5c901-50-1-c000.csv.snappy&#39;, size=1216)]</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641585135722,"submitTime":1641585135700,"finishTime":1641585135846,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"5fef4414-7ec9-4300-a927-c6ec501fa361"},{"version":"CommandV1","origId":1575837098434421,"guid":"89723a3e-ca9a-4173-97fd-6868c530aa2a","subtype":"command","commandType":"auto","position":11.0,"command":"spark.read.csv(f'/user/{username}/courses', header=True).show()","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+---------+--------------------+------------+----------+-----+-----------------+\n|course_id|         course_name|suitable_for|enrollment|stars|number_of_ratings|\n+---------+--------------------+------------+----------+-----+-----------------+\n|        1|2020 Complete Pyt...|    Beginner|   1100093|  4.6|           318066|\n|        4|Angular - The Com...|Intermediate|    422557|  4.6|           129984|\n|       12|Automate the Bori...|    Advanced|    692617|  4.6|            70508|\n|       10|Complete C# Unity...|    Advanced|    364934|  4.6|            78989|\n|        5|Java Programming ...|    Advanced|    502572|  4.6|           123798|\n|       15|Learn Python Prog...|    Advanced|    240790|  4.5|            58677|\n|        3|Machine Learning ...|Intermediate|    692812|  4.5|           132228|\n|       14|Modern React with...|Intermediate|    203214|  4.7|            60835|\n|        8|Python for Data S...|Intermediate|    387789|  4.6|            87403|\n|        6|React - The Compl...|Intermediate|    304670|  4.6|            90964|\n|       18|Selenium WebDrive...|    Advanced|    148562|  4.6|            49947|\n|       21|Spring &amp; Hibernat...|    Advanced|    177053|  4.6|            45329|\n|        7|The Complete 2020...|    Beginner|    270656|  4.7|            88098|\n|        9|The Complete Java...|Intermediate|    347979|  4.6|            83521|\n|       16|The Complete Node...|    Advanced|    202922|  4.7|            50885|\n|       13|The Complete Web ...|Intermediate|    273598|  4.5|            63175|\n|       11|The Data Science ...|    Beginner|    325047|  4.5|            76907|\n|       20|The Ultimate MySQ...|    Beginner|    203366|  4.6|            45382|\n|        2|The Web Developer...|    Beginner|    596726|  4.6|           182997|\n|       19|Unreal Engine C++...|    Advanced|    229005|  4.5|            45860|\n+---------+--------------------+------------+----------+-----+-----------------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641585227810,"submitTime":1641585227770,"finishTime":1641585228607,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"a296cbab-b8c6-46f1-a9aa-3a50e0d7526f"},{"version":"CommandV1","origId":1575837098434422,"guid":"cc835b08-5ee4-497a-99d1-206f75956a9c","subtype":"command","commandType":"auto","position":12.0,"command":"","commandVersion":0,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"c77c95c9-24fd-4031-bf0c-737bafa24d23"}],"dashboards":[],"guid":"3bc9656a-1de6-4246-b917-38217f909c86","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{"pythonIndentUnit":4}}