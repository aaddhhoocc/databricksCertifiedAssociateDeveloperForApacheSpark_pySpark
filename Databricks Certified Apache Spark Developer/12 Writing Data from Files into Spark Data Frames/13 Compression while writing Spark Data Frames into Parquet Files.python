{"version":"NotebookV1","origId":1575837098434273,"name":"13 Compression while writing Spark Data Frames into Parquet Files","language":"python","commands":[{"version":"CommandV1","origId":1575837098434274,"guid":"42b72f7f-d823-4ee0-921e-6af675cfa006","subtype":"command","commandType":"auto","position":1.0,"command":"courses = [{'course_id': 1,\n  'course_name': '2020 Complete Python Bootcamp: From Zero to Hero in Python',\n  'suitable_for': 'Beginner',\n  'enrollment': 1100093,\n  'stars': 4.6,\n  'number_of_ratings': 318066},\n {'course_id': 4,\n  'course_name': 'Angular - The Complete Guide (2020 Edition)',\n  'suitable_for': 'Intermediate',\n  'enrollment': 422557,\n  'stars': 4.6,\n  'number_of_ratings': 129984},\n {'course_id': 12,\n  'course_name': 'Automate the Boring Stuff with Python Programming',\n  'suitable_for': 'Advanced',\n  'enrollment': 692617,\n  'stars': 4.6,\n  'number_of_ratings': 70508},\n {'course_id': 10,\n  'course_name': 'Complete C# Unity Game Developer 2D',\n  'suitable_for': 'Advanced',\n  'enrollment': 364934,\n  'stars': 4.6,\n  'number_of_ratings': 78989},\n {'course_id': 5,\n  'course_name': 'Java Programming Masterclass for Software Developers',\n  'suitable_for': 'Advanced',\n  'enrollment': 502572,\n  'stars': 4.6,\n  'number_of_ratings': 123798},\n {'course_id': 15,\n  'course_name': 'Learn Python Programming Masterclass',\n  'suitable_for': 'Advanced',\n  'enrollment': 240790,\n  'stars': 4.5,\n  'number_of_ratings': 58677},\n {'course_id': 3,\n  'course_name': 'Machine Learning A-Zâ„¢: Hands-On Python & R In Data Science',\n  'suitable_for': 'Intermediate',\n  'enrollment': 692812,\n  'stars': 4.5,\n  'number_of_ratings': 132228},\n {'course_id': 14,\n  'course_name': 'Modern React with Redux [2020 Update]',\n  'suitable_for': 'Intermediate',\n  'enrollment': 203214,\n  'stars': 4.7,\n  'number_of_ratings': 60835},\n {'course_id': 8,\n  'course_name': 'Python for Data Science and Machine Learning Bootcamp',\n  'suitable_for': 'Intermediate',\n  'enrollment': 387789,\n  'stars': 4.6,\n  'number_of_ratings': 87403},\n {'course_id': 6,\n  'course_name': 'React - The Complete Guide (incl Hooks, React Router, Redux)',\n  'suitable_for': 'Intermediate',\n  'enrollment': 304670,\n  'stars': 4.6,\n  'number_of_ratings': 90964},\n {'course_id': 18,\n  'course_name': 'Selenium WebDriver with Java -Basics to Advanced+Frameworks',\n  'suitable_for': 'Advanced',\n  'enrollment': 148562,\n  'stars': 4.6,\n  'number_of_ratings': 49947},\n {'course_id': 21,\n  'course_name': 'Spring & Hibernate for Beginners (includes Spring Boot)',\n  'suitable_for': 'Advanced',\n  'enrollment': 177053,\n  'stars': 4.6,\n  'number_of_ratings': 45329},\n {'course_id': 7,\n  'course_name': 'The Complete 2020 Web Development Bootcamp',\n  'suitable_for': 'Beginner',\n  'enrollment': 270656,\n  'stars': 4.7,\n  'number_of_ratings': 88098},\n {'course_id': 9,\n  'course_name': 'The Complete JavaScript Course 2020: Build Real Projects!',\n  'suitable_for': 'Intermediate',\n  'enrollment': 347979,\n  'stars': 4.6,\n  'number_of_ratings': 83521},\n {'course_id': 16,\n  'course_name': 'The Complete Node.js Developer Course (3rd Edition)',\n  'suitable_for': 'Advanced',\n  'enrollment': 202922,\n  'stars': 4.7,\n  'number_of_ratings': 50885},\n {'course_id': 13,\n  'course_name': 'The Complete Web Developer Course 2.0',\n  'suitable_for': 'Intermediate',\n  'enrollment': 273598,\n  'stars': 4.5,\n  'number_of_ratings': 63175},\n {'course_id': 11,\n  'course_name': 'The Data Science Course 2020: Complete Data Science Bootcamp',\n  'suitable_for': 'Beginner',\n  'enrollment': 325047,\n  'stars': 4.5,\n  'number_of_ratings': 76907},\n {'course_id': 20,\n  'course_name': 'The Ultimate MySQL Bootcamp: Go from SQL Beginner to Expert',\n  'suitable_for': 'Beginner',\n  'enrollment': 203366,\n  'stars': 4.6,\n  'number_of_ratings': 45382},\n {'course_id': 2,\n  'course_name': 'The Web Developer Bootcamp',\n  'suitable_for': 'Beginner',\n  'enrollment': 596726,\n  'stars': 4.6,\n  'number_of_ratings': 182997},\n {'course_id': 19,\n  'course_name': 'Unreal Engine C++ Developer: Learn C++ and Make Video Games',\n  'suitable_for': 'Advanced',\n  'enrollment': 229005,\n  'stars': 4.5,\n  'number_of_ratings': 45860},\n {'course_id': 17,\n  'course_name': 'iOS 13 & Swift 5 - The Complete iOS App Development Bootcamp',\n  'suitable_for': 'Advanced',\n  'enrollment': 179598,\n  'stars': 4.8,\n  'number_of_ratings': 49972}]\n\nfrom pyspark.sql import Row\ncourses_df = spark.createDataFrame([Row(**course) for course in courses])","commandVersion":5,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"courses_df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"course_id","nullable":true,"type":"long"},{"metadata":{},"name":"course_name","nullable":true,"type":"string"},{"metadata":{},"name":"suitable_for","nullable":true,"type":"string"},{"metadata":{},"name":"enrollment","nullable":true,"type":"long"},{"metadata":{},"name":"stars","nullable":true,"type":"double"},{"metadata":{},"name":"number_of_ratings","nullable":true,"type":"long"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641592260247,"submitTime":1641592260213,"finishTime":1641592260573,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"c2ed4710-0c33-49dd-b14f-e49b1496084f"},{"version":"CommandV1","origId":1575837098434275,"guid":"7e264451-28c2-4636-80a5-df4a80585b4d","subtype":"command","commandType":"auto","position":3.5,"command":"import getpass\nusername = getpass.getuser()","commandVersion":11,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641592266586,"submitTime":1641592266552,"finishTime":1641592266606,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"5f8b2f2d-7ed9-4a7d-b254-580158aa26b1"},{"version":"CommandV1","origId":1575837098434276,"guid":"e07d3f27-a87d-44fc-823d-dba01059b3a3","subtype":"command","commandType":"auto","position":4.75,"command":"dbutils.fs.rm(f'/user/{username}/courses', recurse=True)","commandVersion":6,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Out[3]: True</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641592275046,"submitTime":1641592275015,"finishTime":1641592275359,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"e87f43b1-ae4e-4569-8a1b-ca25372cafb0"},{"version":"CommandV1","origId":1575837098434277,"guid":"79e784ba-e908-4173-8675-8b1a12eaa259","subtype":"command","commandType":"auto","position":6.0,"command":"# By default parquet files are compressed using snappy\ncourses_df. \\\n    coalesce(1). \\\n    write. \\\n    parquet(\n        f'/user/{username}/courses', \n        mode='overwrite'\n    )","commandVersion":23,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641592297687,"submitTime":1641592297655,"finishTime":1641592298910,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"3e6384dc-007f-448e-9233-8093b37344fb"},{"version":"CommandV1","origId":1575837098434278,"guid":"c2796b2f-fb21-4b69-b87c-6b1ea9578783","subtype":"command","commandType":"auto","position":7.0,"command":"dbutils.fs.ls(f'/user/{username}/courses')","commandVersion":7,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Out[5]: [FileInfo(path=&#39;dbfs:/user/root/courses/_SUCCESS&#39;, name=&#39;_SUCCESS&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/courses/_committed_8494539776347143335&#39;, name=&#39;_committed_8494539776347143335&#39;, size=123),\n FileInfo(path=&#39;dbfs:/user/root/courses/_started_8494539776347143335&#39;, name=&#39;_started_8494539776347143335&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/courses/part-00000-tid-8494539776347143335-02c1110e-d2af-4d13-b581-15af6cb6e46d-23-1-c000.snappy.parquet&#39;, name=&#39;part-00000-tid-8494539776347143335-02c1110e-d2af-4d13-b581-15af6cb6e46d-23-1-c000.snappy.parquet&#39;, size=3219)]</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641592303487,"submitTime":1641592303456,"finishTime":1641592303528,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"e28b21ac-140e-4c0a-862c-f7da14a614bf"},{"version":"CommandV1","origId":1575837098434279,"guid":"6eecad25-cc6c-4e9c-8bdc-8a956937f818","subtype":"command","commandType":"auto","position":8.0,"command":"spark.read.parquet(f'/user/{username}/courses').show()","commandVersion":8,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+---------+--------------------+------------+----------+-----+-----------------+\n|course_id|         course_name|suitable_for|enrollment|stars|number_of_ratings|\n+---------+--------------------+------------+----------+-----+-----------------+\n|        1|2020 Complete Pyt...|    Beginner|   1100093|  4.6|           318066|\n|        4|Angular - The Com...|Intermediate|    422557|  4.6|           129984|\n|       12|Automate the Bori...|    Advanced|    692617|  4.6|            70508|\n|       10|Complete C# Unity...|    Advanced|    364934|  4.6|            78989|\n|        5|Java Programming ...|    Advanced|    502572|  4.6|           123798|\n|       15|Learn Python Prog...|    Advanced|    240790|  4.5|            58677|\n|        3|Machine Learning ...|Intermediate|    692812|  4.5|           132228|\n|       14|Modern React with...|Intermediate|    203214|  4.7|            60835|\n|        8|Python for Data S...|Intermediate|    387789|  4.6|            87403|\n|        6|React - The Compl...|Intermediate|    304670|  4.6|            90964|\n|       18|Selenium WebDrive...|    Advanced|    148562|  4.6|            49947|\n|       21|Spring &amp; Hibernat...|    Advanced|    177053|  4.6|            45329|\n|        7|The Complete 2020...|    Beginner|    270656|  4.7|            88098|\n|        9|The Complete Java...|Intermediate|    347979|  4.6|            83521|\n|       16|The Complete Node...|    Advanced|    202922|  4.7|            50885|\n|       13|The Complete Web ...|Intermediate|    273598|  4.5|            63175|\n|       11|The Data Science ...|    Beginner|    325047|  4.5|            76907|\n|       20|The Ultimate MySQ...|    Beginner|    203366|  4.6|            45382|\n|        2|The Web Developer...|    Beginner|    596726|  4.6|           182997|\n|       19|Unreal Engine C++...|    Advanced|    229005|  4.5|            45860|\n+---------+--------------------+------------+----------+-----+-----------------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641592329605,"submitTime":1641592329570,"finishTime":1641592330061,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"267aefd0-b0c3-4a4a-a3ec-2e9c3107a8a9"},{"version":"CommandV1","origId":1575837098434280,"guid":"da2294ff-a797-4089-bf0e-ee709427bc8e","subtype":"command","commandType":"auto","position":8.5,"command":"dbutils.fs.rm(f'/user/{username}/courses', recurse=True)","commandVersion":8,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Out[7]: True</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641592345048,"submitTime":1641592345016,"finishTime":1641592345170,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"bd448f9d-d18f-4b98-9d9c-a914945d018b"},{"version":"CommandV1","origId":1575837098434281,"guid":"08d726fe-67b0-49a2-af4f-a9534ba63c40","subtype":"command","commandType":"auto","position":8.75,"command":"help(courses_df.write.parquet)","commandVersion":6,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Help on method parquet in module pyspark.sql.readwriter:\n\nparquet(path, mode=None, partitionBy=None, compression=None) method of pyspark.sql.readwriter.DataFrameWriter instance\n    Saves the content of the :class:`DataFrame` in Parquet format at the specified path.\n    \n    .. versionadded:: 1.4.0\n    \n    Parameters\n    ----------\n    path : str\n        the path in any Hadoop supported file system\n    mode : str, optional\n        specifies the behavior of the save operation when data already exists.\n    \n        * ``append``: Append contents of this :class:`DataFrame` to existing data.\n        * ``overwrite``: Overwrite existing data.\n        * ``ignore``: Silently ignore this operation if data already exists.\n        * ``error`` or ``errorifexists`` (default case): Throw an exception if data already                 exists.\n    partitionBy : str or list, optional\n        names of partitioning columns\n    compression : str, optional\n        compression codec to use when saving to file. This can be one of the\n        known case-insensitive shorten names (none, uncompressed, snappy, gzip,\n        lzo, brotli, lz4, and zstd). This will override\n        ``spark.sql.parquet.compression.codec``. If None is set, it uses the\n        value specified in ``spark.sql.parquet.compression.codec``.\n    \n    Examples\n    --------\n    &gt;&gt;&gt; df.write.parquet(os.path.join(tempfile.mkdtemp(), &#39;data&#39;))\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641592349224,"submitTime":1641592349190,"finishTime":1641592349246,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"473cdf34-014f-4fe3-a7d5-e50fb7c20b79"},{"version":"CommandV1","origId":1575837098434282,"guid":"615507a3-8ad7-45f7-a452-632dc3165380","subtype":"command","commandType":"auto","position":8.875,"command":"spark.conf.get('spark.sql.parquet.compression.codec')","commandVersion":4,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Out[10]: &#39;snappy&#39;</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641592650526,"submitTime":1641592650474,"finishTime":1641592650551,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"7519c040-46bb-4d71-a347-dc5bd8e1c67f"},{"version":"CommandV1","origId":1575837098434283,"guid":"4cba0d90-6477-4b95-834e-7d86e01f5a3f","subtype":"command","commandType":"auto","position":9.0,"command":"# Write parquet files without compression\n# compression can be set to none or uncompressed\ncourses_df. \\\n    coalesce(1). \\\n    write. \\\n    parquet(\n        f'/user/{username}/courses', \n        mode='overwrite',\n        compression='none'\n    )","commandVersion":33,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641592731862,"submitTime":1641592731813,"finishTime":1641592732746,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"4d1034d4-0eab-4326-a39a-9be4192e3c55"},{"version":"CommandV1","origId":1575837098434284,"guid":"7dbe6dca-830c-4ac5-bc75-89dcbe674941","subtype":"command","commandType":"auto","position":10.0,"command":"dbutils.fs.ls(f'/user/{username}/courses')","commandVersion":2,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Out[12]: [FileInfo(path=&#39;dbfs:/user/root/courses/_SUCCESS&#39;, name=&#39;_SUCCESS&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/courses/_committed_3786840065002814231&#39;, name=&#39;_committed_3786840065002814231&#39;, size=116),\n FileInfo(path=&#39;dbfs:/user/root/courses/_started_3786840065002814231&#39;, name=&#39;_started_3786840065002814231&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/courses/part-00000-tid-3786840065002814231-b0a740e3-46e4-4ef9-af6a-a64018241f52-26-1-c000.parquet&#39;, name=&#39;part-00000-tid-3786840065002814231-b0a740e3-46e4-4ef9-af6a-a64018241f52-26-1-c000.parquet&#39;, size=3758)]</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641592741516,"submitTime":1641592741479,"finishTime":1641592741570,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"099c2848-a65d-4d2c-88f8-26ba824c101e"},{"version":"CommandV1","origId":1575837098434285,"guid":"9e35c70d-10a2-4a81-9987-1e14b9f44e21","subtype":"command","commandType":"auto","position":11.0,"command":"courses_df. \\\n    coalesce(1). \\\n    write. \\\n    parquet(\n        f'/user/{username}/courses', \n        mode='overwrite',\n        compression='gzip'\n    )","commandVersion":2,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641592874379,"submitTime":1641592874333,"finishTime":1641592876607,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"feb458fb-c4fc-4a86-8352-892ac286622e"},{"version":"CommandV1","origId":1575837098434286,"guid":"d9e81326-cc8f-43a8-ad14-c71bd105abec","subtype":"command","commandType":"auto","position":12.0,"command":"dbutils.fs.ls(f'/user/{username}/courses')","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Out[14]: [FileInfo(path=&#39;dbfs:/user/root/courses/_SUCCESS&#39;, name=&#39;_SUCCESS&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/courses/_committed_3786840065002814231&#39;, name=&#39;_committed_3786840065002814231&#39;, size=116),\n FileInfo(path=&#39;dbfs:/user/root/courses/_committed_6761771556618609976&#39;, name=&#39;_committed_6761771556618609976&#39;, size=221),\n FileInfo(path=&#39;dbfs:/user/root/courses/_started_3786840065002814231&#39;, name=&#39;_started_3786840065002814231&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/courses/_started_6761771556618609976&#39;, name=&#39;_started_6761771556618609976&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/courses/part-00000-tid-6761771556618609976-f1de29e5-485b-4c86-9438-abde983f8e06-27-1-c000.gz.parquet&#39;, name=&#39;part-00000-tid-6761771556618609976-f1de29e5-485b-4c86-9438-abde983f8e06-27-1-c000.gz.parquet&#39;, size=3035)]</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641592883171,"submitTime":1641592883137,"finishTime":1641592883240,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"3c7e02d5-c03b-4ce6-830b-b15c6f8aa6f8"},{"version":"CommandV1","origId":1575837098434287,"guid":"10031386-c280-4cfc-8d8e-cde41300cecf","subtype":"command","commandType":"auto","position":13.0,"command":"spark.conf.set('spark.sql.parquet.compression.codec', 'none')","commandVersion":4,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641592925431,"submitTime":1641592925402,"finishTime":1641592925470,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"4fcc282f-c00a-4df7-8384-29e1849caafe"},{"version":"CommandV1","origId":1575837098434288,"guid":"700f91c2-080b-46e8-a38f-519810d62990","subtype":"command","commandType":"auto","position":14.0,"command":"courses_df. \\\n    coalesce(1). \\\n    write. \\\n    parquet(\n        f'/user/{username}/courses', \n        mode='overwrite'\n    )","commandVersion":2,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641592943181,"submitTime":1641592943148,"finishTime":1641592944121,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"26482e76-4344-43a3-809d-83bd9340750d"},{"version":"CommandV1","origId":1575837098434289,"guid":"fe01d45d-b75f-46f6-bbdf-3e7c1fad3552","subtype":"command","commandType":"auto","position":15.0,"command":"dbutils.fs.ls(f'/user/{username}/courses')","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Out[17]: [FileInfo(path=&#39;dbfs:/user/root/courses/_SUCCESS&#39;, name=&#39;_SUCCESS&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/courses/_committed_1195702234740124482&#39;, name=&#39;_committed_1195702234740124482&#39;, size=210),\n FileInfo(path=&#39;dbfs:/user/root/courses/_committed_3786840065002814231&#39;, name=&#39;_committed_3786840065002814231&#39;, size=116),\n FileInfo(path=&#39;dbfs:/user/root/courses/_committed_6761771556618609976&#39;, name=&#39;_committed_6761771556618609976&#39;, size=221),\n FileInfo(path=&#39;dbfs:/user/root/courses/_started_1195702234740124482&#39;, name=&#39;_started_1195702234740124482&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/courses/_started_3786840065002814231&#39;, name=&#39;_started_3786840065002814231&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/courses/_started_6761771556618609976&#39;, name=&#39;_started_6761771556618609976&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/courses/part-00000-tid-1195702234740124482-2ea733b6-f4e3-40a2-8118-cf48f667d9e5-28-1-c000.parquet&#39;, name=&#39;part-00000-tid-1195702234740124482-2ea733b6-f4e3-40a2-8118-cf48f667d9e5-28-1-c000.parquet&#39;, size=3758)]</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641592957402,"submitTime":1641592957367,"finishTime":1641592957473,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"c60a645a-2439-4c7b-aa19-d3b09948402e"},{"version":"CommandV1","origId":1575837098434290,"guid":"0de21e10-238f-4d72-ad88-48f6451141bf","subtype":"command","commandType":"auto","position":16.0,"command":"","commandVersion":0,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"3cb5627b-568d-41e5-9cfb-5576ae67c8ac"}],"dashboards":[],"guid":"b4d2bbe9-ca12-4538-9ba9-709c557453b2","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{"pythonIndentUnit":4}}