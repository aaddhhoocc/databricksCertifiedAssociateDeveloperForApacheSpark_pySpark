{"version":"NotebookV1","origId":1575837098434249,"name":"09 Using Options while writing Spark Data Frame into CSV Files","language":"python","commands":[{"version":"CommandV1","origId":1575837098434250,"guid":"6bebd310-2fb3-4168-93b6-1b2b32995027","subtype":"command","commandType":"auto","position":4.0,"command":"dbutils.fs.ls('/public/retail_db')","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Out[1]: [FileInfo(path=&#39;dbfs:/public/retail_db/categories/&#39;, name=&#39;categories/&#39;, size=0),\n FileInfo(path=&#39;dbfs:/public/retail_db/customers/&#39;, name=&#39;customers/&#39;, size=0),\n FileInfo(path=&#39;dbfs:/public/retail_db/departments/&#39;, name=&#39;departments/&#39;, size=0),\n FileInfo(path=&#39;dbfs:/public/retail_db/order_items/&#39;, name=&#39;order_items/&#39;, size=0),\n FileInfo(path=&#39;dbfs:/public/retail_db/orders/&#39;, name=&#39;orders/&#39;, size=0),\n FileInfo(path=&#39;dbfs:/public/retail_db/products/&#39;, name=&#39;products/&#39;, size=0)]</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641586837642,"submitTime":1641586837619,"finishTime":1641586837753,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"89c5e4af-cea0-4061-a6fd-f33022dd68f8"},{"version":"CommandV1","origId":1575837098434251,"guid":"a4523c60-0f80-4049-99e7-c3bc0b776643","subtype":"command","commandType":"auto","position":6.0,"command":"schema = \"\"\"\n    order_id INT,\n    order_date TIMESTAMP,\n    order_customer_id INT,\n    order_status STRING\n\"\"\"","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641586851922,"submitTime":1641586851910,"finishTime":1641586851955,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"d411143f-ba53-42db-9461-d91fe32a55d3"},{"version":"CommandV1","origId":1575837098434252,"guid":"97d251d5-aca6-4d50-b7df-5f40484e7ccc","subtype":"command","commandType":"auto","position":8.0,"command":"orders = spark.read.csv('/public/retail_db/orders', schema=schema)","commandVersion":16,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"orders","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"order_id","nullable":true,"type":"integer"},{"metadata":{},"name":"order_date","nullable":true,"type":"timestamp"},{"metadata":{},"name":"order_customer_id","nullable":true,"type":"integer"},{"metadata":{},"name":"order_status","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641586854685,"submitTime":1641586854668,"finishTime":1641586854862,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"167960fe-cd75-48df-9373-3c06d4a1e4f0"},{"version":"CommandV1","origId":1575837098434253,"guid":"dbaba5f2-307c-42e2-b667-dcc1b709a42f","subtype":"command","commandType":"auto","position":9.0,"command":"orders.show()","commandVersion":2,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+--------+-------------------+-----------------+---------------+\n|order_id|         order_date|order_customer_id|   order_status|\n+--------+-------------------+-----------------+---------------+\n|       1|2013-07-25 00:00:00|            11599|         CLOSED|\n|       2|2013-07-25 00:00:00|              256|PENDING_PAYMENT|\n|       3|2013-07-25 00:00:00|            12111|       COMPLETE|\n|       4|2013-07-25 00:00:00|             8827|         CLOSED|\n|       5|2013-07-25 00:00:00|            11318|       COMPLETE|\n|       6|2013-07-25 00:00:00|             7130|       COMPLETE|\n|       7|2013-07-25 00:00:00|             4530|       COMPLETE|\n|       8|2013-07-25 00:00:00|             2911|     PROCESSING|\n|       9|2013-07-25 00:00:00|             5657|PENDING_PAYMENT|\n|      10|2013-07-25 00:00:00|             5648|PENDING_PAYMENT|\n|      11|2013-07-25 00:00:00|              918| PAYMENT_REVIEW|\n|      12|2013-07-25 00:00:00|             1837|         CLOSED|\n|      13|2013-07-25 00:00:00|             9149|PENDING_PAYMENT|\n|      14|2013-07-25 00:00:00|             9842|     PROCESSING|\n|      15|2013-07-25 00:00:00|             2568|       COMPLETE|\n|      16|2013-07-25 00:00:00|             7276|PENDING_PAYMENT|\n|      17|2013-07-25 00:00:00|             2667|       COMPLETE|\n|      18|2013-07-25 00:00:00|             1205|         CLOSED|\n|      19|2013-07-25 00:00:00|             9488|PENDING_PAYMENT|\n|      20|2013-07-25 00:00:00|             9198|     PROCESSING|\n+--------+-------------------+-----------------+---------------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641586858901,"submitTime":1641586858892,"finishTime":1641586859205,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"49c9e7f4-917c-4a41-ba19-dd11fca2ddb7"},{"version":"CommandV1","origId":1575837098434254,"guid":"d5177808-f156-47f7-b0af-0e33a69785b4","subtype":"command","commandType":"auto","position":9.25,"command":"help(orders.write.csv)","commandVersion":3,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Help on method csv in module pyspark.sql.readwriter:\n\ncsv(path, mode=None, compression=None, sep=None, quote=None, escape=None, header=None, nullValue=None, escapeQuotes=None, quoteAll=None, dateFormat=None, timestampFormat=None, ignoreLeadingWhiteSpace=None, ignoreTrailingWhiteSpace=None, charToEscapeQuoteEscaping=None, encoding=None, emptyValue=None, lineSep=None) method of pyspark.sql.readwriter.DataFrameWriter instance\n    Saves the content of the :class:`DataFrame` in CSV format at the specified path.\n    \n    .. versionadded:: 2.0.0\n    \n    Parameters\n    ----------\n    path : str\n        the path in any Hadoop supported file system\n    mode : str, optional\n        specifies the behavior of the save operation when data already exists.\n    \n        * ``append``: Append contents of this :class:`DataFrame` to existing data.\n        * ``overwrite``: Overwrite existing data.\n        * ``ignore``: Silently ignore this operation if data already exists.\n        * ``error`` or ``errorifexists`` (default case): Throw an exception if data already \\\n            exists.\n    \n    compression : str, optional\n        compression codec to use when saving to file. This can be one of the\n        known case-insensitive shorten names (none, bzip2, gzip, lz4,\n        snappy and deflate).\n    sep : str, optional\n        sets a separator (one or more characters) for each field and value. If None is\n        set, it uses the default value, ``,``.\n    quote : str, optional\n        sets a single character used for escaping quoted values where the\n        separator can be part of the value. If None is set, it uses the default\n        value, ``&#34;``. If an empty string is set, it uses ``u0000`` (null character).\n    escape : str, optional\n        sets a single character used for escaping quotes inside an already\n        quoted value. If None is set, it uses the default value, ``\\``\n    escapeQuotes : str or bool, optional\n        a flag indicating whether values containing quotes should always\n        be enclosed in quotes. If None is set, it uses the default value\n        ``true``, escaping all values containing a quote character.\n    quoteAll : str or bool, optional\n        a flag indicating whether all values should always be enclosed in\n        quotes. If None is set, it uses the default value ``false``,\n        only escaping values containing a quote character.\n    header : str or bool, optional\n        writes the names of columns as the first line. If None is set, it uses\n        the default value, ``false``.\n    nullValue : str, optional\n        sets the string representation of a null value. If None is set, it uses\n        the default value, empty string.\n    dateFormat : str, optional\n        sets the string that indicates a date format. Custom date formats follow\n        the formats at\n        `datetime pattern &lt;https://spark.apache.org/docs/latest/sql-ref-datetime-pattern.html&gt;`_.  # noqa\n        This applies to date type. If None is set, it uses the\n        default value, ``yyyy-MM-dd``.\n    timestampFormat : str, optional\n        sets the string that indicates a timestamp format.\n        Custom date formats follow the formats at\n        `datetime pattern &lt;https://spark.apache.org/docs/latest/sql-ref-datetime-pattern.html&gt;`_.  # noqa\n        This applies to timestamp type. If None is set, it uses the\n        default value, ``yyyy-MM-dd&#39;T&#39;HH:mm:ss[.SSS][XXX]``.\n    ignoreLeadingWhiteSpace : str or bool, optional\n        a flag indicating whether or not leading whitespaces from\n        values being written should be skipped. If None is set, it\n        uses the default value, ``true``.\n    ignoreTrailingWhiteSpace : str or bool, optional\n        a flag indicating whether or not trailing whitespaces from\n        values being written should be skipped. If None is set, it\n        uses the default value, ``true``.\n    charToEscapeQuoteEscaping : str, optional\n        sets a single character used for escaping the escape for\n        the quote character. If None is set, the default value is\n        escape character when escape and quote characters are\n        different, ``\\0`` otherwise..\n    encoding : str, optional\n        sets the encoding (charset) of saved csv files. If None is set,\n        the default UTF-8 charset will be used.\n    emptyValue : str, optional\n        sets the string representation of an empty value. If None is set, it uses\n        the default value, ``&#34;&#34;``.\n    lineSep : str, optional\n        defines the line separator that should be used for writing. If None is\n        set, it uses the default value, ``\\\\n``. Maximum length is 1 character.\n    \n    Examples\n    --------\n    &gt;&gt;&gt; df.write.csv(os.path.join(tempfile.mkdtemp(), &#39;data&#39;))\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641586866487,"submitTime":1641586866471,"finishTime":1641586866529,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"18612806-4198-4d67-bc75-4e8f70daca31"},{"version":"CommandV1","origId":1575837098434255,"guid":"6a44d2ac-a55f-4079-bbdd-d5d64a014573","subtype":"command","commandType":"auto","position":9.5,"command":"help(orders.write.option)","commandVersion":4,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Help on method option in module pyspark.sql.readwriter:\n\noption(key, value) method of pyspark.sql.readwriter.DataFrameWriter instance\n    Adds an output option for the underlying data source.\n    \n    You can set the following option(s) for writing files:\n        * ``timeZone``: sets the string that indicates a time zone ID to be used to format\n            timestamps in the JSON/CSV datasources or partition values. The following\n            formats of `timeZone` are supported:\n    \n            * Region-based zone ID: It should have the form &#39;area/city&#39;, such as                   &#39;America/Los_Angeles&#39;.\n            * Zone offset: It should be in the format &#39;(+|-)HH:mm&#39;, for example &#39;-08:00&#39; or                  &#39;+01:00&#39;. Also &#39;UTC&#39; and &#39;Z&#39; are supported as aliases of &#39;+00:00&#39;.\n    \n            Other short names like &#39;CST&#39; are not recommended to use because they can be\n            ambiguous. If it isn&#39;t set, the current value of the SQL config\n            ``spark.sql.session.timeZone`` is used by default.\n    \n    .. versionadded:: 1.5\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641586892092,"submitTime":1641586892084,"finishTime":1641586892114,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"4da5fb19-b9d9-4c87-8da7-4fb42a1a8d6b"},{"version":"CommandV1","origId":1575837098434256,"guid":"84474031-bce6-489c-9e36-88c15cdfacf1","subtype":"command","commandType":"auto","position":9.75,"command":"help(orders.write.options)","commandVersion":2,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Help on method options in module pyspark.sql.readwriter:\n\noptions(**options) method of pyspark.sql.readwriter.DataFrameWriter instance\n    Adds output options for the underlying data source.\n    \n    You can set the following option(s) for writing files:\n        * ``timeZone``: sets the string that indicates a time zone ID to be used to format\n            timestamps in the JSON/CSV datasources or partition values. The following\n            formats of `timeZone` are supported:\n    \n            * Region-based zone ID: It should have the form &#39;area/city&#39;, such as                   &#39;America/Los_Angeles&#39;.\n            * Zone offset: It should be in the format &#39;(+|-)HH:mm&#39;, for example &#39;-08:00&#39; or                  &#39;+01:00&#39;. Also &#39;UTC&#39; and &#39;Z&#39; are supported as aliases of &#39;+00:00&#39;.\n    \n            Other short names like &#39;CST&#39; are not recommended to use because they can be\n            ambiguous. If it isn&#39;t set, the current value of the SQL config\n            ``spark.sql.session.timeZone`` is used by default.\n    \n    .. versionadded:: 1.4\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641587047385,"submitTime":1641587047355,"finishTime":1641587047408,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"6bc96fb6-f7a6-4283-8f63-fe4d1c56ee09"},{"version":"CommandV1","origId":1575837098434257,"guid":"53de7be3-0968-4517-af71-ecad0c1fb977","subtype":"command","commandType":"auto","position":10.0,"command":"# Copy all the data with comma separator to pipe separator\n\nimport getpass\nusername = getpass.getuser()\n\ninput_dir = '/public/retail_db'\noutput_dir = f'/user/{username}/retail_db_pipe'","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641587063007,"submitTime":1641587062992,"finishTime":1641587063033,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"21b6b8be-cdfc-4193-92e8-cc6e7f6500b6"},{"version":"CommandV1","origId":1575837098434258,"guid":"4c61ee77-8d52-4e3e-aa62-812500487e50","subtype":"command","commandType":"auto","position":11.0,"command":"orders. \\\n    coalesce(1). \\\n    write. \\\n    mode('overwrite'). \\\n    csv(f'{output_dir}/orders', sep='|', header=True, compression='gzip')","commandVersion":3,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641587100422,"submitTime":1641587100402,"finishTime":1641587103758,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"670a9d3d-5d43-441f-bd6c-b361b7479eb4"},{"version":"CommandV1","origId":1575837098434259,"guid":"06fbee91-5e57-4657-a6fe-6b186eab059a","subtype":"command","commandType":"auto","position":11.5,"command":"dbutils.fs.ls(f'{output_dir}/orders')","commandVersion":13,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Out[10]: [FileInfo(path=&#39;dbfs:/user/root/retail_db_pipe/orders/_committed_1132925174692068341&#39;, name=&#39;_committed_1132925174692068341&#39;, size=205),\n FileInfo(path=&#39;dbfs:/user/root/retail_db_pipe/orders/_committed_1234588906270869920&#39;, name=&#39;_committed_1234588906270869920&#39;, size=202),\n FileInfo(path=&#39;dbfs:/user/root/retail_db_pipe/orders/_committed_2444051121522497353&#39;, name=&#39;_committed_2444051121522497353&#39;, size=200),\n FileInfo(path=&#39;dbfs:/user/root/retail_db_pipe/orders/_committed_3648176934209418439&#39;, name=&#39;_committed_3648176934209418439&#39;, size=203),\n FileInfo(path=&#39;dbfs:/user/root/retail_db_pipe/orders/_committed_3739906471235457527&#39;, name=&#39;_committed_3739906471235457527&#39;, size=200),\n FileInfo(path=&#39;dbfs:/user/root/retail_db_pipe/orders/_committed_4737620600354584991&#39;, name=&#39;_committed_4737620600354584991&#39;, size=201),\n FileInfo(path=&#39;dbfs:/user/root/retail_db_pipe/orders/_committed_4880425281254787174&#39;, name=&#39;_committed_4880425281254787174&#39;, size=205),\n FileInfo(path=&#39;dbfs:/user/root/retail_db_pipe/orders/_committed_4947663999967497501&#39;, name=&#39;_committed_4947663999967497501&#39;, size=202),\n FileInfo(path=&#39;dbfs:/user/root/retail_db_pipe/orders/_committed_6122759321067326602&#39;, name=&#39;_committed_6122759321067326602&#39;, size=202),\n FileInfo(path=&#39;dbfs:/user/root/retail_db_pipe/orders/_committed_6648225221865780240&#39;, name=&#39;_committed_6648225221865780240&#39;, size=211),\n FileInfo(path=&#39;dbfs:/user/root/retail_db_pipe/orders/_committed_8357199947666107777&#39;, name=&#39;_committed_8357199947666107777&#39;, size=201),\n FileInfo(path=&#39;dbfs:/user/root/retail_db_pipe/orders/_committed_8757027839909558345&#39;, name=&#39;_committed_8757027839909558345&#39;, size=202),\n FileInfo(path=&#39;dbfs:/user/root/retail_db_pipe/orders/_committed_8951306527672590895&#39;, name=&#39;_committed_8951306527672590895&#39;, size=199),\n FileInfo(path=&#39;dbfs:/user/root/retail_db_pipe/orders/_started_2444051121522497353&#39;, name=&#39;_started_2444051121522497353&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/retail_db_pipe/orders/_started_4880425281254787174&#39;, name=&#39;_started_4880425281254787174&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/retail_db_pipe/orders/_started_6122759321067326602&#39;, name=&#39;_started_6122759321067326602&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/retail_db_pipe/orders/_started_8951306527672590895&#39;, name=&#39;_started_8951306527672590895&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/retail_db_pipe/orders/part-00000-tid-4880425281254787174-b98a7ef9-b452-4155-abdc-49f578b57cdc-82-1-c000.csv.gz&#39;, name=&#39;part-00000-tid-4880425281254787174-b98a7ef9-b452-4155-abdc-49f578b57cdc-82-1-c000.csv.gz&#39;, size=473634)]</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641587172120,"submitTime":1641587172107,"finishTime":1641587172217,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"2f7fd674-f738-4a08-b98c-16b841d1e2b3"},{"version":"CommandV1","origId":1575837098434260,"guid":"0f0ac7fa-5a31-40a5-a5d7-91006cfb8238","subtype":"command","commandType":"auto","position":11.75,"command":"spark.read.csv(f'{output_dir}/orders', sep='|', header=True, inferSchema=True).show()","commandVersion":18,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+--------+-------------------+-----------------+---------------+\n|order_id|         order_date|order_customer_id|   order_status|\n+--------+-------------------+-----------------+---------------+\n|       1|2013-07-25 00:00:00|            11599|         CLOSED|\n|       2|2013-07-25 00:00:00|              256|PENDING_PAYMENT|\n|       3|2013-07-25 00:00:00|            12111|       COMPLETE|\n|       4|2013-07-25 00:00:00|             8827|         CLOSED|\n|       5|2013-07-25 00:00:00|            11318|       COMPLETE|\n|       6|2013-07-25 00:00:00|             7130|       COMPLETE|\n|       7|2013-07-25 00:00:00|             4530|       COMPLETE|\n|       8|2013-07-25 00:00:00|             2911|     PROCESSING|\n|       9|2013-07-25 00:00:00|             5657|PENDING_PAYMENT|\n|      10|2013-07-25 00:00:00|             5648|PENDING_PAYMENT|\n|      11|2013-07-25 00:00:00|              918| PAYMENT_REVIEW|\n|      12|2013-07-25 00:00:00|             1837|         CLOSED|\n|      13|2013-07-25 00:00:00|             9149|PENDING_PAYMENT|\n|      14|2013-07-25 00:00:00|             9842|     PROCESSING|\n|      15|2013-07-25 00:00:00|             2568|       COMPLETE|\n|      16|2013-07-25 00:00:00|             7276|PENDING_PAYMENT|\n|      17|2013-07-25 00:00:00|             2667|       COMPLETE|\n|      18|2013-07-25 00:00:00|             1205|         CLOSED|\n|      19|2013-07-25 00:00:00|             9488|PENDING_PAYMENT|\n|      20|2013-07-25 00:00:00|             9198|     PROCESSING|\n+--------+-------------------+-----------------+---------------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641587221749,"submitTime":1641587221735,"finishTime":1641587223071,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"e0c8d6fa-f7c5-4ee6-847b-5e7abcfe0453"},{"version":"CommandV1","origId":1575837098434261,"guid":"9909102e-9363-48df-9b1a-f557acec87a8","subtype":"command","commandType":"auto","position":12.0,"command":"orders. \\\n    coalesce(1). \\\n    write. \\\n    mode('overwrite'). \\\n    option('compression', 'gzip'). \\\n    option('header', True). \\\n    option('sep', '|'). \\\n    csv(f'{output_dir}/orders')","commandVersion":52,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641587272967,"submitTime":1641587272942,"finishTime":1641587276315,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"9fd2bc42-2a8f-4094-a341-407b78d88e7b"},{"version":"CommandV1","origId":1575837098434262,"guid":"52ca7a86-810c-4e5d-9956-8d3c4db75f12","subtype":"command","commandType":"auto","position":16.5,"command":"dbutils.fs.ls(f'/user/{username}/retail_db_pipe/orders')","commandVersion":15,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Out[14]: [FileInfo(path=&#39;dbfs:/user/root/retail_db_pipe/orders/_committed_1132925174692068341&#39;, name=&#39;_committed_1132925174692068341&#39;, size=205),\n FileInfo(path=&#39;dbfs:/user/root/retail_db_pipe/orders/_committed_1234588906270869920&#39;, name=&#39;_committed_1234588906270869920&#39;, size=202),\n FileInfo(path=&#39;dbfs:/user/root/retail_db_pipe/orders/_committed_2444051121522497353&#39;, name=&#39;_committed_2444051121522497353&#39;, size=200),\n FileInfo(path=&#39;dbfs:/user/root/retail_db_pipe/orders/_committed_3648176934209418439&#39;, name=&#39;_committed_3648176934209418439&#39;, size=203),\n FileInfo(path=&#39;dbfs:/user/root/retail_db_pipe/orders/_committed_3739906471235457527&#39;, name=&#39;_committed_3739906471235457527&#39;, size=200),\n FileInfo(path=&#39;dbfs:/user/root/retail_db_pipe/orders/_committed_4737620600354584991&#39;, name=&#39;_committed_4737620600354584991&#39;, size=201),\n FileInfo(path=&#39;dbfs:/user/root/retail_db_pipe/orders/_committed_4880425281254787174&#39;, name=&#39;_committed_4880425281254787174&#39;, size=205),\n FileInfo(path=&#39;dbfs:/user/root/retail_db_pipe/orders/_committed_4947663999967497501&#39;, name=&#39;_committed_4947663999967497501&#39;, size=202),\n FileInfo(path=&#39;dbfs:/user/root/retail_db_pipe/orders/_committed_6122759321067326602&#39;, name=&#39;_committed_6122759321067326602&#39;, size=202),\n FileInfo(path=&#39;dbfs:/user/root/retail_db_pipe/orders/_committed_6648225221865780240&#39;, name=&#39;_committed_6648225221865780240&#39;, size=211),\n FileInfo(path=&#39;dbfs:/user/root/retail_db_pipe/orders/_committed_7905384272742116882&#39;, name=&#39;_committed_7905384272742116882&#39;, size=205),\n FileInfo(path=&#39;dbfs:/user/root/retail_db_pipe/orders/_committed_8357199947666107777&#39;, name=&#39;_committed_8357199947666107777&#39;, size=201),\n FileInfo(path=&#39;dbfs:/user/root/retail_db_pipe/orders/_committed_8757027839909558345&#39;, name=&#39;_committed_8757027839909558345&#39;, size=202),\n FileInfo(path=&#39;dbfs:/user/root/retail_db_pipe/orders/_committed_8951306527672590895&#39;, name=&#39;_committed_8951306527672590895&#39;, size=199),\n FileInfo(path=&#39;dbfs:/user/root/retail_db_pipe/orders/_started_2444051121522497353&#39;, name=&#39;_started_2444051121522497353&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/retail_db_pipe/orders/_started_4880425281254787174&#39;, name=&#39;_started_4880425281254787174&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/retail_db_pipe/orders/_started_6122759321067326602&#39;, name=&#39;_started_6122759321067326602&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/retail_db_pipe/orders/_started_7905384272742116882&#39;, name=&#39;_started_7905384272742116882&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/retail_db_pipe/orders/_started_8951306527672590895&#39;, name=&#39;_started_8951306527672590895&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/retail_db_pipe/orders/part-00000-tid-7905384272742116882-a561dea3-45be-4c89-b77d-e197fe5d8598-88-1-c000.csv.gz&#39;, name=&#39;part-00000-tid-7905384272742116882-a561dea3-45be-4c89-b77d-e197fe5d8598-88-1-c000.csv.gz&#39;, size=473634)]</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641587281077,"submitTime":1641587281057,"finishTime":1641587281152,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"d17c41e9-1b1e-46c0-8fa8-14346225c8b6"},{"version":"CommandV1","origId":1575837098434263,"guid":"803085c1-2154-4564-9a7e-cda0a91b5704","subtype":"command","commandType":"auto","position":23.0,"command":"spark.read.csv(f'/user/{username}/retail_db_pipe/orders', sep='|', header=True, inferSchema=True)","commandVersion":17,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Out[15]: DataFrame[order_id: int, order_date: timestamp, order_customer_id: int, order_status: string]</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641587296430,"submitTime":1641587296403,"finishTime":1641587297658,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"8594e109-faea-4609-81cf-9b2ff09c14d9"},{"version":"CommandV1","origId":1575837098434264,"guid":"d893fc66-9059-4bb8-bf16-887c1f6203bc","subtype":"command","commandType":"auto","position":23.5,"command":"spark.read. \\\n    csv(f'/user/{username}/retail_db_pipe/orders', sep='|', header=True, inferSchema=True). \\\n    show()","commandVersion":6,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+--------+-------------------+-----------------+---------------+\n|order_id|         order_date|order_customer_id|   order_status|\n+--------+-------------------+-----------------+---------------+\n|       1|2013-07-25 00:00:00|            11599|         CLOSED|\n|       2|2013-07-25 00:00:00|              256|PENDING_PAYMENT|\n|       3|2013-07-25 00:00:00|            12111|       COMPLETE|\n|       4|2013-07-25 00:00:00|             8827|         CLOSED|\n|       5|2013-07-25 00:00:00|            11318|       COMPLETE|\n|       6|2013-07-25 00:00:00|             7130|       COMPLETE|\n|       7|2013-07-25 00:00:00|             4530|       COMPLETE|\n|       8|2013-07-25 00:00:00|             2911|     PROCESSING|\n|       9|2013-07-25 00:00:00|             5657|PENDING_PAYMENT|\n|      10|2013-07-25 00:00:00|             5648|PENDING_PAYMENT|\n|      11|2013-07-25 00:00:00|              918| PAYMENT_REVIEW|\n|      12|2013-07-25 00:00:00|             1837|         CLOSED|\n|      13|2013-07-25 00:00:00|             9149|PENDING_PAYMENT|\n|      14|2013-07-25 00:00:00|             9842|     PROCESSING|\n|      15|2013-07-25 00:00:00|             2568|       COMPLETE|\n|      16|2013-07-25 00:00:00|             7276|PENDING_PAYMENT|\n|      17|2013-07-25 00:00:00|             2667|       COMPLETE|\n|      18|2013-07-25 00:00:00|             1205|         CLOSED|\n|      19|2013-07-25 00:00:00|             9488|PENDING_PAYMENT|\n|      20|2013-07-25 00:00:00|             9198|     PROCESSING|\n+--------+-------------------+-----------------+---------------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641587302661,"submitTime":1641587302644,"finishTime":1641587303900,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"590d77c0-322c-47bc-8b87-a4843cd82db0"},{"version":"CommandV1","origId":1575837098434265,"guid":"090870b9-6e81-4dac-a654-5a0c2d5ba31f","subtype":"command","commandType":"auto","position":24.0,"command":"orders. \\\n    coalesce(1). \\\n    write. \\\n    mode('overwrite'). \\\n    options(sep='|', header=True, compression='gzip'). \\\n    csv(f'{output_dir}/orders')","commandVersion":17,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641587378255,"submitTime":1641587378235,"finishTime":1641587381997,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"d5cab856-6596-4c9b-bebf-d4cb5d401dc0"},{"version":"CommandV1","origId":1575837098434266,"guid":"36e2eb63-59d7-465b-b5a7-8ba778b96672","subtype":"command","commandType":"auto","position":25.0,"command":"spark.read.csv(f'/user/{username}/retail_db_pipe/orders', sep='|', header=True, inferSchema=True)","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Out[18]: DataFrame[order_id: int, order_date: timestamp, order_customer_id: int, order_status: string]</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641587387532,"submitTime":1641587387501,"finishTime":1641587388855,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"4e273672-38f2-42d9-b358-ca414dd005a8"},{"version":"CommandV1","origId":1575837098434267,"guid":"f52107da-016c-45b0-ab99-2b6f14b7e782","subtype":"command","commandType":"auto","position":25.5,"command":"spark.read.csv(f'/user/{username}/retail_db_pipe/orders', sep='|', header=True, inferSchema=True).show()","commandVersion":2,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+--------+-------------------+-----------------+---------------+\n|order_id|         order_date|order_customer_id|   order_status|\n+--------+-------------------+-----------------+---------------+\n|       1|2013-07-25 00:00:00|            11599|         CLOSED|\n|       2|2013-07-25 00:00:00|              256|PENDING_PAYMENT|\n|       3|2013-07-25 00:00:00|            12111|       COMPLETE|\n|       4|2013-07-25 00:00:00|             8827|         CLOSED|\n|       5|2013-07-25 00:00:00|            11318|       COMPLETE|\n|       6|2013-07-25 00:00:00|             7130|       COMPLETE|\n|       7|2013-07-25 00:00:00|             4530|       COMPLETE|\n|       8|2013-07-25 00:00:00|             2911|     PROCESSING|\n|       9|2013-07-25 00:00:00|             5657|PENDING_PAYMENT|\n|      10|2013-07-25 00:00:00|             5648|PENDING_PAYMENT|\n|      11|2013-07-25 00:00:00|              918| PAYMENT_REVIEW|\n|      12|2013-07-25 00:00:00|             1837|         CLOSED|\n|      13|2013-07-25 00:00:00|             9149|PENDING_PAYMENT|\n|      14|2013-07-25 00:00:00|             9842|     PROCESSING|\n|      15|2013-07-25 00:00:00|             2568|       COMPLETE|\n|      16|2013-07-25 00:00:00|             7276|PENDING_PAYMENT|\n|      17|2013-07-25 00:00:00|             2667|       COMPLETE|\n|      18|2013-07-25 00:00:00|             1205|         CLOSED|\n|      19|2013-07-25 00:00:00|             9488|PENDING_PAYMENT|\n|      20|2013-07-25 00:00:00|             9198|     PROCESSING|\n+--------+-------------------+-----------------+---------------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641587397621,"submitTime":1641587397603,"finishTime":1641587398943,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"38758699-3bb2-48a6-9e29-94ee013f8aa9"},{"version":"CommandV1","origId":1575837098434268,"guid":"96cf3b9d-aa2b-4720-b02a-e6f3b6d2bbeb","subtype":"command","commandType":"auto","position":27.0,"command":"options = {\n    'sep': '|',\n    'header': True,\n    'compression': 'snappy'\n}","commandVersion":18,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641587502014,"submitTime":1641587501973,"finishTime":1641587502041,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"848e8482-cf00-4dd7-8d04-f37e1818505b"},{"version":"CommandV1","origId":1575837098434269,"guid":"15031e8a-a4b7-4b22-8e20-e9d0a60478b5","subtype":"command","commandType":"auto","position":28.0,"command":"orders. \\\n    coalesce(1). \\\n    write. \\\n    mode('overwrite'). \\\n    options(**options). \\\n    csv(f'{output_dir}/orders')","commandVersion":3,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641587503589,"submitTime":1641587503567,"finishTime":1641587506817,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"0334c552-ace4-43a2-b646-79bf8ad6a0b2"},{"version":"CommandV1","origId":1575837098434270,"guid":"f7ea4bfa-6cd3-4b6a-bcf5-35f5013eac42","subtype":"command","commandType":"auto","position":29.0,"command":"dbutils.fs.ls(f'/user/{username}/retail_db_pipe/orders')","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Out[22]: [FileInfo(path=&#39;dbfs:/user/root/retail_db_pipe/orders/_committed_1132925174692068341&#39;, name=&#39;_committed_1132925174692068341&#39;, size=205),\n FileInfo(path=&#39;dbfs:/user/root/retail_db_pipe/orders/_committed_1234588906270869920&#39;, name=&#39;_committed_1234588906270869920&#39;, size=202),\n FileInfo(path=&#39;dbfs:/user/root/retail_db_pipe/orders/_committed_2444051121522497353&#39;, name=&#39;_committed_2444051121522497353&#39;, size=200),\n FileInfo(path=&#39;dbfs:/user/root/retail_db_pipe/orders/_committed_3648176934209418439&#39;, name=&#39;_committed_3648176934209418439&#39;, size=203),\n FileInfo(path=&#39;dbfs:/user/root/retail_db_pipe/orders/_committed_3739906471235457527&#39;, name=&#39;_committed_3739906471235457527&#39;, size=200),\n FileInfo(path=&#39;dbfs:/user/root/retail_db_pipe/orders/_committed_4737620600354584991&#39;, name=&#39;_committed_4737620600354584991&#39;, size=201),\n FileInfo(path=&#39;dbfs:/user/root/retail_db_pipe/orders/_committed_4880425281254787174&#39;, name=&#39;_committed_4880425281254787174&#39;, size=205),\n FileInfo(path=&#39;dbfs:/user/root/retail_db_pipe/orders/_committed_4947663999967497501&#39;, name=&#39;_committed_4947663999967497501&#39;, size=202),\n FileInfo(path=&#39;dbfs:/user/root/retail_db_pipe/orders/_committed_5444596821891319891&#39;, name=&#39;_committed_5444596821891319891&#39;, size=210),\n FileInfo(path=&#39;dbfs:/user/root/retail_db_pipe/orders/_committed_6122759321067326602&#39;, name=&#39;_committed_6122759321067326602&#39;, size=202),\n FileInfo(path=&#39;dbfs:/user/root/retail_db_pipe/orders/_committed_6648225221865780240&#39;, name=&#39;_committed_6648225221865780240&#39;, size=211),\n FileInfo(path=&#39;dbfs:/user/root/retail_db_pipe/orders/_committed_7905384272742116882&#39;, name=&#39;_committed_7905384272742116882&#39;, size=205),\n FileInfo(path=&#39;dbfs:/user/root/retail_db_pipe/orders/_committed_8357199947666107777&#39;, name=&#39;_committed_8357199947666107777&#39;, size=201),\n FileInfo(path=&#39;dbfs:/user/root/retail_db_pipe/orders/_committed_8757027839909558345&#39;, name=&#39;_committed_8757027839909558345&#39;, size=202),\n FileInfo(path=&#39;dbfs:/user/root/retail_db_pipe/orders/_committed_8951306527672590895&#39;, name=&#39;_committed_8951306527672590895&#39;, size=199),\n FileInfo(path=&#39;dbfs:/user/root/retail_db_pipe/orders/_committed_8986700714047290299&#39;, name=&#39;_committed_8986700714047290299&#39;, size=205),\n FileInfo(path=&#39;dbfs:/user/root/retail_db_pipe/orders/_started_4880425281254787174&#39;, name=&#39;_started_4880425281254787174&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/retail_db_pipe/orders/_started_5444596821891319891&#39;, name=&#39;_started_5444596821891319891&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/retail_db_pipe/orders/_started_6122759321067326602&#39;, name=&#39;_started_6122759321067326602&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/retail_db_pipe/orders/_started_7905384272742116882&#39;, name=&#39;_started_7905384272742116882&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/retail_db_pipe/orders/_started_8951306527672590895&#39;, name=&#39;_started_8951306527672590895&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/retail_db_pipe/orders/_started_8986700714047290299&#39;, name=&#39;_started_8986700714047290299&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/retail_db_pipe/orders/part-00000-tid-5444596821891319891-4e71b7d6-2ba2-445d-a2f2-193e779114ac-100-1-c000.csv.snappy&#39;, name=&#39;part-00000-tid-5444596821891319891-4e71b7d6-2ba2-445d-a2f2-193e779114ac-100-1-c000.csv.snappy&#39;, size=882418)]</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641587520673,"submitTime":1641587520645,"finishTime":1641587520741,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"83102683-d31b-4a8a-82a3-a1d74f7a1189"},{"version":"CommandV1","origId":1575837098434271,"guid":"c47c791b-ab23-41d5-bf8c-809bfd6bc6b5","subtype":"command","commandType":"auto","position":30.0,"command":"spark.read.csv(f'/user/{username}/retail_db_pipe/orders', sep='|', header=True, inferSchema=True).show()","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+--------+-------------------+-----------------+---------------+\n|order_id|         order_date|order_customer_id|   order_status|\n+--------+-------------------+-----------------+---------------+\n|       1|2013-07-25 00:00:00|            11599|         CLOSED|\n|       2|2013-07-25 00:00:00|              256|PENDING_PAYMENT|\n|       3|2013-07-25 00:00:00|            12111|       COMPLETE|\n|       4|2013-07-25 00:00:00|             8827|         CLOSED|\n|       5|2013-07-25 00:00:00|            11318|       COMPLETE|\n|       6|2013-07-25 00:00:00|             7130|       COMPLETE|\n|       7|2013-07-25 00:00:00|             4530|       COMPLETE|\n|       8|2013-07-25 00:00:00|             2911|     PROCESSING|\n|       9|2013-07-25 00:00:00|             5657|PENDING_PAYMENT|\n|      10|2013-07-25 00:00:00|             5648|PENDING_PAYMENT|\n|      11|2013-07-25 00:00:00|              918| PAYMENT_REVIEW|\n|      12|2013-07-25 00:00:00|             1837|         CLOSED|\n|      13|2013-07-25 00:00:00|             9149|PENDING_PAYMENT|\n|      14|2013-07-25 00:00:00|             9842|     PROCESSING|\n|      15|2013-07-25 00:00:00|             2568|       COMPLETE|\n|      16|2013-07-25 00:00:00|             7276|PENDING_PAYMENT|\n|      17|2013-07-25 00:00:00|             2667|       COMPLETE|\n|      18|2013-07-25 00:00:00|             1205|         CLOSED|\n|      19|2013-07-25 00:00:00|             9488|PENDING_PAYMENT|\n|      20|2013-07-25 00:00:00|             9198|     PROCESSING|\n+--------+-------------------+-----------------+---------------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641587550798,"submitTime":1641587550773,"finishTime":1641587552425,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"071cc0ef-c742-43ec-9eca-474a106ee979"},{"version":"CommandV1","origId":1575837098434272,"guid":"7f3a5d0d-9733-4576-99b8-989fda5d4424","subtype":"command","commandType":"auto","position":31.0,"command":"","commandVersion":0,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"64d2877f-e731-4b62-ba69-8df487ad1f11"}],"dashboards":[],"guid":"e807182b-8f17-4e8f-89da-1c031731fa37","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{"pythonIndentUnit":4}}