{"version":"NotebookV1","origId":1575837098434323,"name":"14 Different Modes to write Spark Data Frame into Files","language":"python","commands":[{"version":"CommandV1","origId":1575837098434324,"guid":"d6d62ebc-32a8-4252-8060-838df8a39888","subtype":"command","commandType":"auto","position":1.0,"command":"courses = [{'course_id': 1,\n  'course_name': '2020 Complete Python Bootcamp: From Zero to Hero in Python',\n  'suitable_for': 'Beginner',\n  'enrollment': 1100093,\n  'stars': 4.6,\n  'number_of_ratings': 318066},\n {'course_id': 4,\n  'course_name': 'Angular - The Complete Guide (2020 Edition)',\n  'suitable_for': 'Intermediate',\n  'enrollment': 422557,\n  'stars': 4.6,\n  'number_of_ratings': 129984},\n {'course_id': 12,\n  'course_name': 'Automate the Boring Stuff with Python Programming',\n  'suitable_for': 'Advanced',\n  'enrollment': 692617,\n  'stars': 4.6,\n  'number_of_ratings': 70508},\n {'course_id': 10,\n  'course_name': 'Complete C# Unity Game Developer 2D',\n  'suitable_for': 'Advanced',\n  'enrollment': 364934,\n  'stars': 4.6,\n  'number_of_ratings': 78989},\n {'course_id': 5,\n  'course_name': 'Java Programming Masterclass for Software Developers',\n  'suitable_for': 'Advanced',\n  'enrollment': 502572,\n  'stars': 4.6,\n  'number_of_ratings': 123798},\n {'course_id': 15,\n  'course_name': 'Learn Python Programming Masterclass',\n  'suitable_for': 'Advanced',\n  'enrollment': 240790,\n  'stars': 4.5,\n  'number_of_ratings': 58677},\n {'course_id': 3,\n  'course_name': 'Machine Learning A-Zâ„¢: Hands-On Python & R In Data Science',\n  'suitable_for': 'Intermediate',\n  'enrollment': 692812,\n  'stars': 4.5,\n  'number_of_ratings': 132228},\n {'course_id': 14,\n  'course_name': 'Modern React with Redux [2020 Update]',\n  'suitable_for': 'Intermediate',\n  'enrollment': 203214,\n  'stars': 4.7,\n  'number_of_ratings': 60835},\n {'course_id': 8,\n  'course_name': 'Python for Data Science and Machine Learning Bootcamp',\n  'suitable_for': 'Intermediate',\n  'enrollment': 387789,\n  'stars': 4.6,\n  'number_of_ratings': 87403},\n {'course_id': 6,\n  'course_name': 'React - The Complete Guide (incl Hooks, React Router, Redux)',\n  'suitable_for': 'Intermediate',\n  'enrollment': 304670,\n  'stars': 4.6,\n  'number_of_ratings': 90964},\n {'course_id': 18,\n  'course_name': 'Selenium WebDriver with Java -Basics to Advanced+Frameworks',\n  'suitable_for': 'Advanced',\n  'enrollment': 148562,\n  'stars': 4.6,\n  'number_of_ratings': 49947},\n {'course_id': 21,\n  'course_name': 'Spring & Hibernate for Beginners (includes Spring Boot)',\n  'suitable_for': 'Advanced',\n  'enrollment': 177053,\n  'stars': 4.6,\n  'number_of_ratings': 45329},\n {'course_id': 7,\n  'course_name': 'The Complete 2020 Web Development Bootcamp',\n  'suitable_for': 'Beginner',\n  'enrollment': 270656,\n  'stars': 4.7,\n  'number_of_ratings': 88098},\n {'course_id': 9,\n  'course_name': 'The Complete JavaScript Course 2020: Build Real Projects!',\n  'suitable_for': 'Intermediate',\n  'enrollment': 347979,\n  'stars': 4.6,\n  'number_of_ratings': 83521},\n {'course_id': 16,\n  'course_name': 'The Complete Node.js Developer Course (3rd Edition)',\n  'suitable_for': 'Advanced',\n  'enrollment': 202922,\n  'stars': 4.7,\n  'number_of_ratings': 50885},\n {'course_id': 13,\n  'course_name': 'The Complete Web Developer Course 2.0',\n  'suitable_for': 'Intermediate',\n  'enrollment': 273598,\n  'stars': 4.5,\n  'number_of_ratings': 63175},\n {'course_id': 11,\n  'course_name': 'The Data Science Course 2020: Complete Data Science Bootcamp',\n  'suitable_for': 'Beginner',\n  'enrollment': 325047,\n  'stars': 4.5,\n  'number_of_ratings': 76907},\n {'course_id': 20,\n  'course_name': 'The Ultimate MySQL Bootcamp: Go from SQL Beginner to Expert',\n  'suitable_for': 'Beginner',\n  'enrollment': 203366,\n  'stars': 4.6,\n  'number_of_ratings': 45382},\n {'course_id': 2,\n  'course_name': 'The Web Developer Bootcamp',\n  'suitable_for': 'Beginner',\n  'enrollment': 596726,\n  'stars': 4.6,\n  'number_of_ratings': 182997},\n {'course_id': 19,\n  'course_name': 'Unreal Engine C++ Developer: Learn C++ and Make Video Games',\n  'suitable_for': 'Advanced',\n  'enrollment': 229005,\n  'stars': 4.5,\n  'number_of_ratings': 45860},\n {'course_id': 17,\n  'course_name': 'iOS 13 & Swift 5 - The Complete iOS App Development Bootcamp',\n  'suitable_for': 'Advanced',\n  'enrollment': 179598,\n  'stars': 4.8,\n  'number_of_ratings': 49972}]\n\nfrom pyspark.sql import Row\ncourses_df = spark.createDataFrame([Row(**course) for course in courses])","commandVersion":3,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"courses_df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"course_id","nullable":true,"type":"long"},{"metadata":{},"name":"course_name","nullable":true,"type":"string"},{"metadata":{},"name":"suitable_for","nullable":true,"type":"string"},{"metadata":{},"name":"enrollment","nullable":true,"type":"long"},{"metadata":{},"name":"stars","nullable":true,"type":"double"},{"metadata":{},"name":"number_of_ratings","nullable":true,"type":"long"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641593895656,"submitTime":1641593895605,"finishTime":1641593895997,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"0c5bd9f5-991f-4945-93ef-f1f9baee8e0d"},{"version":"CommandV1","origId":1575837098434325,"guid":"be2c5a1d-62f9-48c1-959e-86096915cc88","subtype":"command","commandType":"auto","position":3.5,"command":"# Review Supported modes\nhelp(courses_df.write.mode)","commandVersion":24,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Help on method mode in module pyspark.sql.readwriter:\n\nmode(saveMode) method of pyspark.sql.readwriter.DataFrameWriter instance\n    Specifies the behavior when data or table already exists.\n    \n    Options include:\n    \n    * `append`: Append contents of this :class:`DataFrame` to existing data.\n    * `overwrite`: Overwrite existing data.\n    * `error` or `errorifexists`: Throw an exception if data already exists.\n    * `ignore`: Silently ignore this operation if data already exists.\n    \n    .. versionadded:: 1.4.0\n    \n    Examples\n    --------\n    &gt;&gt;&gt; df.write.mode(&#39;append&#39;).parquet(os.path.join(tempfile.mkdtemp(), &#39;data&#39;))\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641593912612,"submitTime":1641593912571,"finishTime":1641593912639,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"07a1f471-edb1-4d63-abcf-51227ded6837"},{"version":"CommandV1","origId":1575837098434326,"guid":"96e9bc09-ebd6-45a0-8251-7e1f9873a9dc","subtype":"command","commandType":"auto","position":3.625,"command":"%md\n\nWe will perform tasks to understand the behavior of error/errorIfExists, overwrite, append. You can try out ignore and see what happens.","commandVersion":30,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"1f3015ec-691b-447b-97f4-8b926278e708"},{"version":"CommandV1","origId":1575837098434327,"guid":"c8ee3a0f-a554-428f-b96e-9a246bf920fa","subtype":"command","commandType":"auto","position":3.75,"command":"%md\n\nDifferent ways mode can be specified while writing data frame into files. `file_format` can be any valid out of the box format such as `text`, `csv`, `json`, `parquet`, `orc`.\n* `courses_df.write.mode(saveMode).file_format(path_to_folder)`\n* `courses_df.write.file_format(path_to_folder, mode=saveMode)`\n* `courses_df.write.mode(saveMode).format('file_format').save(path_to_folder)`\n* `courses_df.write.format('file_format').save(path_to_folder, mode=saveMode)`","commandVersion":28,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"df45d573-99d7-4187-9dea-b1450177d4dc"},{"version":"CommandV1","origId":1575837098434328,"guid":"78a8cfef-466a-4c5b-9b28-2ba9bd879746","subtype":"command","commandType":"auto","position":4.0,"command":"import getpass\nusername = getpass.getuser()","commandVersion":0,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641594051706,"submitTime":1641594051658,"finishTime":1641594051727,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"601e42ab-36f2-4bae-b359-57512cb57255"},{"version":"CommandV1","origId":1575837098434329,"guid":"f77f8354-0a05-4965-879c-7c4a57406a90","subtype":"command","commandType":"auto","position":6.0,"command":"%md\n\n* Understand default behavior.\n  * Fails if folder exists.\n  * Creates folder and then adds files to it.","commandVersion":30,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"6b469a95-ceb2-4680-a985-e10826bf7ea1"},{"version":"CommandV1","origId":1575837098434330,"guid":"d114b145-6574-4371-9c1a-63cfe29212f4","subtype":"command","commandType":"auto","position":6.5,"command":"dbutils.fs.rm(f'/user/{username}/courses', recurse=True)","commandVersion":9,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Out[4]: True</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641594061446,"submitTime":1641594061406,"finishTime":1641594061657,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"11740220-25c3-4c1e-a2ee-06a17895455b"},{"version":"CommandV1","origId":1575837098434331,"guid":"e0a8ec9d-8689-4a7c-bc9a-4a30cf726ffe","subtype":"command","commandType":"auto","position":7.0,"command":"# Will create folder and add files with data using parquet format\ncourses_df. \\\n    coalesce(1). \\\n    write. \\\n    parquet(f'/user/{username}/courses')","commandVersion":48,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641594065874,"submitTime":1641594065843,"finishTime":1641594067091,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"37037ea4-7d2e-4eb4-ba67-36d70cc9518b"},{"version":"CommandV1","origId":1575837098434332,"guid":"a2b27cbd-0e81-43fd-b164-b6acf957ead8","subtype":"command","commandType":"auto","position":8.0,"command":"dbutils.fs.ls(f'/user/{username}/courses')","commandVersion":4,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Out[6]: [FileInfo(path=&#39;dbfs:/user/root/courses/_SUCCESS&#39;, name=&#39;_SUCCESS&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/courses/_committed_34690815914110386&#39;, name=&#39;_committed_34690815914110386&#39;, size=121),\n FileInfo(path=&#39;dbfs:/user/root/courses/_started_34690815914110386&#39;, name=&#39;_started_34690815914110386&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/courses/part-00000-tid-34690815914110386-12d25da6-6f43-4d43-93c8-b31bfa3e22aa-37-1-c000.snappy.parquet&#39;, name=&#39;part-00000-tid-34690815914110386-12d25da6-6f43-4d43-93c8-b31bfa3e22aa-37-1-c000.snappy.parquet&#39;, size=3219)]</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641594074938,"submitTime":1641594074905,"finishTime":1641594075002,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"438c3acb-51e3-4ad2-a5ea-c3a3f53b57ac"},{"version":"CommandV1","origId":1575837098434333,"guid":"b03270df-2094-4358-ac07-64d261c5dd35","subtype":"command","commandType":"auto","position":9.0,"command":"# Fails as mode is error or errorIfExists by default\ncourses_df.write.parquet(f'/user/{username}/courses')","commandVersion":14,"state":"error","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":"<span class=\"ansi-red-fg\">AnalysisException</span>: path dbfs:/user/root/courses already exists.","errorTraceType":"html","error":"<div class=\"ansiout\"><span class=\"ansi-red-fg\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg\">AnalysisException</span>                         Traceback (most recent call last)\n<span class=\"ansi-green-fg\">&lt;command-2296519903438061&gt;</span> in <span class=\"ansi-cyan-fg\">&lt;module&gt;</span>\n<span class=\"ansi-green-intense-fg ansi-bold\">      1</span> <span class=\"ansi-red-fg\"># Fails as mode is error or errorIfExists by default</span>\n<span class=\"ansi-green-fg\">----&gt; 2</span><span class=\"ansi-red-fg\"> </span>courses_df<span class=\"ansi-blue-fg\">.</span>write<span class=\"ansi-blue-fg\">.</span>parquet<span class=\"ansi-blue-fg\">(</span><span class=\"ansi-blue-fg\">f&#39;/user/{username}/courses&#39;</span><span class=\"ansi-blue-fg\">)</span>\n\n<span class=\"ansi-green-fg\">/databricks/spark/python/pyspark/sql/readwriter.py</span> in <span class=\"ansi-cyan-fg\">parquet</span><span class=\"ansi-blue-fg\">(self, path, mode, partitionBy, compression)</span>\n<span class=\"ansi-green-intense-fg ansi-bold\">   1275</span>             self<span class=\"ansi-blue-fg\">.</span>partitionBy<span class=\"ansi-blue-fg\">(</span>partitionBy<span class=\"ansi-blue-fg\">)</span>\n<span class=\"ansi-green-intense-fg ansi-bold\">   1276</span>         self<span class=\"ansi-blue-fg\">.</span>_set_opts<span class=\"ansi-blue-fg\">(</span>compression<span class=\"ansi-blue-fg\">=</span>compression<span class=\"ansi-blue-fg\">)</span>\n<span class=\"ansi-green-fg\">-&gt; 1277</span><span class=\"ansi-red-fg\">         </span>self<span class=\"ansi-blue-fg\">.</span>_jwrite<span class=\"ansi-blue-fg\">.</span>parquet<span class=\"ansi-blue-fg\">(</span>path<span class=\"ansi-blue-fg\">)</span>\n<span class=\"ansi-green-intense-fg ansi-bold\">   1278</span> \n<span class=\"ansi-green-intense-fg ansi-bold\">   1279</span>     <span class=\"ansi-green-fg\">def</span> text<span class=\"ansi-blue-fg\">(</span>self<span class=\"ansi-blue-fg\">,</span> path<span class=\"ansi-blue-fg\">,</span> compression<span class=\"ansi-blue-fg\">=</span><span class=\"ansi-green-fg\">None</span><span class=\"ansi-blue-fg\">,</span> lineSep<span class=\"ansi-blue-fg\">=</span><span class=\"ansi-green-fg\">None</span><span class=\"ansi-blue-fg\">)</span><span class=\"ansi-blue-fg\">:</span>\n\n<span class=\"ansi-green-fg\">/databricks/spark/python/lib/py4j-0.10.9-src.zip/py4j/java_gateway.py</span> in <span class=\"ansi-cyan-fg\">__call__</span><span class=\"ansi-blue-fg\">(self, *args)</span>\n<span class=\"ansi-green-intense-fg ansi-bold\">   1302</span> \n<span class=\"ansi-green-intense-fg ansi-bold\">   1303</span>         answer <span class=\"ansi-blue-fg\">=</span> self<span class=\"ansi-blue-fg\">.</span>gateway_client<span class=\"ansi-blue-fg\">.</span>send_command<span class=\"ansi-blue-fg\">(</span>command<span class=\"ansi-blue-fg\">)</span>\n<span class=\"ansi-green-fg\">-&gt; 1304</span><span class=\"ansi-red-fg\">         return_value = get_return_value(\n</span><span class=\"ansi-green-intense-fg ansi-bold\">   1305</span>             answer, self.gateway_client, self.target_id, self.name)\n<span class=\"ansi-green-intense-fg ansi-bold\">   1306</span> \n\n<span class=\"ansi-green-fg\">/databricks/spark/python/pyspark/sql/utils.py</span> in <span class=\"ansi-cyan-fg\">deco</span><span class=\"ansi-blue-fg\">(*a, **kw)</span>\n<span class=\"ansi-green-intense-fg ansi-bold\">    121</span>                 <span class=\"ansi-red-fg\"># Hide where the exception came from that shows a non-Pythonic</span>\n<span class=\"ansi-green-intense-fg ansi-bold\">    122</span>                 <span class=\"ansi-red-fg\"># JVM exception message.</span>\n<span class=\"ansi-green-fg\">--&gt; 123</span><span class=\"ansi-red-fg\">                 </span><span class=\"ansi-green-fg\">raise</span> converted <span class=\"ansi-green-fg\">from</span> <span class=\"ansi-green-fg\">None</span>\n<span class=\"ansi-green-intense-fg ansi-bold\">    124</span>             <span class=\"ansi-green-fg\">else</span><span class=\"ansi-blue-fg\">:</span>\n<span class=\"ansi-green-intense-fg ansi-bold\">    125</span>                 <span class=\"ansi-green-fg\">raise</span>\n\n<span class=\"ansi-red-fg\">AnalysisException</span>: path dbfs:/user/root/courses already exists.</div>","workflows":[],"startTime":1641594089167,"submitTime":1641594089167,"finishTime":1641594089526,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"907e76a7-3cf5-40b1-9707-99fe438a729e"},{"version":"CommandV1","origId":1575837098434334,"guid":"2887741f-1106-4ac1-988d-4facb7a56525","subtype":"command","commandType":"auto","position":9.5,"command":"spark.read.parquet(f'/user/{username}/courses').count()","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Out[8]: 21</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641594125524,"submitTime":1641594125490,"finishTime":1641594126851,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"0d3c320c-c1a8-4a53-993d-085ac62abd63"},{"version":"CommandV1","origId":1575837098434335,"guid":"0facd76e-8207-468a-8b2a-c5dd54d5a608","subtype":"command","commandType":"auto","position":10.0,"command":"courses_df. \\\n    coalesce(1). \\\n    write. \\\n    mode('overwrite'). \\\n    parquet(f'/user/{username}/courses')","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641594278331,"submitTime":1641594278300,"finishTime":1641594279261,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"dc317d52-4498-4fdf-93e0-1cdcd108983d"},{"version":"CommandV1","origId":1575837098434336,"guid":"152925e7-f738-4071-b48c-f3eab1386a18","subtype":"command","commandType":"auto","position":10.5,"command":"courses_df. \\\n    coalesce(1). \\\n    write. \\\n    parquet(f'/user/{username}/courses', mode='overwrite')","commandVersion":8,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641594307233,"submitTime":1641594307198,"finishTime":1641594308228,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"87a45322-744b-42d2-8d36-5372fa67b3d9"},{"version":"CommandV1","origId":1575837098434337,"guid":"3a834570-2cb1-4d39-9d64-5cf9e7c2973a","subtype":"command","commandType":"auto","position":11.0,"command":"courses_df. \\\n    coalesce(1). \\\n    write. \\\n    format('parquet'). \\\n    save(f'/user/{username}/courses', mode='overwrite')","commandVersion":9,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641594424676,"submitTime":1641594424640,"finishTime":1641594425802,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"2277fa1c-3616-4654-87fb-1651a216fef8"},{"version":"CommandV1","origId":1575837098434338,"guid":"ac96f379-31ca-4324-9764-9966b3cdd042","subtype":"command","commandType":"auto","position":12.0,"command":"dbutils.fs.ls(f'/user/{username}/courses')","commandVersion":7,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Out[14]: [FileInfo(path=&#39;dbfs:/user/root/courses/_SUCCESS&#39;, name=&#39;_SUCCESS&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/courses/_committed_2299599152291972853&#39;, name=&#39;_committed_2299599152291972853&#39;, size=230),\n FileInfo(path=&#39;dbfs:/user/root/courses/_committed_2301153145373177799&#39;, name=&#39;_committed_2301153145373177799&#39;, size=221),\n FileInfo(path=&#39;dbfs:/user/root/courses/_committed_2953904513931111857&#39;, name=&#39;_committed_2953904513931111857&#39;, size=220),\n FileInfo(path=&#39;dbfs:/user/root/courses/_committed_34690815914110386&#39;, name=&#39;_committed_34690815914110386&#39;, size=121),\n FileInfo(path=&#39;dbfs:/user/root/courses/_committed_7024111260156064880&#39;, name=&#39;_committed_7024111260156064880&#39;, size=221),\n FileInfo(path=&#39;dbfs:/user/root/courses/_committed_714116432673196808&#39;, name=&#39;_committed_714116432673196808&#39;, size=220),\n FileInfo(path=&#39;dbfs:/user/root/courses/_started_2299599152291972853&#39;, name=&#39;_started_2299599152291972853&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/courses/_started_2301153145373177799&#39;, name=&#39;_started_2301153145373177799&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/courses/_started_2953904513931111857&#39;, name=&#39;_started_2953904513931111857&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/courses/_started_34690815914110386&#39;, name=&#39;_started_34690815914110386&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/courses/_started_7024111260156064880&#39;, name=&#39;_started_7024111260156064880&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/courses/_started_714116432673196808&#39;, name=&#39;_started_714116432673196808&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/courses/part-00000-tid-2301153145373177799-c0e01ec9-cbb8-410b-8773-0fa062036fa5-45-1-c000.snappy.parquet&#39;, name=&#39;part-00000-tid-2301153145373177799-c0e01ec9-cbb8-410b-8773-0fa062036fa5-45-1-c000.snappy.parquet&#39;, size=3219)]</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641594332833,"submitTime":1641594332802,"finishTime":1641594332923,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"fe016ac3-71f1-4e38-a394-90c058b1d143"},{"version":"CommandV1","origId":1575837098434339,"guid":"5a9e0556-255d-4b0f-86d1-45bb06fb944c","subtype":"command","commandType":"auto","position":13.0,"command":"spark.read.parquet(f'/user/{username}/courses').count()","commandVersion":7,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Out[15]: 21</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641594339387,"submitTime":1641594339357,"finishTime":1641594340039,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"c8e588a6-8b7d-46ca-b288-f11057989321"},{"version":"CommandV1","origId":1575837098434340,"guid":"4e99c313-3fa7-4a9f-9801-021c1b504c5b","subtype":"command","commandType":"auto","position":13.5,"command":"courses_df. \\\n    coalesce(1). \\\n    write. \\\n    mode('append'). \\\n    parquet(f'/user/{username}/courses')","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641594454166,"submitTime":1641594454137,"finishTime":1641594455094,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"ad5bf327-1145-42c3-ba77-4194760ad0db"},{"version":"CommandV1","origId":1575837098434341,"guid":"fd9872d6-39bf-4367-9dd9-66786adeb5d9","subtype":"command","commandType":"auto","position":15.0,"command":"dbutils.fs.ls(f'/user/{username}/courses')","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Out[19]: [FileInfo(path=&#39;dbfs:/user/root/courses/_SUCCESS&#39;, name=&#39;_SUCCESS&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/courses/_committed_1948912210390920017&#39;, name=&#39;_committed_1948912210390920017&#39;, size=320),\n FileInfo(path=&#39;dbfs:/user/root/courses/_committed_2299599152291972853&#39;, name=&#39;_committed_2299599152291972853&#39;, size=230),\n FileInfo(path=&#39;dbfs:/user/root/courses/_committed_2301153145373177799&#39;, name=&#39;_committed_2301153145373177799&#39;, size=221),\n FileInfo(path=&#39;dbfs:/user/root/courses/_committed_2953904513931111857&#39;, name=&#39;_committed_2953904513931111857&#39;, size=220),\n FileInfo(path=&#39;dbfs:/user/root/courses/_committed_34690815914110386&#39;, name=&#39;_committed_34690815914110386&#39;, size=121),\n FileInfo(path=&#39;dbfs:/user/root/courses/_committed_4005790689816700788&#39;, name=&#39;_committed_4005790689816700788&#39;, size=123),\n FileInfo(path=&#39;dbfs:/user/root/courses/_committed_4843101679152379691&#39;, name=&#39;_committed_4843101679152379691&#39;, size=123),\n FileInfo(path=&#39;dbfs:/user/root/courses/_committed_7024111260156064880&#39;, name=&#39;_committed_7024111260156064880&#39;, size=221),\n FileInfo(path=&#39;dbfs:/user/root/courses/_committed_714116432673196808&#39;, name=&#39;_committed_714116432673196808&#39;, size=220),\n FileInfo(path=&#39;dbfs:/user/root/courses/_started_1948912210390920017&#39;, name=&#39;_started_1948912210390920017&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/courses/_started_2299599152291972853&#39;, name=&#39;_started_2299599152291972853&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/courses/_started_2301153145373177799&#39;, name=&#39;_started_2301153145373177799&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/courses/_started_2953904513931111857&#39;, name=&#39;_started_2953904513931111857&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/courses/_started_34690815914110386&#39;, name=&#39;_started_34690815914110386&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/courses/_started_4005790689816700788&#39;, name=&#39;_started_4005790689816700788&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/courses/_started_4843101679152379691&#39;, name=&#39;_started_4843101679152379691&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/courses/_started_7024111260156064880&#39;, name=&#39;_started_7024111260156064880&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/courses/_started_714116432673196808&#39;, name=&#39;_started_714116432673196808&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/courses/part-00000-tid-1948912210390920017-c5e22e2f-5e7a-4a98-8ebe-1c4f43115311-50-1-c000.snappy.parquet&#39;, name=&#39;part-00000-tid-1948912210390920017-c5e22e2f-5e7a-4a98-8ebe-1c4f43115311-50-1-c000.snappy.parquet&#39;, size=3219),\n FileInfo(path=&#39;dbfs:/user/root/courses/part-00000-tid-4843101679152379691-860ca14a-fd76-46a6-a1df-7f31c9c480d1-51-1-c000.snappy.parquet&#39;, name=&#39;part-00000-tid-4843101679152379691-860ca14a-fd76-46a6-a1df-7f31c9c480d1-51-1-c000.snappy.parquet&#39;, size=3219)]</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641594458250,"submitTime":1641594458221,"finishTime":1641594458314,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"304abd1f-c9cf-41d6-a4b0-c004ab7b73a4"},{"version":"CommandV1","origId":1575837098434342,"guid":"d404b6d5-ee36-493c-b93d-f7d985b68cf1","subtype":"command","commandType":"auto","position":16.0,"command":"spark.read.parquet(f'/user/{username}/courses').count()","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Out[20]: 42</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641594470333,"submitTime":1641594470302,"finishTime":1641594471045,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"f9f9a2f1-39e1-4938-a89f-15fdf646536e"},{"version":"CommandV1","origId":1575837098434343,"guid":"1b7acdcf-1de2-4ece-bbaa-5e1ff57ec9d2","subtype":"command","commandType":"auto","position":17.0,"command":"","commandVersion":0,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"25c43da4-e81a-4b18-83a3-d3c571da20ea"}],"dashboards":[],"guid":"f639b969-969e-474b-a58a-58f5584113e3","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{"pythonIndentUnit":4}}