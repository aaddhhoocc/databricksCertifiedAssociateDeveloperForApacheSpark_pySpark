{"version":"NotebookV1","origId":1575837098434396,"name":"06 Specifying Header while writing Spark Data Frame into CSV files","language":"python","commands":[{"version":"CommandV1","origId":1575837098434397,"guid":"0492ce30-9a83-4fb0-aaa7-0e37296a2d20","subtype":"command","commandType":"auto","position":13.0,"command":"courses = [{'course_id': 1,\n  'course_name': '2020 Complete Python Bootcamp: From Zero to Hero in Python',\n  'suitable_for': 'Beginner',\n  'enrollment': 1100093,\n  'stars': 4.6,\n  'number_of_ratings': 318066},\n {'course_id': 4,\n  'course_name': 'Angular - The Complete Guide (2020 Edition)',\n  'suitable_for': 'Intermediate',\n  'enrollment': 422557,\n  'stars': 4.6,\n  'number_of_ratings': 129984},\n {'course_id': 12,\n  'course_name': 'Automate the Boring Stuff with Python Programming',\n  'suitable_for': 'Advanced',\n  'enrollment': 692617,\n  'stars': 4.6,\n  'number_of_ratings': 70508},\n {'course_id': 10,\n  'course_name': 'Complete C# Unity Game Developer 2D',\n  'suitable_for': 'Advanced',\n  'enrollment': 364934,\n  'stars': 4.6,\n  'number_of_ratings': 78989},\n {'course_id': 5,\n  'course_name': 'Java Programming Masterclass for Software Developers',\n  'suitable_for': 'Advanced',\n  'enrollment': 502572,\n  'stars': 4.6,\n  'number_of_ratings': 123798},\n {'course_id': 15,\n  'course_name': 'Learn Python Programming Masterclass',\n  'suitable_for': 'Advanced',\n  'enrollment': 240790,\n  'stars': 4.5,\n  'number_of_ratings': 58677},\n {'course_id': 3,\n  'course_name': 'Machine Learning A-Z™: Hands-On Python & R In Data Science',\n  'suitable_for': 'Intermediate',\n  'enrollment': 692812,\n  'stars': 4.5,\n  'number_of_ratings': 132228},\n {'course_id': 14,\n  'course_name': 'Modern React with Redux [2020 Update]',\n  'suitable_for': 'Intermediate',\n  'enrollment': 203214,\n  'stars': 4.7,\n  'number_of_ratings': 60835},\n {'course_id': 8,\n  'course_name': 'Python for Data Science and Machine Learning Bootcamp',\n  'suitable_for': 'Intermediate',\n  'enrollment': 387789,\n  'stars': 4.6,\n  'number_of_ratings': 87403},\n {'course_id': 6,\n  'course_name': 'React - The Complete Guide (incl Hooks, React Router, Redux)',\n  'suitable_for': 'Intermediate',\n  'enrollment': 304670,\n  'stars': 4.6,\n  'number_of_ratings': 90964},\n {'course_id': 18,\n  'course_name': 'Selenium WebDriver with Java -Basics to Advanced+Frameworks',\n  'suitable_for': 'Advanced',\n  'enrollment': 148562,\n  'stars': 4.6,\n  'number_of_ratings': 49947},\n {'course_id': 21,\n  'course_name': 'Spring & Hibernate for Beginners (includes Spring Boot)',\n  'suitable_for': 'Advanced',\n  'enrollment': 177053,\n  'stars': 4.6,\n  'number_of_ratings': 45329},\n {'course_id': 7,\n  'course_name': 'The Complete 2020 Web Development Bootcamp',\n  'suitable_for': 'Beginner',\n  'enrollment': 270656,\n  'stars': 4.7,\n  'number_of_ratings': 88098},\n {'course_id': 9,\n  'course_name': 'The Complete JavaScript Course 2020: Build Real Projects!',\n  'suitable_for': 'Intermediate',\n  'enrollment': 347979,\n  'stars': 4.6,\n  'number_of_ratings': 83521},\n {'course_id': 16,\n  'course_name': 'The Complete Node.js Developer Course (3rd Edition)',\n  'suitable_for': 'Advanced',\n  'enrollment': 202922,\n  'stars': 4.7,\n  'number_of_ratings': 50885},\n {'course_id': 13,\n  'course_name': 'The Complete Web Developer Course 2.0',\n  'suitable_for': 'Intermediate',\n  'enrollment': 273598,\n  'stars': 4.5,\n  'number_of_ratings': 63175},\n {'course_id': 11,\n  'course_name': 'The Data Science Course 2020: Complete Data Science Bootcamp',\n  'suitable_for': 'Beginner',\n  'enrollment': 325047,\n  'stars': 4.5,\n  'number_of_ratings': 76907},\n {'course_id': 20,\n  'course_name': 'The Ultimate MySQL Bootcamp: Go from SQL Beginner to Expert',\n  'suitable_for': 'Beginner',\n  'enrollment': 203366,\n  'stars': 4.6,\n  'number_of_ratings': 45382},\n {'course_id': 2,\n  'course_name': 'The Web Developer Bootcamp',\n  'suitable_for': 'Beginner',\n  'enrollment': 596726,\n  'stars': 4.6,\n  'number_of_ratings': 182997},\n {'course_id': 19,\n  'course_name': 'Unreal Engine C++ Developer: Learn C++ and Make Video Games',\n  'suitable_for': 'Advanced',\n  'enrollment': 229005,\n  'stars': 4.5,\n  'number_of_ratings': 45860},\n {'course_id': 17,\n  'course_name': 'iOS 13 & Swift 5 - The Complete iOS App Development Bootcamp',\n  'suitable_for': 'Advanced',\n  'enrollment': 179598,\n  'stars': 4.8,\n  'number_of_ratings': 49972}]\n\nfrom pyspark.sql import Row\ncourses_df = spark.createDataFrame([Row(**course) for course in courses])","commandVersion":19,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"courses_df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"course_id","nullable":true,"type":"long"},{"metadata":{},"name":"course_name","nullable":true,"type":"string"},{"metadata":{},"name":"suitable_for","nullable":true,"type":"string"},{"metadata":{},"name":"enrollment","nullable":true,"type":"long"},{"metadata":{},"name":"stars","nullable":true,"type":"double"},{"metadata":{},"name":"number_of_ratings","nullable":true,"type":"long"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641584223453,"submitTime":1641584223421,"finishTime":1641584223775,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"35a47349-2881-4d32-8344-521bbc0d4488"},{"version":"CommandV1","origId":1575837098434398,"guid":"f9def5bd-e5b4-4bc6-8e93-a825220a7b16","subtype":"command","commandType":"auto","position":13.5,"command":"import getpass\nusername = getpass.getuser()","commandVersion":12,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641584229526,"submitTime":1641584229501,"finishTime":1641584229564,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"23fd166e-2ddc-465d-be3a-2dcbe1e114ed"},{"version":"CommandV1","origId":1575837098434399,"guid":"bc3d0c8b-76bc-478b-90f0-cd021d5cdf90","subtype":"command","commandType":"auto","position":13.75,"command":"dbutils.fs.ls(f'/user/{username}/courses')","commandVersion":7,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Out[3]: [FileInfo(path=&#39;dbfs:/user/root/courses/_SUCCESS&#39;, name=&#39;_SUCCESS&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/courses/_committed_1660584188859350291&#39;, name=&#39;_committed_1660584188859350291&#39;, size=463),\n FileInfo(path=&#39;dbfs:/user/root/courses/_committed_4106485049593253071&#39;, name=&#39;_committed_4106485049593253071&#39;, size=376),\n FileInfo(path=&#39;dbfs:/user/root/courses/_committed_5785734802961574251&#39;, name=&#39;_committed_5785734802961574251&#39;, size=474),\n FileInfo(path=&#39;dbfs:/user/root/courses/_committed_6959020202298147921&#39;, name=&#39;_committed_6959020202298147921&#39;, size=463),\n FileInfo(path=&#39;dbfs:/user/root/courses/_committed_8164745958281857556&#39;, name=&#39;_committed_8164745958281857556&#39;, size=463),\n FileInfo(path=&#39;dbfs:/user/root/courses/_started_1660584188859350291&#39;, name=&#39;_started_1660584188859350291&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/courses/_started_4106485049593253071&#39;, name=&#39;_started_4106485049593253071&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/courses/_started_5785734802961574251&#39;, name=&#39;_started_5785734802961574251&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/courses/_started_6959020202298147921&#39;, name=&#39;_started_6959020202298147921&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/courses/_started_8164745958281857556&#39;, name=&#39;_started_8164745958281857556&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/courses/part-00000-tid-8164745958281857556-85d04126-d8e2-44ba-871a-49612254fa0f-34-1-c000.csv&#39;, name=&#39;part-00000-tid-8164745958281857556-85d04126-d8e2-44ba-871a-49612254fa0f-34-1-c000.csv&#39;, size=392),\n FileInfo(path=&#39;dbfs:/user/root/courses/part-00001-tid-8164745958281857556-85d04126-d8e2-44ba-871a-49612254fa0f-35-1-c000.csv&#39;, name=&#39;part-00001-tid-8164745958281857556-85d04126-d8e2-44ba-871a-49612254fa0f-35-1-c000.csv&#39;, size=412),\n FileInfo(path=&#39;dbfs:/user/root/courses/part-00002-tid-8164745958281857556-85d04126-d8e2-44ba-871a-49612254fa0f-36-1-c000.csv&#39;, name=&#39;part-00002-tid-8164745958281857556-85d04126-d8e2-44ba-871a-49612254fa0f-36-1-c000.csv&#39;, size=416),\n FileInfo(path=&#39;dbfs:/user/root/courses/part-00003-tid-8164745958281857556-85d04126-d8e2-44ba-871a-49612254fa0f-37-1-c000.csv&#39;, name=&#39;part-00003-tid-8164745958281857556-85d04126-d8e2-44ba-871a-49612254fa0f-37-1-c000.csv&#39;, size=485)]</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641584232610,"submitTime":1641584232582,"finishTime":1641584232726,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"640401b1-6f42-49eb-a7e6-e10fbf0c40df"},{"version":"CommandV1","origId":1575837098434400,"guid":"30f01fad-adfd-4214-afb0-d7a3b8a0b7d5","subtype":"command","commandType":"auto","position":13.875,"command":"courses_df.columns","commandVersion":2,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Out[9]: [&#39;course_id&#39;,\n &#39;course_name&#39;,\n &#39;suitable_for&#39;,\n &#39;enrollment&#39;,\n &#39;stars&#39;,\n &#39;number_of_ratings&#39;]</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641584411147,"submitTime":1641584411124,"finishTime":1641584411170,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"24be989d-8b35-47db-9810-670d6edcbd71"},{"version":"CommandV1","origId":1575837098434401,"guid":"2b732731-622b-48e1-b360-95c229e60e15","subtype":"command","commandType":"auto","position":14.0,"command":"courses_df. \\\n    coalesce(1). \\\n    write. \\\n    csv(f'/user/{username}/courses', mode='overwrite', header=True)","commandVersion":36,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641584306785,"submitTime":1641584306758,"finishTime":1641584308206,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"f5f83951-02d2-4809-b1a9-4cea39b9e2ad"},{"version":"CommandV1","origId":1575837098434402,"guid":"6a044b2b-5b65-43ef-9eef-8762cdfae515","subtype":"command","commandType":"auto","position":15.0,"command":"dbutils.fs.ls(f'/user/{username}/courses')","commandVersion":6,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Out[5]: [FileInfo(path=&#39;dbfs:/user/root/courses/_SUCCESS&#39;, name=&#39;_SUCCESS&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/courses/_committed_1660584188859350291&#39;, name=&#39;_committed_1660584188859350291&#39;, size=463),\n FileInfo(path=&#39;dbfs:/user/root/courses/_committed_4106485049593253071&#39;, name=&#39;_committed_4106485049593253071&#39;, size=376),\n FileInfo(path=&#39;dbfs:/user/root/courses/_committed_5785734802961574251&#39;, name=&#39;_committed_5785734802961574251&#39;, size=474),\n FileInfo(path=&#39;dbfs:/user/root/courses/_committed_6959020202298147921&#39;, name=&#39;_committed_6959020202298147921&#39;, size=463),\n FileInfo(path=&#39;dbfs:/user/root/courses/_committed_8164745958281857556&#39;, name=&#39;_committed_8164745958281857556&#39;, size=463),\n FileInfo(path=&#39;dbfs:/user/root/courses/_committed_9027289701596974180&#39;, name=&#39;_committed_9027289701596974180&#39;, size=463),\n FileInfo(path=&#39;dbfs:/user/root/courses/_started_1660584188859350291&#39;, name=&#39;_started_1660584188859350291&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/courses/_started_4106485049593253071&#39;, name=&#39;_started_4106485049593253071&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/courses/_started_5785734802961574251&#39;, name=&#39;_started_5785734802961574251&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/courses/_started_6959020202298147921&#39;, name=&#39;_started_6959020202298147921&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/courses/_started_8164745958281857556&#39;, name=&#39;_started_8164745958281857556&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/courses/_started_9027289701596974180&#39;, name=&#39;_started_9027289701596974180&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/courses/part-00000-tid-9027289701596974180-088b984b-1c9b-448f-8a3c-9a2a71ffa467-38-1-c000.csv&#39;, name=&#39;part-00000-tid-9027289701596974180-088b984b-1c9b-448f-8a3c-9a2a71ffa467-38-1-c000.csv&#39;, size=1775)]</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641584313925,"submitTime":1641584313900,"finishTime":1641584314011,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"08016ad6-d71b-408c-9cb5-39a9b6b5911f"},{"version":"CommandV1","origId":1575837098434403,"guid":"36688176-ab33-496f-8f59-54bdf26b2c70","subtype":"command","commandType":"auto","position":15.5,"command":"spark.read.text(f'/user/{username}/courses').show(truncate=False)","commandVersion":9,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+----------------------------------------------------------------------------------------------+\n|value                                                                                         |\n+----------------------------------------------------------------------------------------------+\n|course_id,course_name,suitable_for,enrollment,stars,number_of_ratings                         |\n|1,2020 Complete Python Bootcamp: From Zero to Hero in Python,Beginner,1100093,4.6,318066      |\n|4,Angular - The Complete Guide (2020 Edition),Intermediate,422557,4.6,129984                  |\n|12,Automate the Boring Stuff with Python Programming,Advanced,692617,4.6,70508                |\n|10,Complete C# Unity Game Developer 2D,Advanced,364934,4.6,78989                              |\n|5,Java Programming Masterclass for Software Developers,Advanced,502572,4.6,123798             |\n|15,Learn Python Programming Masterclass,Advanced,240790,4.5,58677                             |\n|3,Machine Learning A-Z™: Hands-On Python &amp; R In Data Science,Intermediate,692812,4.5,132228   |\n|14,Modern React with Redux [2020 Update],Intermediate,203214,4.7,60835                        |\n|8,Python for Data Science and Machine Learning Bootcamp,Intermediate,387789,4.6,87403         |\n|6,&#34;React - The Complete Guide (incl Hooks, React Router, Redux)&#34;,Intermediate,304670,4.6,90964|\n|18,Selenium WebDriver with Java -Basics to Advanced+Frameworks,Advanced,148562,4.6,49947      |\n|21,Spring &amp; Hibernate for Beginners (includes Spring Boot),Advanced,177053,4.6,45329          |\n|7,The Complete 2020 Web Development Bootcamp,Beginner,270656,4.7,88098                        |\n|9,The Complete JavaScript Course 2020: Build Real Projects!,Intermediate,347979,4.6,83521     |\n|16,The Complete Node.js Developer Course (3rd Edition),Advanced,202922,4.7,50885              |\n|13,The Complete Web Developer Course 2.0,Intermediate,273598,4.5,63175                        |\n|11,The Data Science Course 2020: Complete Data Science Bootcamp,Beginner,325047,4.5,76907     |\n|20,The Ultimate MySQL Bootcamp: Go from SQL Beginner to Expert,Beginner,203366,4.6,45382      |\n|2,The Web Developer Bootcamp,Beginner,596726,4.6,182997                                       |\n+----------------------------------------------------------------------------------------------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641584345825,"submitTime":1641584345799,"finishTime":1641584346293,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"37d056d3-1553-4174-a5fd-01e56afe7712"},{"version":"CommandV1","origId":1575837098434404,"guid":"6151c5dc-41a1-4a64-b0f0-4e60d22ca8f0","subtype":"command","commandType":"auto","position":15.75,"command":"spark.read.csv(f'/user/{username}/courses', header=True).show()","commandVersion":8,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+---------+--------------------+------------+----------+-----+-----------------+\n|course_id|         course_name|suitable_for|enrollment|stars|number_of_ratings|\n+---------+--------------------+------------+----------+-----+-----------------+\n|        1|2020 Complete Pyt...|    Beginner|   1100093|  4.6|           318066|\n|        4|Angular - The Com...|Intermediate|    422557|  4.6|           129984|\n|       12|Automate the Bori...|    Advanced|    692617|  4.6|            70508|\n|       10|Complete C# Unity...|    Advanced|    364934|  4.6|            78989|\n|        5|Java Programming ...|    Advanced|    502572|  4.6|           123798|\n|       15|Learn Python Prog...|    Advanced|    240790|  4.5|            58677|\n|        3|Machine Learning ...|Intermediate|    692812|  4.5|           132228|\n|       14|Modern React with...|Intermediate|    203214|  4.7|            60835|\n|        8|Python for Data S...|Intermediate|    387789|  4.6|            87403|\n|        6|React - The Compl...|Intermediate|    304670|  4.6|            90964|\n|       18|Selenium WebDrive...|    Advanced|    148562|  4.6|            49947|\n|       21|Spring &amp; Hibernat...|    Advanced|    177053|  4.6|            45329|\n|        7|The Complete 2020...|    Beginner|    270656|  4.7|            88098|\n|        9|The Complete Java...|Intermediate|    347979|  4.6|            83521|\n|       16|The Complete Node...|    Advanced|    202922|  4.7|            50885|\n|       13|The Complete Web ...|Intermediate|    273598|  4.5|            63175|\n|       11|The Data Science ...|    Beginner|    325047|  4.5|            76907|\n|       20|The Ultimate MySQ...|    Beginner|    203366|  4.6|            45382|\n|        2|The Web Developer...|    Beginner|    596726|  4.6|           182997|\n|       19|Unreal Engine C++...|    Advanced|    229005|  4.5|            45860|\n+---------+--------------------+------------+----------+-----+-----------------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641584381249,"submitTime":1641584381224,"finishTime":1641584382472,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"51add3c5-1704-4a33-83eb-1a9256cd1700"},{"version":"CommandV1","origId":1575837098434405,"guid":"6c5db73a-a250-4818-ab8f-123381062203","subtype":"command","commandType":"auto","position":16.0,"command":"courses_df. \\\n    coalesce(1). \\\n    write. \\\n    format('csv'). \\\n    save(f'/user/{username}/courses', mode='overwrite', header=True)","commandVersion":15,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641584462243,"submitTime":1641584462215,"finishTime":1641584463365,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"c243c8d9-4fb4-43f2-9f72-2e4d710811df"},{"version":"CommandV1","origId":1575837098434406,"guid":"6301c541-a6b5-4b15-ad4b-83eefb441980","subtype":"command","commandType":"auto","position":17.0,"command":"dbutils.fs.ls(f'/user/{username}/courses')","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Out[11]: [FileInfo(path=&#39;dbfs:/user/root/courses/_SUCCESS&#39;, name=&#39;_SUCCESS&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/courses/_committed_1660584188859350291&#39;, name=&#39;_committed_1660584188859350291&#39;, size=463),\n FileInfo(path=&#39;dbfs:/user/root/courses/_committed_4106485049593253071&#39;, name=&#39;_committed_4106485049593253071&#39;, size=376),\n FileInfo(path=&#39;dbfs:/user/root/courses/_committed_4626273642349967024&#39;, name=&#39;_committed_4626273642349967024&#39;, size=199),\n FileInfo(path=&#39;dbfs:/user/root/courses/_committed_5785734802961574251&#39;, name=&#39;_committed_5785734802961574251&#39;, size=474),\n FileInfo(path=&#39;dbfs:/user/root/courses/_committed_6959020202298147921&#39;, name=&#39;_committed_6959020202298147921&#39;, size=463),\n FileInfo(path=&#39;dbfs:/user/root/courses/_committed_8164745958281857556&#39;, name=&#39;_committed_8164745958281857556&#39;, size=463),\n FileInfo(path=&#39;dbfs:/user/root/courses/_committed_9027289701596974180&#39;, name=&#39;_committed_9027289701596974180&#39;, size=463),\n FileInfo(path=&#39;dbfs:/user/root/courses/_started_1660584188859350291&#39;, name=&#39;_started_1660584188859350291&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/courses/_started_4106485049593253071&#39;, name=&#39;_started_4106485049593253071&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/courses/_started_4626273642349967024&#39;, name=&#39;_started_4626273642349967024&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/courses/_started_5785734802961574251&#39;, name=&#39;_started_5785734802961574251&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/courses/_started_6959020202298147921&#39;, name=&#39;_started_6959020202298147921&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/courses/_started_8164745958281857556&#39;, name=&#39;_started_8164745958281857556&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/courses/_started_9027289701596974180&#39;, name=&#39;_started_9027289701596974180&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/courses/part-00000-tid-4626273642349967024-66095e6c-81ab-47bf-80cc-7044406d7308-43-1-c000.csv&#39;, name=&#39;part-00000-tid-4626273642349967024-66095e6c-81ab-47bf-80cc-7044406d7308-43-1-c000.csv&#39;, size=1775)]</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641584473504,"submitTime":1641584473480,"finishTime":1641584473595,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"ef3fed52-07f8-414d-8699-9caafaf8ba18"},{"version":"CommandV1","origId":1575837098434407,"guid":"401caffd-6472-4578-bc90-ef72cc7d36fd","subtype":"command","commandType":"auto","position":18.0,"command":"spark.read.csv(f'/user/{username}/courses', header=True).show()","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+---------+--------------------+------------+----------+-----+-----------------+\n|course_id|         course_name|suitable_for|enrollment|stars|number_of_ratings|\n+---------+--------------------+------------+----------+-----+-----------------+\n|        1|2020 Complete Pyt...|    Beginner|   1100093|  4.6|           318066|\n|        4|Angular - The Com...|Intermediate|    422557|  4.6|           129984|\n|       12|Automate the Bori...|    Advanced|    692617|  4.6|            70508|\n|       10|Complete C# Unity...|    Advanced|    364934|  4.6|            78989|\n|        5|Java Programming ...|    Advanced|    502572|  4.6|           123798|\n|       15|Learn Python Prog...|    Advanced|    240790|  4.5|            58677|\n|        3|Machine Learning ...|Intermediate|    692812|  4.5|           132228|\n|       14|Modern React with...|Intermediate|    203214|  4.7|            60835|\n|        8|Python for Data S...|Intermediate|    387789|  4.6|            87403|\n|        6|React - The Compl...|Intermediate|    304670|  4.6|            90964|\n|       18|Selenium WebDrive...|    Advanced|    148562|  4.6|            49947|\n|       21|Spring &amp; Hibernat...|    Advanced|    177053|  4.6|            45329|\n|        7|The Complete 2020...|    Beginner|    270656|  4.7|            88098|\n|        9|The Complete Java...|Intermediate|    347979|  4.6|            83521|\n|       16|The Complete Node...|    Advanced|    202922|  4.7|            50885|\n|       13|The Complete Web ...|Intermediate|    273598|  4.5|            63175|\n|       11|The Data Science ...|    Beginner|    325047|  4.5|            76907|\n|       20|The Ultimate MySQ...|    Beginner|    203366|  4.6|            45382|\n|        2|The Web Developer...|    Beginner|    596726|  4.6|           182997|\n|       19|Unreal Engine C++...|    Advanced|    229005|  4.5|            45860|\n+---------+--------------------+------------+----------+-----+-----------------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641584515300,"submitTime":1641584515275,"finishTime":1641584516226,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"07a21354-22de-4f1f-a5d1-c95eae6e9e50"},{"version":"CommandV1","origId":1575837098434408,"guid":"239d682b-fa5b-4a9d-b7f5-3415168109f1","subtype":"command","commandType":"auto","position":19.0,"command":"","commandVersion":0,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"02ec4218-3f01-49ed-abbd-0269b17970bf"}],"dashboards":[],"guid":"b37fa0ad-6bff-4973-bd50-8544dbc6125c","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{"pythonIndentUnit":4}}