{"version":"NotebookV1","origId":1575837098434346,"name":"08 Specifying Delimiter while writing Spark Data Frame into CSV Files","language":"python","commands":[{"version":"CommandV1","origId":1575837098434347,"guid":"dfeee40f-528c-4c44-b3f5-7b5b4d0947d2","subtype":"command","commandType":"auto","position":4.0,"command":"dbutils.fs.ls('/public/retail_db')","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Out[1]: [FileInfo(path=&#39;dbfs:/public/retail_db/categories/&#39;, name=&#39;categories/&#39;, size=0),\n FileInfo(path=&#39;dbfs:/public/retail_db/customers/&#39;, name=&#39;customers/&#39;, size=0),\n FileInfo(path=&#39;dbfs:/public/retail_db/departments/&#39;, name=&#39;departments/&#39;, size=0),\n FileInfo(path=&#39;dbfs:/public/retail_db/order_items/&#39;, name=&#39;order_items/&#39;, size=0),\n FileInfo(path=&#39;dbfs:/public/retail_db/orders/&#39;, name=&#39;orders/&#39;, size=0),\n FileInfo(path=&#39;dbfs:/public/retail_db/products/&#39;, name=&#39;products/&#39;, size=0)]</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641585369557,"submitTime":1641585367815,"finishTime":1641585369660,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"89c5e4af-cea0-4061-a6fd-f33022dd68f8"},{"version":"CommandV1","origId":1575837098434348,"guid":"961e70fb-9d85-4893-bf5c-ee05a5ebb47c","subtype":"command","commandType":"auto","position":8.0,"command":"df = spark.read.csv('/public/retail_db/orders')","commandVersion":12,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"_c0","nullable":true,"type":"string"},{"metadata":{},"name":"_c1","nullable":true,"type":"string"},{"metadata":{},"name":"_c2","nullable":true,"type":"string"},{"metadata":{},"name":"_c3","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641585375812,"submitTime":1641585375792,"finishTime":1641585376560,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"167960fe-cd75-48df-9373-3c06d4a1e4f0"},{"version":"CommandV1","origId":1575837098434349,"guid":"6a24d9c0-e262-416f-897a-6076a168cb41","subtype":"command","commandType":"auto","position":9.0,"command":"df.show()","commandVersion":2,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+---+--------------------+-----+---------------+\n|_c0|                 _c1|  _c2|            _c3|\n+---+--------------------+-----+---------------+\n|  1|2013-07-25 00:00:...|11599|         CLOSED|\n|  2|2013-07-25 00:00:...|  256|PENDING_PAYMENT|\n|  3|2013-07-25 00:00:...|12111|       COMPLETE|\n|  4|2013-07-25 00:00:...| 8827|         CLOSED|\n|  5|2013-07-25 00:00:...|11318|       COMPLETE|\n|  6|2013-07-25 00:00:...| 7130|       COMPLETE|\n|  7|2013-07-25 00:00:...| 4530|       COMPLETE|\n|  8|2013-07-25 00:00:...| 2911|     PROCESSING|\n|  9|2013-07-25 00:00:...| 5657|PENDING_PAYMENT|\n| 10|2013-07-25 00:00:...| 5648|PENDING_PAYMENT|\n| 11|2013-07-25 00:00:...|  918| PAYMENT_REVIEW|\n| 12|2013-07-25 00:00:...| 1837|         CLOSED|\n| 13|2013-07-25 00:00:...| 9149|PENDING_PAYMENT|\n| 14|2013-07-25 00:00:...| 9842|     PROCESSING|\n| 15|2013-07-25 00:00:...| 2568|       COMPLETE|\n| 16|2013-07-25 00:00:...| 7276|PENDING_PAYMENT|\n| 17|2013-07-25 00:00:...| 2667|       COMPLETE|\n| 18|2013-07-25 00:00:...| 1205|         CLOSED|\n| 19|2013-07-25 00:00:...| 9488|PENDING_PAYMENT|\n| 20|2013-07-25 00:00:...| 9198|     PROCESSING|\n+---+--------------------+-----+---------------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641585383658,"submitTime":1641585383640,"finishTime":1641585383946,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"4aacd51b-2682-426e-928d-7c2c90ccf646"},{"version":"CommandV1","origId":1575837098434350,"guid":"a61f3456-35d4-4ace-8fa3-71a0cfe851f4","subtype":"command","commandType":"auto","position":10.0,"command":"# Copy all the data with comma separator to pipe separator\n\nimport getpass\nusername = getpass.getuser()\n\ninput_dir = '/public/retail_db'\noutput_dir = f'/user/{username}/retail_db_pipe'","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641585583813,"submitTime":1641585583779,"finishTime":1641585583829,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"21b6b8be-cdfc-4193-92e8-cc6e7f6500b6"},{"version":"CommandV1","origId":1575837098434351,"guid":"0d856040-62f8-459e-bb32-3a41239ef2f9","subtype":"command","commandType":"auto","position":11.0,"command":"help(df.write.csv)","commandVersion":4,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Help on method csv in module pyspark.sql.readwriter:\n\ncsv(path, mode=None, compression=None, sep=None, quote=None, escape=None, header=None, nullValue=None, escapeQuotes=None, quoteAll=None, dateFormat=None, timestampFormat=None, ignoreLeadingWhiteSpace=None, ignoreTrailingWhiteSpace=None, charToEscapeQuoteEscaping=None, encoding=None, emptyValue=None, lineSep=None) method of pyspark.sql.readwriter.DataFrameWriter instance\n    Saves the content of the :class:`DataFrame` in CSV format at the specified path.\n    \n    .. versionadded:: 2.0.0\n    \n    Parameters\n    ----------\n    path : str\n        the path in any Hadoop supported file system\n    mode : str, optional\n        specifies the behavior of the save operation when data already exists.\n    \n        * ``append``: Append contents of this :class:`DataFrame` to existing data.\n        * ``overwrite``: Overwrite existing data.\n        * ``ignore``: Silently ignore this operation if data already exists.\n        * ``error`` or ``errorifexists`` (default case): Throw an exception if data already \\\n            exists.\n    \n    compression : str, optional\n        compression codec to use when saving to file. This can be one of the\n        known case-insensitive shorten names (none, bzip2, gzip, lz4,\n        snappy and deflate).\n    sep : str, optional\n        sets a separator (one or more characters) for each field and value. If None is\n        set, it uses the default value, ``,``.\n    quote : str, optional\n        sets a single character used for escaping quoted values where the\n        separator can be part of the value. If None is set, it uses the default\n        value, ``&#34;``. If an empty string is set, it uses ``u0000`` (null character).\n    escape : str, optional\n        sets a single character used for escaping quotes inside an already\n        quoted value. If None is set, it uses the default value, ``\\``\n    escapeQuotes : str or bool, optional\n        a flag indicating whether values containing quotes should always\n        be enclosed in quotes. If None is set, it uses the default value\n        ``true``, escaping all values containing a quote character.\n    quoteAll : str or bool, optional\n        a flag indicating whether all values should always be enclosed in\n        quotes. If None is set, it uses the default value ``false``,\n        only escaping values containing a quote character.\n    header : str or bool, optional\n        writes the names of columns as the first line. If None is set, it uses\n        the default value, ``false``.\n    nullValue : str, optional\n        sets the string representation of a null value. If None is set, it uses\n        the default value, empty string.\n    dateFormat : str, optional\n        sets the string that indicates a date format. Custom date formats follow\n        the formats at\n        `datetime pattern &lt;https://spark.apache.org/docs/latest/sql-ref-datetime-pattern.html&gt;`_.  # noqa\n        This applies to date type. If None is set, it uses the\n        default value, ``yyyy-MM-dd``.\n    timestampFormat : str, optional\n        sets the string that indicates a timestamp format.\n        Custom date formats follow the formats at\n        `datetime pattern &lt;https://spark.apache.org/docs/latest/sql-ref-datetime-pattern.html&gt;`_.  # noqa\n        This applies to timestamp type. If None is set, it uses the\n        default value, ``yyyy-MM-dd&#39;T&#39;HH:mm:ss[.SSS][XXX]``.\n    ignoreLeadingWhiteSpace : str or bool, optional\n        a flag indicating whether or not leading whitespaces from\n        values being written should be skipped. If None is set, it\n        uses the default value, ``true``.\n    ignoreTrailingWhiteSpace : str or bool, optional\n        a flag indicating whether or not trailing whitespaces from\n        values being written should be skipped. If None is set, it\n        uses the default value, ``true``.\n    charToEscapeQuoteEscaping : str, optional\n        sets a single character used for escaping the escape for\n        the quote character. If None is set, the default value is\n        escape character when escape and quote characters are\n        different, ``\\0`` otherwise..\n    encoding : str, optional\n        sets the encoding (charset) of saved csv files. If None is set,\n        the default UTF-8 charset will be used.\n    emptyValue : str, optional\n        sets the string representation of an empty value. If None is set, it uses\n        the default value, ``&#34;&#34;``.\n    lineSep : str, optional\n        defines the line separator that should be used for writing. If None is\n        set, it uses the default value, ``\\\\n``. Maximum length is 1 character.\n    \n    Examples\n    --------\n    &gt;&gt;&gt; df.write.csv(os.path.join(tempfile.mkdtemp(), &#39;data&#39;))\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641585649823,"submitTime":1641585649804,"finishTime":1641585649851,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"b4862ce7-54d4-43e9-b89c-070df26e38e8"},{"version":"CommandV1","origId":1575837098434352,"guid":"a25b2304-1e30-4305-8e28-eed6da834e0e","subtype":"command","commandType":"auto","position":12.0,"command":"df.coalesce(1).write.mode('overwrite').csv(f'{output_dir}/orders', sep='|')","commandVersion":3,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641585667110,"submitTime":1641585667092,"finishTime":1641585668834,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"9fd2bc42-2a8f-4094-a341-407b78d88e7b"},{"version":"CommandV1","origId":1575837098434353,"guid":"b90a3cd9-c4eb-4f9e-91a8-9c2af48cb7d0","subtype":"command","commandType":"auto","position":16.5,"command":"dbutils.fs.ls(f'/user/{username}/retail_db_pipe/orders')","commandVersion":15,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Out[8]: [FileInfo(path=&#39;dbfs:/user/root/retail_db_pipe/orders/_committed_1132925174692068341&#39;, name=&#39;_committed_1132925174692068341&#39;, size=205),\n FileInfo(path=&#39;dbfs:/user/root/retail_db_pipe/orders/_committed_1234588906270869920&#39;, name=&#39;_committed_1234588906270869920&#39;, size=202),\n FileInfo(path=&#39;dbfs:/user/root/retail_db_pipe/orders/_committed_2444051121522497353&#39;, name=&#39;_committed_2444051121522497353&#39;, size=200),\n FileInfo(path=&#39;dbfs:/user/root/retail_db_pipe/orders/_committed_3648176934209418439&#39;, name=&#39;_committed_3648176934209418439&#39;, size=203),\n FileInfo(path=&#39;dbfs:/user/root/retail_db_pipe/orders/_committed_3739906471235457527&#39;, name=&#39;_committed_3739906471235457527&#39;, size=200),\n FileInfo(path=&#39;dbfs:/user/root/retail_db_pipe/orders/_committed_4737620600354584991&#39;, name=&#39;_committed_4737620600354584991&#39;, size=201),\n FileInfo(path=&#39;dbfs:/user/root/retail_db_pipe/orders/_committed_4947663999967497501&#39;, name=&#39;_committed_4947663999967497501&#39;, size=202),\n FileInfo(path=&#39;dbfs:/user/root/retail_db_pipe/orders/_committed_6648225221865780240&#39;, name=&#39;_committed_6648225221865780240&#39;, size=211),\n FileInfo(path=&#39;dbfs:/user/root/retail_db_pipe/orders/_committed_8357199947666107777&#39;, name=&#39;_committed_8357199947666107777&#39;, size=201),\n FileInfo(path=&#39;dbfs:/user/root/retail_db_pipe/orders/_committed_8757027839909558345&#39;, name=&#39;_committed_8757027839909558345&#39;, size=202),\n FileInfo(path=&#39;dbfs:/user/root/retail_db_pipe/orders/_started_2444051121522497353&#39;, name=&#39;_started_2444051121522497353&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/retail_db_pipe/orders/part-00000-tid-2444051121522497353-5245ecaa-4088-4409-a54e-04bc66c7ad78-55-1-c000.csv&#39;, name=&#39;part-00000-tid-2444051121522497353-5245ecaa-4088-4409-a54e-04bc66c7ad78-55-1-c000.csv&#39;, size=2999944)]</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641585677879,"submitTime":1641585677862,"finishTime":1641585677949,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"d17c41e9-1b1e-46c0-8fa8-14346225c8b6"},{"version":"CommandV1","origId":1575837098434354,"guid":"e0973df3-4cf7-41aa-b32b-8c6ddb0d9570","subtype":"command","commandType":"auto","position":16.75,"command":"spark.read.csv(f'/user/{username}/retail_db_pipe/orders', sep='|').show()","commandVersion":9,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+---+--------------------+-----+---------------+\n|_c0|                 _c1|  _c2|            _c3|\n+---+--------------------+-----+---------------+\n|  1|2013-07-25 00:00:...|11599|         CLOSED|\n|  2|2013-07-25 00:00:...|  256|PENDING_PAYMENT|\n|  3|2013-07-25 00:00:...|12111|       COMPLETE|\n|  4|2013-07-25 00:00:...| 8827|         CLOSED|\n|  5|2013-07-25 00:00:...|11318|       COMPLETE|\n|  6|2013-07-25 00:00:...| 7130|       COMPLETE|\n|  7|2013-07-25 00:00:...| 4530|       COMPLETE|\n|  8|2013-07-25 00:00:...| 2911|     PROCESSING|\n|  9|2013-07-25 00:00:...| 5657|PENDING_PAYMENT|\n| 10|2013-07-25 00:00:...| 5648|PENDING_PAYMENT|\n| 11|2013-07-25 00:00:...|  918| PAYMENT_REVIEW|\n| 12|2013-07-25 00:00:...| 1837|         CLOSED|\n| 13|2013-07-25 00:00:...| 9149|PENDING_PAYMENT|\n| 14|2013-07-25 00:00:...| 9842|     PROCESSING|\n| 15|2013-07-25 00:00:...| 2568|       COMPLETE|\n| 16|2013-07-25 00:00:...| 7276|PENDING_PAYMENT|\n| 17|2013-07-25 00:00:...| 2667|       COMPLETE|\n| 18|2013-07-25 00:00:...| 1205|         CLOSED|\n| 19|2013-07-25 00:00:...| 9488|PENDING_PAYMENT|\n| 20|2013-07-25 00:00:...| 9198|     PROCESSING|\n+---+--------------------+-----+---------------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641585720133,"submitTime":1641585720110,"finishTime":1641585721144,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"1a52e484-fd7f-48b9-ad00-971fe3c5047d"},{"version":"CommandV1","origId":1575837098434355,"guid":"ebb653ec-ce26-4787-a9d0-2800ddcdac62","subtype":"command","commandType":"auto","position":16.875,"command":"dbutils.fs.ls(input_dir)","commandVersion":3,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Out[11]: [FileInfo(path=&#39;dbfs:/public/retail_db/categories/&#39;, name=&#39;categories/&#39;, size=0),\n FileInfo(path=&#39;dbfs:/public/retail_db/customers/&#39;, name=&#39;customers/&#39;, size=0),\n FileInfo(path=&#39;dbfs:/public/retail_db/departments/&#39;, name=&#39;departments/&#39;, size=0),\n FileInfo(path=&#39;dbfs:/public/retail_db/order_items/&#39;, name=&#39;order_items/&#39;, size=0),\n FileInfo(path=&#39;dbfs:/public/retail_db/orders/&#39;, name=&#39;orders/&#39;, size=0),\n FileInfo(path=&#39;dbfs:/public/retail_db/products/&#39;, name=&#39;products/&#39;, size=0)]</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641585822764,"submitTime":1641585822732,"finishTime":1641585822841,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"3443cb1a-c96b-431d-b95d-57f156d7cf27"},{"version":"CommandV1","origId":1575837098434356,"guid":"c65841cf-9dd4-4db1-9e58-7204fcad40d5","subtype":"command","commandType":"auto","position":17.0,"command":"# Generate CSV files with pipe delimiter\nfor file_details in dbutils.fs.ls(input_dir):\n    print(f'Converting data in {file_details.path} folder from comma separated to pipe separated')\n    df = spark.read.csv(file_details.path)\n    folder_name = file_details.path.split('/')[-2]\n    df.coalesce(1).write.mode('overwrite').csv(f'{output_dir}/{folder_name}', sep='|')","commandVersion":15,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Converting data in dbfs:/public/retail_db/categories/ folder from comma separated to pipe separated\nConverting data in dbfs:/public/retail_db/customers/ folder from comma separated to pipe separated\nConverting data in dbfs:/public/retail_db/departments/ folder from comma separated to pipe separated\nConverting data in dbfs:/public/retail_db/order_items/ folder from comma separated to pipe separated\nConverting data in dbfs:/public/retail_db/orders/ folder from comma separated to pipe separated\nConverting data in dbfs:/public/retail_db/products/ folder from comma separated to pipe separated\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"_c0","nullable":true,"type":"string"},{"metadata":{},"name":"_c1","nullable":true,"type":"string"},{"metadata":{},"name":"_c2","nullable":true,"type":"string"},{"metadata":{},"name":"_c3","nullable":true,"type":"string"},{"metadata":{},"name":"_c4","nullable":true,"type":"string"},{"metadata":{},"name":"_c5","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641586285416,"submitTime":1641586285388,"finishTime":1641586295633,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"4fdf6e41-a2f2-4904-95fb-f32fb295ed18"},{"version":"CommandV1","origId":1575837098434357,"guid":"3a400f2d-d971-48f4-8e98-4dad0306d3dc","subtype":"command","commandType":"auto","position":18.0,"command":"schema = \"\"\"\n    order_id INT,\n    order_date TIMESTAMP,\n    order_customer_id INT,\n    order_status STRING\n\"\"\"","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641586404911,"submitTime":1641586404884,"finishTime":1641586404934,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"5c21cf47-476f-453f-b2c6-2c071f8a4740"},{"version":"CommandV1","origId":1575837098434358,"guid":"ebb0b7fb-caad-47c8-9d1c-b4fa3919b2e0","subtype":"command","commandType":"auto","position":19.0,"command":"orders = spark.read.schema(schema).csv(f'/user/{username}/retail_db_pipe/orders')","commandVersion":20,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"orders","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"order_id","nullable":true,"type":"integer"},{"metadata":{},"name":"order_date","nullable":true,"type":"timestamp"},{"metadata":{},"name":"order_customer_id","nullable":true,"type":"integer"},{"metadata":{},"name":"order_status","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641586418292,"submitTime":1641586418281,"finishTime":1641586418722,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"d4285bd2-7597-47eb-8d9c-3a5d0884632a"},{"version":"CommandV1","origId":1575837098434359,"guid":"d216a1f4-8152-48aa-94e2-8fdeb3f9a3fb","subtype":"command","commandType":"auto","position":20.0,"command":"orders.show()","commandVersion":2,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+--------+----------+-----------------+------------+\n|order_id|order_date|order_customer_id|order_status|\n+--------+----------+-----------------+------------+\n|    null|      null|             null|        null|\n|    null|      null|             null|        null|\n|    null|      null|             null|        null|\n|    null|      null|             null|        null|\n|    null|      null|             null|        null|\n|    null|      null|             null|        null|\n|    null|      null|             null|        null|\n|    null|      null|             null|        null|\n|    null|      null|             null|        null|\n|    null|      null|             null|        null|\n|    null|      null|             null|        null|\n|    null|      null|             null|        null|\n|    null|      null|             null|        null|\n|    null|      null|             null|        null|\n|    null|      null|             null|        null|\n|    null|      null|             null|        null|\n|    null|      null|             null|        null|\n|    null|      null|             null|        null|\n|    null|      null|             null|        null|\n|    null|      null|             null|        null|\n+--------+----------+-----------------+------------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641586428586,"submitTime":1641586428572,"finishTime":1641586429132,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"812b698d-ac7d-4ede-a264-0460d8e7fb40"},{"version":"CommandV1","origId":1575837098434360,"guid":"d5a3d524-1852-4be9-bec3-9f0b8e2f4635","subtype":"command","commandType":"auto","position":21.0,"command":"orders = spark.read.schema(schema).csv(f'/user/{username}/retail_db_pipe/orders', sep='|')","commandVersion":4,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"orders","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"order_id","nullable":true,"type":"integer"},{"metadata":{},"name":"order_date","nullable":true,"type":"timestamp"},{"metadata":{},"name":"order_customer_id","nullable":true,"type":"integer"},{"metadata":{},"name":"order_status","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641586445661,"submitTime":1641586445646,"finishTime":1641586446021,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"794cbf93-da6b-4b14-9f9f-07beada78375"},{"version":"CommandV1","origId":1575837098434361,"guid":"b66e7951-37df-41f6-845f-73ccbbdfab66","subtype":"command","commandType":"auto","position":22.0,"command":"orders.show()","commandVersion":2,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">+--------+-------------------+-----------------+---------------+\n|order_id|         order_date|order_customer_id|   order_status|\n+--------+-------------------+-----------------+---------------+\n|       1|2013-07-25 00:00:00|            11599|         CLOSED|\n|       2|2013-07-25 00:00:00|              256|PENDING_PAYMENT|\n|       3|2013-07-25 00:00:00|            12111|       COMPLETE|\n|       4|2013-07-25 00:00:00|             8827|         CLOSED|\n|       5|2013-07-25 00:00:00|            11318|       COMPLETE|\n|       6|2013-07-25 00:00:00|             7130|       COMPLETE|\n|       7|2013-07-25 00:00:00|             4530|       COMPLETE|\n|       8|2013-07-25 00:00:00|             2911|     PROCESSING|\n|       9|2013-07-25 00:00:00|             5657|PENDING_PAYMENT|\n|      10|2013-07-25 00:00:00|             5648|PENDING_PAYMENT|\n|      11|2013-07-25 00:00:00|              918| PAYMENT_REVIEW|\n|      12|2013-07-25 00:00:00|             1837|         CLOSED|\n|      13|2013-07-25 00:00:00|             9149|PENDING_PAYMENT|\n|      14|2013-07-25 00:00:00|             9842|     PROCESSING|\n|      15|2013-07-25 00:00:00|             2568|       COMPLETE|\n|      16|2013-07-25 00:00:00|             7276|PENDING_PAYMENT|\n|      17|2013-07-25 00:00:00|             2667|       COMPLETE|\n|      18|2013-07-25 00:00:00|             1205|         CLOSED|\n|      19|2013-07-25 00:00:00|             9488|PENDING_PAYMENT|\n|      20|2013-07-25 00:00:00|             9198|     PROCESSING|\n+--------+-------------------+-----------------+---------------+\nonly showing top 20 rows\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641586449975,"submitTime":1641586449958,"finishTime":1641586451504,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"96553a72-77cf-48dd-9ff1-3746865e3326"},{"version":"CommandV1","origId":1575837098434362,"guid":"94c67373-3249-46ef-aca8-f4e6a26af931","subtype":"command","commandType":"auto","position":23.0,"command":"","commandVersion":0,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"8594e109-faea-4609-81cf-9b2ff09c14d9"}],"dashboards":[],"guid":"5baba723-d1e9-4884-b915-b9d7cf571414","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{"pythonIndentUnit":4}}