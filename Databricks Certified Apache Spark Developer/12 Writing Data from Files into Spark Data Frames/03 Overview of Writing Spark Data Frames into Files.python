{"version":"NotebookV1","origId":1575837098434375,"name":"03 Overview of Writing Spark Data Frames into Files","language":"python","commands":[{"version":"CommandV1","origId":1575837098434376,"guid":"b8e1c55d-7ee7-422a-91a9-529eacb7036d","subtype":"command","commandType":"auto","position":1.0,"command":"%md\n\n* Writing files using direct APIs such as `csv`, `json`, etc under `df.write` where df is of type Spark's DataFrameWriter.\n* Writing files using `format` and `save` under `df.write`.\n* Specifying options as arguments as well as using functions such as `option` and `options`.\n* Supported file formats.\n  * `csv`\n  * `text`\n  * `json`\n  * `parquet`\n  * `orc`\n* Other common file formats.\n  * `xml`\n  * `avro`\n* Important file formats for certification - `csv`, `json`, `parquet`\n* Writing into compressed files","commandVersion":158,"state":"finished","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"ad9e05d2-73e8-44dd-9efb-24815c5d03ae"},{"version":"CommandV1","origId":1575837098434377,"guid":"95bdb4fb-b2b9-4574-b276-a6d9d143108a","subtype":"command","commandType":"auto","position":2.0,"command":"courses = [{'course_id': 1,\n  'course_name': '2020 Complete Python Bootcamp: From Zero to Hero in Python',\n  'suitable_for': 'Beginner',\n  'enrollment': 1100093,\n  'stars': 4.6,\n  'number_of_ratings': 318066},\n {'course_id': 4,\n  'course_name': 'Angular - The Complete Guide (2020 Edition)',\n  'suitable_for': 'Intermediate',\n  'enrollment': 422557,\n  'stars': 4.6,\n  'number_of_ratings': 129984},\n {'course_id': 12,\n  'course_name': 'Automate the Boring Stuff with Python Programming',\n  'suitable_for': 'Advanced',\n  'enrollment': 692617,\n  'stars': 4.6,\n  'number_of_ratings': 70508},\n {'course_id': 10,\n  'course_name': 'Complete C# Unity Game Developer 2D',\n  'suitable_for': 'Advanced',\n  'enrollment': 364934,\n  'stars': 4.6,\n  'number_of_ratings': 78989},\n {'course_id': 5,\n  'course_name': 'Java Programming Masterclass for Software Developers',\n  'suitable_for': 'Advanced',\n  'enrollment': 502572,\n  'stars': 4.6,\n  'number_of_ratings': 123798},\n {'course_id': 15,\n  'course_name': 'Learn Python Programming Masterclass',\n  'suitable_for': 'Advanced',\n  'enrollment': 240790,\n  'stars': 4.5,\n  'number_of_ratings': 58677},\n {'course_id': 3,\n  'course_name': 'Machine Learning A-Zâ„¢: Hands-On Python & R In Data Science',\n  'suitable_for': 'Intermediate',\n  'enrollment': 692812,\n  'stars': 4.5,\n  'number_of_ratings': 132228},\n {'course_id': 14,\n  'course_name': 'Modern React with Redux [2020 Update]',\n  'suitable_for': 'Intermediate',\n  'enrollment': 203214,\n  'stars': 4.7,\n  'number_of_ratings': 60835},\n {'course_id': 8,\n  'course_name': 'Python for Data Science and Machine Learning Bootcamp',\n  'suitable_for': 'Intermediate',\n  'enrollment': 387789,\n  'stars': 4.6,\n  'number_of_ratings': 87403},\n {'course_id': 6,\n  'course_name': 'React - The Complete Guide (incl Hooks, React Router, Redux)',\n  'suitable_for': 'Intermediate',\n  'enrollment': 304670,\n  'stars': 4.6,\n  'number_of_ratings': 90964},\n {'course_id': 18,\n  'course_name': 'Selenium WebDriver with Java -Basics to Advanced+Frameworks',\n  'suitable_for': 'Advanced',\n  'enrollment': 148562,\n  'stars': 4.6,\n  'number_of_ratings': 49947},\n {'course_id': 21,\n  'course_name': 'Spring & Hibernate for Beginners (includes Spring Boot)',\n  'suitable_for': 'Advanced',\n  'enrollment': 177053,\n  'stars': 4.6,\n  'number_of_ratings': 45329},\n {'course_id': 7,\n  'course_name': 'The Complete 2020 Web Development Bootcamp',\n  'suitable_for': 'Beginner',\n  'enrollment': 270656,\n  'stars': 4.7,\n  'number_of_ratings': 88098},\n {'course_id': 9,\n  'course_name': 'The Complete JavaScript Course 2020: Build Real Projects!',\n  'suitable_for': 'Intermediate',\n  'enrollment': 347979,\n  'stars': 4.6,\n  'number_of_ratings': 83521},\n {'course_id': 16,\n  'course_name': 'The Complete Node.js Developer Course (3rd Edition)',\n  'suitable_for': 'Advanced',\n  'enrollment': 202922,\n  'stars': 4.7,\n  'number_of_ratings': 50885},\n {'course_id': 13,\n  'course_name': 'The Complete Web Developer Course 2.0',\n  'suitable_for': 'Intermediate',\n  'enrollment': 273598,\n  'stars': 4.5,\n  'number_of_ratings': 63175},\n {'course_id': 11,\n  'course_name': 'The Data Science Course 2020: Complete Data Science Bootcamp',\n  'suitable_for': 'Beginner',\n  'enrollment': 325047,\n  'stars': 4.5,\n  'number_of_ratings': 76907},\n {'course_id': 20,\n  'course_name': 'The Ultimate MySQL Bootcamp: Go from SQL Beginner to Expert',\n  'suitable_for': 'Beginner',\n  'enrollment': 203366,\n  'stars': 4.6,\n  'number_of_ratings': 45382},\n {'course_id': 2,\n  'course_name': 'The Web Developer Bootcamp',\n  'suitable_for': 'Beginner',\n  'enrollment': 596726,\n  'stars': 4.6,\n  'number_of_ratings': 182997},\n {'course_id': 19,\n  'course_name': 'Unreal Engine C++ Developer: Learn C++ and Make Video Games',\n  'suitable_for': 'Advanced',\n  'enrollment': 229005,\n  'stars': 4.5,\n  'number_of_ratings': 45860},\n {'course_id': 17,\n  'course_name': 'iOS 13 & Swift 5 - The Complete iOS App Development Bootcamp',\n  'suitable_for': 'Advanced',\n  'enrollment': 179598,\n  'stars': 4.8,\n  'number_of_ratings': 49972}]\n\nfrom pyspark.sql import Row\ncourses_df = spark.createDataFrame([Row(**course) for course in courses])","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"courses_df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"course_id","nullable":true,"type":"long"},{"metadata":{},"name":"course_name","nullable":true,"type":"string"},{"metadata":{},"name":"suitable_for","nullable":true,"type":"string"},{"metadata":{},"name":"enrollment","nullable":true,"type":"long"},{"metadata":{},"name":"stars","nullable":true,"type":"double"},{"metadata":{},"name":"number_of_ratings","nullable":true,"type":"long"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641577311706,"submitTime":1641577303852,"finishTime":1641577312495,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"ecdef212-fd70-42b7-8347-713c8c975b47"},{"version":"CommandV1","origId":1575837098434378,"guid":"06db5300-c43b-471d-9fff-04abcbf4894d","subtype":"command","commandType":"auto","position":3.0,"command":"type(courses_df.write)","commandVersion":5,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Out[2]: pyspark.sql.readwriter.DataFrameWriter</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641577381132,"submitTime":1641577381103,"finishTime":1641577381184,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"77d265ec-dde0-41e6-9b35-781a543fb34d"},{"version":"CommandV1","origId":1575837098434379,"guid":"e10edb02-4472-46de-ae6c-f1472def9e39","subtype":"command","commandType":"auto","position":3.5,"command":"import getpass\nusername = getpass.getuser()","commandVersion":9,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641577648299,"submitTime":1641577648270,"finishTime":1641577648350,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"0b1c8efe-d43e-42ca-9a36-8d71bda01c92"},{"version":"CommandV1","origId":1575837098434380,"guid":"a8e20b05-956a-4e85-87d7-50e3dc472aeb","subtype":"command","commandType":"auto","position":4.0,"command":"courses_df.write.json(f'/user/{username}/courses', mode='overwrite')","commandVersion":26,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641577683586,"submitTime":1641577683551,"finishTime":1641577688698,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"8ff37ae6-5aae-4284-8c51-afb8b7a555dc"},{"version":"CommandV1","origId":1575837098434381,"guid":"aaf04ae5-7770-49c7-b72c-1e9084633b96","subtype":"command","commandType":"auto","position":5.0,"command":"dbutils.fs.ls(f'/user/{username}/courses')","commandVersion":6,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Out[5]: [FileInfo(path=&#39;dbfs:/user/root/courses/_committed_3231689197093098824&#39;, name=&#39;_committed_3231689197093098824&#39;, size=210),\n FileInfo(path=&#39;dbfs:/user/root/courses/_committed_3706304464080553800&#39;, name=&#39;_committed_3706304464080553800&#39;, size=207),\n FileInfo(path=&#39;dbfs:/user/root/courses/_committed_4201832436227326930&#39;, name=&#39;_committed_4201832436227326930&#39;, size=123),\n FileInfo(path=&#39;dbfs:/user/root/courses/_committed_6696121129805923823&#39;, name=&#39;_committed_6696121129805923823&#39;, size=470),\n FileInfo(path=&#39;dbfs:/user/root/courses/_committed_6829752986066005050&#39;, name=&#39;_committed_6829752986066005050&#39;, size=225),\n FileInfo(path=&#39;dbfs:/user/root/courses/_committed_vacuum8385731869291171933&#39;, name=&#39;_committed_vacuum8385731869291171933&#39;, size=96),\n FileInfo(path=&#39;dbfs:/user/root/courses/_started_6696121129805923823&#39;, name=&#39;_started_6696121129805923823&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/courses/part-00000-tid-6696121129805923823-a7b2f55d-3292-4647-b095-23bf4ac2b87f-0-1-c000.json&#39;, name=&#39;part-00000-tid-6696121129805923823-a7b2f55d-3292-4647-b095-23bf4ac2b87f-0-1-c000.json&#39;, size=832),\n FileInfo(path=&#39;dbfs:/user/root/courses/part-00001-tid-6696121129805923823-a7b2f55d-3292-4647-b095-23bf4ac2b87f-1-1-c000.json&#39;, name=&#39;part-00001-tid-6696121129805923823-a7b2f55d-3292-4647-b095-23bf4ac2b87f-1-1-c000.json&#39;, size=850),\n FileInfo(path=&#39;dbfs:/user/root/courses/part-00002-tid-6696121129805923823-a7b2f55d-3292-4647-b095-23bf4ac2b87f-2-1-c000.json&#39;, name=&#39;part-00002-tid-6696121129805923823-a7b2f55d-3292-4647-b095-23bf4ac2b87f-2-1-c000.json&#39;, size=856),\n FileInfo(path=&#39;dbfs:/user/root/courses/part-00003-tid-6696121129805923823-a7b2f55d-3292-4647-b095-23bf4ac2b87f-3-1-c000.json&#39;, name=&#39;part-00003-tid-6696121129805923823-a7b2f55d-3292-4647-b095-23bf4ac2b87f-3-1-c000.json&#39;, size=1013)]</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641577707266,"submitTime":1641577707233,"finishTime":1641577707436,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"20d9e076-d744-4e1c-b8c7-0a9836ef7cec"},{"version":"CommandV1","origId":1575837098434382,"guid":"6a3fc7d9-c0ca-435e-8425-1e40c059c6e3","subtype":"command","commandType":"auto","position":6.0,"command":"courses_df.write.format('json').save(f'/user/{username}/courses', mode='overwrite')","commandVersion":5,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641577740443,"submitTime":1641577740418,"finishTime":1641577741969,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"964136c4-e41b-4b66-86d5-f78ba13142a2"},{"version":"CommandV1","origId":1575837098434383,"guid":"2518a6c6-b999-4fc3-9bd9-dabefecea29a","subtype":"command","commandType":"auto","position":7.0,"command":"","commandVersion":0,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"af52329d-e5db-4cf5-ab20-65e3d6ef8458"}],"dashboards":[],"guid":"64854c76-043d-46ce-9665-48fcbb948304","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{"pythonIndentUnit":4}}