{"version":"NotebookV1","origId":1575837098434220,"name":"11 Caching Spark Data Frames","language":"python","commands":[{"version":"CommandV1","origId":1575837098434221,"guid":"d949121b-4e1c-40b7-932e-f47a976dd84a","subtype":"command","commandType":"auto","position":1.0,"command":"%md\n\n* `persist`\n* `cache` => **persist** with **MEMORY_AND_DISK**.","commandVersion":20,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"cca3c3e5-9d6d-415e-99d0-af4bacfb953a"},{"version":"CommandV1","origId":1575837098434222,"guid":"a39ad3de-b454-4f5b-965f-210a0c28df05","subtype":"command","commandType":"auto","position":2.0,"command":"df = spark.read.json('/public/retail_db_json/orders')","commandVersion":11,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"df","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"order_customer_id","nullable":true,"type":"long"},{"metadata":{},"name":"order_date","nullable":true,"type":"string"},{"metadata":{},"name":"order_id","nullable":true,"type":"long"},{"metadata":{},"name":"order_status","nullable":true,"type":"string"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641918144441,"submitTime":1641918144380,"finishTime":1641918152254,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"358be46f-5d44-47b3-a7f8-955079fafbce"},{"version":"CommandV1","origId":1575837098434223,"guid":"35ac7967-af9c-4401-bb23-234c2ea55577","subtype":"command","commandType":"auto","position":3.0,"command":"help(df.persist)","commandVersion":3,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Help on method persist in module pyspark.sql.dataframe:\n\npersist(storageLevel=StorageLevel(True, True, False, True, 1)) method of pyspark.sql.dataframe.DataFrame instance\n    Sets the storage level to persist the contents of the :class:`DataFrame` across\n    operations after the first time it is computed. This can only be used to assign\n    a new storage level if the :class:`DataFrame` does not have a storage level set yet.\n    If no storage level is specified defaults to (`MEMORY_AND_DISK_DESER`)\n    \n    .. versionadded:: 1.3.0\n    \n    Notes\n    -----\n    The default storage level has changed to `MEMORY_AND_DISK_DESER` to match Scala in 3.0.\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641918154818,"submitTime":1641918154792,"finishTime":1641918154844,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"56d4deee-5578-4803-8808-038598dac763"},{"version":"CommandV1","origId":1575837098434224,"guid":"7453ad12-e25d-4341-ab91-c9936dc1029d","subtype":"command","commandType":"auto","position":4.0,"command":"help(df.cache)","commandVersion":2,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Help on method cache in module pyspark.sql.dataframe:\n\ncache() method of pyspark.sql.dataframe.DataFrame instance\n    Persists the :class:`DataFrame` with the default storage level (`MEMORY_AND_DISK`).\n    \n    .. versionadded:: 1.3.0\n    \n    Notes\n    -----\n    The default storage level has changed to `MEMORY_AND_DISK` to match Scala in 2.0.\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641918245909,"submitTime":1641918245881,"finishTime":1641918245930,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"6d37b969-23d7-48ff-9f59-abfefcd934a1"},{"version":"CommandV1","origId":1575837098434225,"guid":"8421a847-68dc-4015-b1f1-b6b62117baca","subtype":"command","commandType":"auto","position":5.0,"command":"from pyspark import StorageLevel","commandVersion":10,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641918247769,"submitTime":1641918247737,"finishTime":1641918247799,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"69fa2fb2-a082-45a0-8e0b-47ee8017f556"},{"version":"CommandV1","origId":1575837098434226,"guid":"d90e5a33-6ae5-4ea6-93f5-e7e6c97a9bf3","subtype":"command","commandType":"auto","position":6.0,"command":"help(StorageLevel)","commandVersion":3,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Help on class StorageLevel in module pyspark.storagelevel:\n\nclass StorageLevel(builtins.object)\n |  StorageLevel(useDisk, useMemory, useOffHeap, deserialized, replication=1)\n |  \n |  Flags for controlling the storage of an RDD. Each StorageLevel records whether to use memory,\n |  whether to drop the RDD to disk if it falls out of memory, whether to keep the data in memory\n |  in a JAVA-specific serialized format, and whether to replicate the RDD partitions on multiple\n |  nodes. Also contains static constants for some commonly used storage levels, MEMORY_ONLY.\n |  Since the data is always serialized on the Python side, all the constants use the serialized\n |  formats.\n |  \n |  Methods defined here:\n |  \n |  __init__(self, useDisk, useMemory, useOffHeap, deserialized, replication=1)\n |      Initialize self.  See help(type(self)) for accurate signature.\n |  \n |  __repr__(self)\n |      Return repr(self).\n |  \n |  __str__(self)\n |      Return str(self).\n |  \n |  ----------------------------------------------------------------------\n |  Data descriptors defined here:\n |  \n |  __dict__\n |      dictionary for instance variables (if defined)\n |  \n |  __weakref__\n |      list of weak references to the object (if defined)\n |  \n |  ----------------------------------------------------------------------\n |  Data and other attributes defined here:\n |  \n |  DISK_ONLY = StorageLevel(True, False, False, False, 1)\n |  \n |  DISK_ONLY_2 = StorageLevel(True, False, False, False, 2)\n |  \n |  DISK_ONLY_3 = StorageLevel(True, False, False, False, 3)\n |  \n |  MEMORY_AND_DISK = StorageLevel(True, True, False, False, 1)\n |  \n |  MEMORY_AND_DISK_2 = StorageLevel(True, True, False, False, 2)\n |  \n |  MEMORY_AND_DISK_DESER = StorageLevel(True, True, False, True, 1)\n |  \n |  MEMORY_ONLY = StorageLevel(False, True, False, False, 1)\n |  \n |  MEMORY_ONLY_2 = StorageLevel(False, True, False, False, 2)\n |  \n |  OFF_HEAP = StorageLevel(True, True, True, False, 1)\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641918248294,"submitTime":1641918248267,"finishTime":1641918248335,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"b038d591-7ef4-4dae-9618-5fe7f8ee3cf2"},{"version":"CommandV1","origId":1575837098434227,"guid":"23cc0516-860d-4cd0-baf4-af3484e9ce53","subtype":"command","commandType":"auto","position":7.0,"command":"","commandVersion":0,"state":"error","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"398d9ff6-8956-4275-9cc7-b0d97e6e4f20"}],"dashboards":[],"guid":"b4bac220-c44c-4f0d-8b83-ec8cdaaf024d","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{"pythonIndentUnit":4}}