{"version":"NotebookV1","origId":1575837098434241,"name":"06 Run Spark Application to understand the Execution Life Cycle","language":"python","commands":[{"version":"CommandV1","origId":1575837098434242,"guid":"558c3887-c8dd-4bc6-8fb2-4a610b85a333","subtype":"command","commandType":"auto","position":3.0,"command":"%fs ls dbfs:/databricks-datasets/asa/airlines","commandVersion":67,"state":"finished","results":{"type":"table","data":[["dbfs:/databricks-datasets/asa/airlines/1987.csv","1987.csv",127162942],["dbfs:/databricks-datasets/asa/airlines/1988.csv","1988.csv",501039472],["dbfs:/databricks-datasets/asa/airlines/1989.csv","1989.csv",486518821],["dbfs:/databricks-datasets/asa/airlines/1990.csv","1990.csv",509194687],["dbfs:/databricks-datasets/asa/airlines/1991.csv","1991.csv",491210093],["dbfs:/databricks-datasets/asa/airlines/1992.csv","1992.csv",492313731],["dbfs:/databricks-datasets/asa/airlines/1993.csv","1993.csv",490753652],["dbfs:/databricks-datasets/asa/airlines/1994.csv","1994.csv",501558665],["dbfs:/databricks-datasets/asa/airlines/1995.csv","1995.csv",530751568],["dbfs:/databricks-datasets/asa/airlines/1996.csv","1996.csv",533922363],["dbfs:/databricks-datasets/asa/airlines/1997.csv","1997.csv",540347861],["dbfs:/databricks-datasets/asa/airlines/1998.csv","1998.csv",538432875],["dbfs:/databricks-datasets/asa/airlines/1999.csv","1999.csv",552926022],["dbfs:/databricks-datasets/asa/airlines/2000.csv","2000.csv",570151613],["dbfs:/databricks-datasets/asa/airlines/2001.csv","2001.csv",600411462],["dbfs:/databricks-datasets/asa/airlines/2002.csv","2002.csv",530507013],["dbfs:/databricks-datasets/asa/airlines/2003.csv","2003.csv",626745242],["dbfs:/databricks-datasets/asa/airlines/2004.csv","2004.csv",669879113],["dbfs:/databricks-datasets/asa/airlines/2005.csv","2005.csv",671027265],["dbfs:/databricks-datasets/asa/airlines/2006.csv","2006.csv",672068096],["dbfs:/databricks-datasets/asa/airlines/2007.csv","2007.csv",702878193],["dbfs:/databricks-datasets/asa/airlines/2008.csv","2008.csv",689413344]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"path","type":"\"string\"","metadata":"{}"},{"name":"name","type":"\"string\"","metadata":"{}"},{"name":"size","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641771019904,"submitTime":1641771019861,"finishTime":1641771022915,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"1420","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"476dfbf4-0351-4fc2-8775-8ff509410e9e"},{"version":"CommandV1","origId":1575837098434243,"guid":"111c9ba2-c1cd-4ea7-aa1e-07d1894151ba","subtype":"command","commandType":"auto","position":5.0,"command":"spark.read.csv('dbfs:/databricks-datasets/asa/airlines', header=True).printSchema()","commandVersion":8,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">root\n |-- Year: string (nullable = true)\n |-- Month: string (nullable = true)\n |-- DayofMonth: string (nullable = true)\n |-- DayOfWeek: string (nullable = true)\n |-- DepTime: string (nullable = true)\n |-- CRSDepTime: string (nullable = true)\n |-- ArrTime: string (nullable = true)\n |-- CRSArrTime: string (nullable = true)\n |-- UniqueCarrier: string (nullable = true)\n |-- FlightNum: string (nullable = true)\n |-- TailNum: string (nullable = true)\n |-- ActualElapsedTime: string (nullable = true)\n |-- CRSElapsedTime: string (nullable = true)\n |-- AirTime: string (nullable = true)\n |-- ArrDelay: string (nullable = true)\n |-- DepDelay: string (nullable = true)\n |-- Origin: string (nullable = true)\n |-- Dest: string (nullable = true)\n |-- Distance: string (nullable = true)\n |-- TaxiIn: string (nullable = true)\n |-- TaxiOut: string (nullable = true)\n |-- Cancelled: string (nullable = true)\n |-- CancellationCode: string (nullable = true)\n |-- Diverted: string (nullable = true)\n |-- CarrierDelay: string (nullable = true)\n |-- WeatherDelay: string (nullable = true)\n |-- NASDelay: string (nullable = true)\n |-- SecurityDelay: string (nullable = true)\n |-- LateAircraftDelay: string (nullable = true)\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641771037419,"submitTime":1641771037389,"finishTime":1641771042152,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"11213d04-b97d-4100-a7e3-6e633dec4fed"},{"version":"CommandV1","origId":1575837098434244,"guid":"c5c6d69a-4972-450b-9dbb-e1c8cf53b4b8","subtype":"command","commandType":"auto","position":5.5,"command":"import getpass\nusername = getpass.getuser()","commandVersion":9,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641771056623,"submitTime":1641771056594,"finishTime":1641771056637,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"2e092aef-f7f9-4bb1-b4e6-35cee9e019dc"},{"version":"CommandV1","origId":1575837098434245,"guid":"d028b5bb-2ce6-412b-80c9-7ba330e10aa8","subtype":"command","commandType":"auto","position":5.75,"command":"dbutils.fs.rm(f'/user/{username}/airlines', recurse=True)","commandVersion":10,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Out[3]: True</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641771061833,"submitTime":1641771061800,"finishTime":1641771061978,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"3f43331f-18e5-431c-83bd-2381a99d69d8"},{"version":"CommandV1","origId":1575837098434246,"guid":"6f7afbb2-2ee2-4d80-84ab-bb3db1071929","subtype":"command","commandType":"auto","position":8.0,"command":"spark. \\\n    read. \\\n    csv('dbfs:/databricks-datasets/asa/airlines', header=True). \\\n    groupBy('Year', 'Month', 'DayOfMonth'). \\\n    count(). \\\n    write. \\\n    parquet(f'/user/{username}/airlines', mode='overwrite')","commandVersion":2,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641771074624,"submitTime":1641771074592,"finishTime":1641771123260,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"aeaeb288-7035-4a97-a309-ef3faefe00ec"},{"version":"CommandV1","origId":1575837098434247,"guid":"1be31538-29f5-49a6-9beb-37fbae4bf676","subtype":"command","commandType":"auto","position":9.0,"command":"","commandVersion":0,"state":"finished","results":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"1bed13db-daff-4055-8a5d-e1616b8b2d95"}],"dashboards":[],"guid":"4a28c8a4-c2eb-4382-a7b5-9d8fc17799c7","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{"pythonIndentUnit":4}}