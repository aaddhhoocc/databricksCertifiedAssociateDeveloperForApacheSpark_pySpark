{"version":"NotebookV1","origId":1575837098434204,"name":"10 Run Spark Application with Adaptive Execution","language":"python","commands":[{"version":"CommandV1","origId":1575837098434205,"guid":"036c54b2-b694-4bba-93b7-3235e50c76da","subtype":"command","commandType":"auto","position":1.0,"command":"spark.conf.get('spark.sql.adaptive.enabled')","commandVersion":9,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Out[1]: &#39;true&#39;</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641770322906,"submitTime":1641770322812,"finishTime":1641770322928,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"2efb7e3d-ccc6-438f-aca5-3b5818d5fb89"},{"version":"CommandV1","origId":1575837098434206,"guid":"93b91ec7-aff3-438c-a23d-4accc2889ef8","subtype":"command","commandType":"auto","position":2.0,"command":"spark.conf.get('spark.sql.shuffle.partitions')","commandVersion":8,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Out[2]: &#39;200&#39;</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641770322931,"submitTime":1641770322818,"finishTime":1641770322946,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"86b9f3f0-d575-4f9e-9d39-8e78a91f40ca"},{"version":"CommandV1","origId":1575837098434207,"guid":"77f296e0-0d4f-427a-97b4-31ba947ea81b","subtype":"command","commandType":"auto","position":3.0,"command":"%fs ls dbfs:/databricks-datasets/asa/airlines","commandVersion":67,"state":"finished","results":{"type":"table","data":[["dbfs:/databricks-datasets/asa/airlines/1987.csv","1987.csv",127162942],["dbfs:/databricks-datasets/asa/airlines/1988.csv","1988.csv",501039472],["dbfs:/databricks-datasets/asa/airlines/1989.csv","1989.csv",486518821],["dbfs:/databricks-datasets/asa/airlines/1990.csv","1990.csv",509194687],["dbfs:/databricks-datasets/asa/airlines/1991.csv","1991.csv",491210093],["dbfs:/databricks-datasets/asa/airlines/1992.csv","1992.csv",492313731],["dbfs:/databricks-datasets/asa/airlines/1993.csv","1993.csv",490753652],["dbfs:/databricks-datasets/asa/airlines/1994.csv","1994.csv",501558665],["dbfs:/databricks-datasets/asa/airlines/1995.csv","1995.csv",530751568],["dbfs:/databricks-datasets/asa/airlines/1996.csv","1996.csv",533922363],["dbfs:/databricks-datasets/asa/airlines/1997.csv","1997.csv",540347861],["dbfs:/databricks-datasets/asa/airlines/1998.csv","1998.csv",538432875],["dbfs:/databricks-datasets/asa/airlines/1999.csv","1999.csv",552926022],["dbfs:/databricks-datasets/asa/airlines/2000.csv","2000.csv",570151613],["dbfs:/databricks-datasets/asa/airlines/2001.csv","2001.csv",600411462],["dbfs:/databricks-datasets/asa/airlines/2002.csv","2002.csv",530507013],["dbfs:/databricks-datasets/asa/airlines/2003.csv","2003.csv",626745242],["dbfs:/databricks-datasets/asa/airlines/2004.csv","2004.csv",669879113],["dbfs:/databricks-datasets/asa/airlines/2005.csv","2005.csv",671027265],["dbfs:/databricks-datasets/asa/airlines/2006.csv","2006.csv",672068096],["dbfs:/databricks-datasets/asa/airlines/2007.csv","2007.csv",702878193],["dbfs:/databricks-datasets/asa/airlines/2008.csv","2008.csv",689413344]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"path","type":"\"string\"","metadata":"{}"},{"name":"name","type":"\"string\"","metadata":"{}"},{"name":"size","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641770322949,"submitTime":1641770322823,"finishTime":1641770325880,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"1420","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"476dfbf4-0351-4fc2-8775-8ff509410e9e"},{"version":"CommandV1","origId":1575837098434208,"guid":"07517406-b6a3-4ff8-8fab-812478146f5e","subtype":"command","commandType":"auto","position":4.0,"command":"spark.read.csv('dbfs:/databricks-datasets/asa/airlines', header=True).rdd.getNumPartitions()","commandVersion":6,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Out[3]: 93</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641770325884,"submitTime":1641770322828,"finishTime":1641770330314,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"bb7e8ce9-ecae-4ff0-8688-642145e5903f"},{"version":"CommandV1","origId":1575837098434209,"guid":"99983d74-5e7a-4ea1-b6a8-98839f3c83f4","subtype":"command","commandType":"auto","position":5.0,"command":"spark.read.csv('dbfs:/databricks-datasets/asa/airlines', header=True).printSchema()","commandVersion":8,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">root\n |-- Year: string (nullable = true)\n |-- Month: string (nullable = true)\n |-- DayofMonth: string (nullable = true)\n |-- DayOfWeek: string (nullable = true)\n |-- DepTime: string (nullable = true)\n |-- CRSDepTime: string (nullable = true)\n |-- ArrTime: string (nullable = true)\n |-- CRSArrTime: string (nullable = true)\n |-- UniqueCarrier: string (nullable = true)\n |-- FlightNum: string (nullable = true)\n |-- TailNum: string (nullable = true)\n |-- ActualElapsedTime: string (nullable = true)\n |-- CRSElapsedTime: string (nullable = true)\n |-- AirTime: string (nullable = true)\n |-- ArrDelay: string (nullable = true)\n |-- DepDelay: string (nullable = true)\n |-- Origin: string (nullable = true)\n |-- Dest: string (nullable = true)\n |-- Distance: string (nullable = true)\n |-- TaxiIn: string (nullable = true)\n |-- TaxiOut: string (nullable = true)\n |-- Cancelled: string (nullable = true)\n |-- CancellationCode: string (nullable = true)\n |-- Diverted: string (nullable = true)\n |-- CarrierDelay: string (nullable = true)\n |-- WeatherDelay: string (nullable = true)\n |-- NASDelay: string (nullable = true)\n |-- SecurityDelay: string (nullable = true)\n |-- LateAircraftDelay: string (nullable = true)\n\n</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641770330318,"submitTime":1641770322833,"finishTime":1641770334544,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"11213d04-b97d-4100-a7e3-6e633dec4fed"},{"version":"CommandV1","origId":1575837098434210,"guid":"ba0ac346-b32f-4765-b8b6-cd5da482b4ef","subtype":"command","commandType":"auto","position":5.5,"command":"import getpass\nusername = getpass.getuser()","commandVersion":9,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641770334551,"submitTime":1641770322839,"finishTime":1641770334565,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"2e092aef-f7f9-4bb1-b4e6-35cee9e019dc"},{"version":"CommandV1","origId":1575837098434211,"guid":"b51c2a66-51f4-4b93-82bf-96b3201dcb77","subtype":"command","commandType":"auto","position":5.75,"command":"dbutils.fs.rm(f'/user/{username}/airlines', recurse=True)","commandVersion":10,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Out[6]: True</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641770334568,"submitTime":1641770322843,"finishTime":1641770334680,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"3f43331f-18e5-431c-83bd-2381a99d69d8"},{"version":"CommandV1","origId":1575837098434212,"guid":"2bc2f88e-57d2-4d4f-88d2-53f675fffba7","subtype":"command","commandType":"auto","position":8.0,"command":"spark. \\\n    read. \\\n    csv('dbfs:/databricks-datasets/asa/airlines', header=True). \\\n    groupBy('Year', 'Month', 'DayOfMonth'). \\\n    count(). \\\n    write. \\\n    parquet(f'/user/{username}/airlines', mode='overwrite')","commandVersion":2,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\"></div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641770334683,"submitTime":1641770322848,"finishTime":1641770385241,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"aeaeb288-7035-4a97-a309-ef3faefe00ec"},{"version":"CommandV1","origId":1575837098434213,"guid":"0b02460f-95c6-4b29-9bc6-19474d118e16","subtype":"command","commandType":"auto","position":9.0,"command":"dbutils.fs.ls(f'/user/{username}/airlines')","commandVersion":10,"state":"finished","results":{"type":"listResults","data":[{"type":"html","data":"<div class=\"ansiout\">Out[8]: [FileInfo(path=&#39;dbfs:/user/root/airlines/_SUCCESS&#39;, name=&#39;_SUCCESS&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/airlines/_committed_2361973835329680893&#39;, name=&#39;_committed_2361973835329680893&#39;, size=124),\n FileInfo(path=&#39;dbfs:/user/root/airlines/_started_2361973835329680893&#39;, name=&#39;_started_2361973835329680893&#39;, size=0),\n FileInfo(path=&#39;dbfs:/user/root/airlines/part-00000-tid-2361973835329680893-13a2d96a-227d-455a-9ec8-73695b3b769a-757-1-c000.snappy.parquet&#39;, name=&#39;part-00000-tid-2361973835329680893-13a2d96a-227d-455a-9ec8-73695b3b769a-757-1-c000.snappy.parquet&#39;, size=41002)]</div>","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}},"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1641770385245,"submitTime":1641770322854,"finishTime":1641770385276,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultSubCmdIds":[],"tableResultIndex":null,"nuid":"66b8b1a7-6b61-437e-a4f3-f8defe250ff3"}],"dashboards":[],"guid":"bcd3bf56-5e45-400a-a1ff-170d60855ba2","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{"pythonIndentUnit":4}}